"issuekey","type","components","storypoint","title","description_text"
"CONFSERVER-5599","Suggestion","Page - Export / Import",1,"Export news (blog posts) to PDF","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-5599].   {panel}  We write daily market summaries using the Confluence news posts feature.  It would be very useful to be able to email these daily summaries (that include tables and attached graphs from Excel) to people outside of the company. """
"CONFSERVER-5942","Bug","Search - Core",2,"Indexing with 'Other' analyzer removes numbers from search","""When indexing language is set to """"other"""", searches ignore numbers.    Example:    Page contains string """"foo""""    Search for """"foo123"""" returns string """"foo"""" as matching    h5. Workaround:  Switch to a different Indexing Language besides 'Other' then rebuild the index  """
"CONFSERVER-14838","Bug","Themes / Theming",3,"Themes from plugins is still referenced by Confluence after plugin is uninstalled","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-14838].   {panel}  Confluence still uses an uninstalled theme's layout (eg. the font will still be the old plugin's font) as its site layout although the plugin has been uninstalled.    Steps to replicate:  # Install a theme plugin  # Set the theme as the Site Theme  # Uninstall the theme  # Confluence theme selection page (http://ConfluenceURL/admin/choosetheme.action) will report that the site is using the default theme. Warnings will be populating the log file:      Customers who used the Classic Theme as a site layout might encounter this warning after they have upgraded to Confluence 2.10.    The work around is to set Confluence site theme to other installed theme."""
"CONFSERVER-21870","Bug","Server - Platform",3,"""maximum number of expressions in a list is 1000"" error when user is in more than 1000 groups visits dashboard","""In *Oracle*, if a user belongs to more than 1000 groups and visits the dashboard, the following error occurs:      The problem is that com.atlassian.confluence.spaces.persistence.dao.hibernate.HibernateSpacesQueryBuilder specifies the full list of groups the user is a member of in the """"in"""" clause.  It's unexpected for a user to be in more than 1000 groups, but it can happen, particularly if Confluence is delegating user management to a large LDAP server."""
"CONFSERVER-22154","Bug","Integrations - JIRA",2,"JIRA Issues Macro not following Confluence general configuration date/time format","""It seems that the {jiraissues} macro for Confluence is not following the date format as set in the Confluence general configurations. The dates display in dd/MMM/yy format (with no timestamp), regardless of formatting of the """"Date Time Format"""" or """"Date Format"""" in general configs. Please see the attached screenshots for more detail.    FWIW I tested this in Confluence 3.3.3, 3.4.7, and 3.5.0, using {jiraissues} macro to retrieve issues from JAC.    There's an pretty old (fixed) ticket on this topic, but it's unclear whether it's the same bug:  http://jira.atlassian.com/browse/CONF-1403"""
"CONFSERVER-22287","Bug","Editor - Front end - Page / Comment",2,"When Inserting Link Insert Button Not Clickable When Using Mouse Right-Click to Paste","""h3. Summary  """"Insert"""" button is greyed out when using right mouse click to paste    h3. Steps to Reproduce  # Copy a URL into your clipboard.  # Click Insert > Link  #* Alternatively, Press ⌘K / ctrl + K to create a hyperlink  # Click Web Link  # Right-click in URL field/ Address field with mouse and select Paste   !CONFSERVER-22287-replication steps.png|thumbnail!     h3. Expected Results  The """"Insert""""button can clicked and link can be inserted    h3. Actual Results  The """"Insert"""" button is greyed out.    h3. Workaround  * Press Enter/Return key after pasting the link  * Press Space bar after pasting the link   * Use Ctrl + V instead  * Type and then delete any character into the """"Address"""" field; this enables the button.    h3. Additional notes  This most likely can be fixed by adding a JavaScript check for """"Right click > Paste""""."""
"CONFSERVER-22339","Bug","Integrations - JIRA",5,"JIRA Issues Macro isn't correctly displayed when exported, in PDF and Word, if the text inside columns is too wide.","""h4.Problem  JIRA Issues Macro isn't correctly displayed when exported, in PDF and Word, if the text inside columns is too wide.  The problem lies directly with the export function.    h4.Fix  There is none yet.    h4.Workaround  Use as landscape with this PDF Stylesheet:  """
"CONFSERVER-22575","Suggestion","Integrations - JIRA",5,"Support customisation of fields displayed by JIRA macro when showing a single issue","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-22575].   {panel}  In a Confluence instance with an applink set up to JIRA I would like to be able to use the """"shortcut"""" version of the jira issue macro like this:        At the moment the columns attribute is ignored and the key/description/status is displayed (see attachment). I would prefer that only the specified columns are displayed, perhaps with a vertical or horizontal layout attribute."""
"CONFSERVER-50755","Bug","Apps - Team Calendar",2,"Cannot subscribe to iCal calendar","""I'm trying to subscribe to a calendar but get the message that the calender doesn't seem to be in iCal format.  I tested the attached file with these validators: http://icalvalid.cloudapp.net/ http://severinghaus.org/projects/icv/  and the calendar validates fine, funnily, the last validator makes use of iCal4j which is implemented in Team Calendars as well. Please see the attached log and ics file for more info.   Thanks a lot, Peter  """
"CONFSERVER-23993","Suggestion","Content - Sharing",3,"Share button greyed out, not obvious that an email address needs to be 'selected' first","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-23993].   {panel}  Steps to reproduce:  * Click the share button to display the pop-up  * Type an email address  * Hit TAB  * The email is left in the text box. There is no error message yet the """"share"""" button is greyed out (!)    !confluence share.png!"""
"CONFSERVER-24760","Bug","Editor - Page / Comment Editor",5,"Copy and Paste problems with list and macro selections.","""h3. Summary    * Copy and pasting lists / sections with only partial selections does not behave in a reasonable manner.    To fix:    * Confirm desired behaviour is what we want  * Need to make sure we have good automated test cases for these selection and copy-paste scenarios  * Fix the underlying issues    [Copy and paste of original comments|http://confluence.atlassian.com/pages/viewpage.action?pageId=278070932]    h3. History from CAC    *Shannon GreyWalker*    """"EPIC"""" BUG    The conversation thread that culminated in this specific comment up above has shed light on what I think is a """"super pattern"""" that collectively describes various specific bugs that users have been reporting with the cut/copy/paste/dragMove behavior of the 4.x editor. The most concise way to describe this """"epic"""" bug is as follows:    *4.x editor does not consistently preserve and reproduce the semantic/visual structure (order and nesting) of a diverse set of selected elements when cutting/copying > pasting, or when drag-moving, into a new location*    Note that I'm stressing the semantic and visual structure of the selection, because the new editor makes it truly impossible to understand how the start and end points of the selection correspond to the specific start and end tags of the underlying selection in the XML storage format of the page. Therefore, all your users can rely on is what they see in the rendered/styled text within the editor. And what they see is always clearly representative of a semantic structure that has a specific order and nesting of semantic elements.    I would very much like to see a single JIRA issue number assigned to this overarching """"epic"""" bug so that I can track a single JIRA ticket instead of multiple more granular JIRA tickets. Why? Because IMO this is one more """"showstopper"""" issue that will prevent my company from migrating from 3.5.x to 4.x. Now that I've been banging specifically on copy/cut/paste/dragMove mechanics and seeing how truly dysfunctional the overall behavior currently is even in 4.1.5, I cannot give a green light internally to migration until the meta-issue I describe above is fully resolved in the most typical use cases. Now that I understand that these problems are essentially all bugs and not """"behavior as designed, which can be managed correctly through some common conceptual workarounds"""", I cannot force this confusing behavior on my user base.    It's worth noting that in the old wiki syntax, what you select is always 100% obvious, and is exactly what you paste, and the resulting behavior is always 100% predictable. So this is an entirely new problem introduced with the 4.x environment. Remember, moving things around in and between pages is at least 50% or more of what your heads-down users spend their time doing in the editor. Writing is mostly revision.    I strongly recommend that once you get this """"epic"""" bug resolved, you create several functional tests based on several test pages that you always faithfully run during regression for every single point release of Confluence, and you do not release if any of those functional tests fail. Why, again because cut/copy/paste/dragMove is at least 50% of what your users spend every hour in Confluence actually doing. Your code for cut/copy/paste/dragMove needs to be 100% reliable and predictable based upon what your users can actually see and infer in the rendered WYSIsortaWYG text in the editor. It was 100% reliable before in wiki syntax mode, so it needs to be the same in 4.x or we have a net loss and lots of confused and pissed-off users.    Here are two specific and common functional tests I can think of off the top of my head. Both of these also serve to illustrate the meta pattern I describe above for this """"epic"""" bug:    h5.Functional Test 1 - Cut and paste within an ordered list     h6. Test object         h6. Sub Test 1.1 - Select from start of semantic parent, paste before start of another semantic parent       # Select from the first character of the text within parent Step 3 through:  ## The last character of the text within child Step 3.b.  ## The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ## Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ## The middle of the text within child Step 3.b (end just before the word """"originally"""").  # Cut the selection.  # Place the selection point immediately before the first character of the text within Step 2.  # Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:         Selection type 1.d should yield the following expected semantic result when pasted:          h6. Sub Test 1.2 - Select from middle of semantic parent, paste before start of another semantic parent     #    Select from the middle of the text within parent Step 3 (start just before the word """"originally"""") through:  ##        The last character of the text within child Step 3.b.  ##        The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ##        Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ##        The middle of the text within child Step 3.b (end just before the word """"originally"""").  #    Cut the selection.  #    Place the selection point immediately before the first character of the text within Step 2.  #    Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:         Selection type 1.d should yield the following expected semantic result when pasted:          h6. Sub Test 1.3 - Select from start of semantic parent, paste in middle of another semantic parent     #    Select from the first character of the text within parent Step 3 through:  ##        The last character of the text within child Step 3.b.  ##        The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ##        Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ##        The middle of the text within child Step 3.b (end just before the word """"originally"""").  #    Cut the selection.  #    Place the selection point in the middle of the text within Step 2 (just before the word """"originally"""").  #    Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:         Selection type 1.d should yield the following expected semantic result when pasted:          h6. Sub Test 1.4 - Select from middle of semantic parent, paste in middle of another semantic parent     #    Select from the middle of the text within parent Step 3 (start just before the word """"originally"""") through:  ##        The last character of the text within child Step 3.b.  ##        The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ##        Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ##        The middle of the text within child Step 3.b (end just before the word """"originally"""").  #    Cut the selection.  #    Place the selection point in the middle of the text within Step 2 (just before the word """"originally"""").  #    Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:         Selection type 1.d should yield the following expected semantic result when pasted:         h5.Functional Test 2 - Cut and paste within a mixed set of nested macros, sections, and paragraphs     h6. Test object    _This is hard to simulate in JIRA, so see_    !section-copy-paste-screenshot.jpg|thumbnail!    ----  h4. Section 1    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah       * blah blah      * blah blah     * blah blah    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    {panel}  h4. Section 2    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah     <warning macro>  lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    *    blah blah  *    blah blah  <warning macro>    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    *    blah blah  *    blah blah    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah  {panel}    h4. Section 3    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah  ----     h5. Sub Tests    Okay I'm not going to make another long vertical wall of specific tests and expected results here, because hopefully you see how the same testing pattern enumerated for the ordered list test object would be applied to this new test object comprising a semantic mixed content model for common combinations of paragraph and list block elements plus some nested macro objects (each of which contains a mixture of typical paragraph and list block elements.    The basic idea is to apply the same four tests here to this new test object, ideally within *Section 2* because it contains the most complex mixture of semantic objects.    * Sub Test 2.1 - Select from start of one semantic parent, paste before start of another semantic parent. For example, what would you intuitively expect to happen if you selected the entire panel macro in *Section 2* and then pasted the selection with your insertion point immediately before the first character of the first bullet in the bullet list of *Section 1*. Yeah, you see where I'm going here, right? Do you get this intuitively expected result right now? Nope.  * Sub Test 2.2 - Select from start of one semantic parent, paste in middle of another semantic parent. I won't bore you with examples. I hope you get it by now.  * Sub Test 2.3 - Select from middle of one semantic parent, paste before start of another semantic parent. Yada yada.  * Sub Test 2.4 - Select from middle of one semantic parent, paste in middle of another semantic parent. Yada yada.    *The bottom line with all these functional test objects and the four typical semantic cut/copy/paste/dragMove sub tests to perform on each one boils down to one intuitively expected UX pattern:*    * Structurally speaking, the clipped/pasted result of a selection should be the exact same whether the selection's end-point is at the end of a visible text line in the editor or the end-point is at the right margin. Yes, under the covers this subtle distinction makes for a different range in the tinyMCE's information it gets from the browser, but for a user looking at the screen, there is no distinction; it's the same exact thing. Your code should reflect this user perception and should not reflect the actual technical distinction under the covers in the DOM.    * The complete visual and semantic structure of the clipped selection should be preserved and reproduced exactly the same in the new, pasted context, AND    * The visual and semantic structure into which you pasted the clipped selection should """"split"""" around the inserted paste and that split structure should be maintained with the same exact structure in both halves of the split.    * When you have to make a decision between acting upon what's really selected (or where the insertion point is) based on the underlying DOM of the selection range reported by the browser versus what the user sees visually in the editor and thinks of as being """"the semantic objects I've selected"""", you should always decide in favor of what the user visually and conceptually sees with their own eyes.    * Good luck with this. I'm sure it can be done. The question is: how soon? And what JIRA issue number do I track to watch for completion of this?    ----    *Paul Curren*    Hi Shannon. I apologise for the delay in responding to this comment. I've been in contact with our bug-fixing team to go through the issues you have described here. We will get one or more issues raised soon, as appropriate and let you know the numbers for tracking purposes.    Thanks.    ----    *Shannon Greywalker*    Thanks Paul. I know it was a lot to chew on and spec out. No worries; thanks for the update.  """
"CONFSERVER-25111","Bug","Editor - Page / Comment Editor",1,"Removing formatting from a bullet point or numbered list item moves the cursor to a new line","""see this video: http://screencast.com/t/C9pYDRqwApnb    Same thing happens with itlaics and underline"""
"CONFSERVER-25278","Bug","Page - Export / Import",3,"Page margin CSS in PDF Stylesheet can OOME and cause high load on Confluence during space export to pdf","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-25278].   {panel}  h5. Steps to reproduce:  # Add the following CSS in your Space PDF Stylesheet:    # Export a Page to PDF and will ended up at System Error page with the following stacktrace:    # Export the Space to PDF and it will take forever and throw the following in the stacktrace:      h5. Findings  It seems that this can only be reproduced if the value of the margin is bigger than 5in.    h5. Workaround  Follow the instructions from the following KB article:  http://confluence.atlassian.com/display/CONFKB/Exporting+Page+or+Space+to+PDF+Fails+and+Causes+High+Load+or+OutOfMemoryError"""
"CONFSERVER-25582","Bug","Integrations - JIRA",5,"Japanese (and possibly other 2 byte) characters are not properly displayed on Confluence Issue insert widget.","""Component and Version are not displayed properly. See attached screenshots.    We've tested with the following combinations of JIRA and Confluence versions and we saw the reported problem shown by attached image of 'bandicam 2012-05-15...' in all of them.    ||JIRA||Confluence||  |4.4.1| 4.0.4|  |5.0.4| 4.1.9|  |5.0.5| 4.2.2|  We did the test you said and the results are attached. The JIRA-Confluence versions of this test is 5.0.4-4.1.9. As you can see in the screen shots, most of the language display works fine. This problem is, I guess, specific to the pop-up screen of Insert-JIRA-Issue.    The JIRA's Component and Version are not displayed properly. Project name and Task type are properly displayed. Concerning the screen shot, we defined two Components in JIRA for test purpose. One of the components have Japanese characters in its name and the other had no Japanese character.    It is sure that Versions, if name has Japanese characters, are not displayed properly in similar way as Components does not."""
"CONFSERVER-26834","Suggestion","Server - Platform",8,"Support for Microsoft SQL Server JDBC Driver","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-26834].   {panel}  Microsoft SQL Server drivers, provided by Microsoft, support features such as:  - Windows Authentication  - Automatic failover  - *Integrated Security parameter* (integratedSecurity=true) which Enterprise customers cannot work without!  - And others    These features are vital to enterprise level customers and also other users"""
"CONFSERVER-26897","Bug","Content - Blueprints / Templates",5,"Not able to link text to an anchor on a template page.","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-26897].   {panel}  When creating a template page if you create an anchor and then try to link a text on the page with this anchor you get """"The markup provided is not valid link markup"""" message.    A workaround for it would be first creating it on a normal page, copy the content and paste on the template page, so the link will work then.    """
"CONFSERVER-27259","Suggestion","Integrations - JIRA",3,"When using the Issuelinks field column in the JIRA macro, there are no hyperlinks like in the Issue Navigator in JIRA","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-27259].   {panel}  Customer requests that the Linked Issue field column, when added to the JIRA Macro in Confluence, contain hyperlinks like when you add the field in the Issue Navigator in JIRA.    """
"CONFSERVER-27594","Bug","Editor - Drafts",3,"Deleting a Page does not Delete its Draft","""h2. Summary of The Bug    When users deleting a page on Confluence, the draft won't be deleted with it at the same time. This cause a {{WARN}} stack trace on the log whenever a user editing another page which saved into a draft.    Here is the stack trace written on the logs:        h2. How to Replicate The Issue    # Add a new page then save it  # Edit the newly created page, wait until a draft was saved, then cancel editing  # A draft version of the page is listed in *""""username drop down option"""" >> Drafts*  # Remove the page  # Purge it from trash  # Draft version of the page is *still* listed in *""""username drop down option"""" >> Drafts*  # Edit any other page, wait until a draft was saved, then cancel editing  # {{atlassian-confluence.log}} will record the previously mentioned stack trace    h3. Noted    Please note that the stack trace is a {{WARN}} message that does not affect Confluence usage as the draft of the new page is still saved    h2. Workaround  There is a workaround detailed in [this KB article|https://confluence.atlassian.com/display/CONFKB/Removing+Orphaned+Draft]. It involved finding and removing the orphans from the database."""
"CONFSERVER-27618","Suggestion","Editor - Page / Comment Editor",2,"More cell highlight colors in Confluence","""{panel:bgColor=#e7f4fa}  *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-27618].  {panel}  When using tables in Confluence we would like to have more options for colors in addition to the default colors options that can be used(grey, red, green, blue, yellow, white).         {panel:title=Atlassian Update - 18 May 2020|borderStyle=solid|borderColor=#6554c0|titleBGColor=#6554c0|bgColor=#eae6ff|titleColor=#ffffff}    Hi everyone    Thank you all for your patience on this one. Confluence 7.5 will ship with a new colour palette for table cells.    We have expanded the original six options to a range of *49 bright and subtle options*. The existing five colours have been tweaked slightly to align with the Atlassian Design Guidelines (ADG) colour palette. Any colours you have used on existing tables/pages won't be affected and you can choose to update these tables with the new colours.     Please see the full update [in my latest comment|https://jira.atlassian.com/browse/CONFSERVER-27618?focusedCommentId=2415844&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-2415844].    Thanks again!  Makisa | Senior Product Manager, Confluence Server and Data Center  {panel}"""
"CONFSERVER-31261","Bug","Server - Installer / Setup",5,"restore data of setup screen does not look completely auified","""[screenshot|http://screencast.com/t/YshL4w1mfyl]  In the upload and restore a site/space backup section # the checkbox for build index looks stock. Not like the grey checkbox for aui # the line containg the """"browse"""" button shouldn't have an empty field # on the same line, the button should be on the left of whatever it shares that line with  In the restore a backup... section # the build index checkbox is stock # the box below it looks significantly different from the spec  spec = CONFDEV-14482 (attached as screenshot)"""
"CONFSERVER-28252","Bug","Page - Export / Import",3,"Page break before and after Table of Contents macro are forced in PDF export","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-28252].   {panel}  When a Page is exported, a page break is forced before and after Table of Contents, resulting in an otherwise empty page. This behaviour is not related to PDF stylesheet settings, and occurs regardless of the place in the page where the macro is embedded (see example exports attached)."""
"CONFSERVER-28482","Bug","Themes / Theming",3,"Look & Feel Editor for Documentation Theme Space is Broken","""h3. Steps to Reproduce:    # Access any space that use documentation theme as its theme  # Access the space administrator page of the space  # Under the """"Space Admin"""" tab access the """"Stylesheet"""" menu under the """"Look & Feel"""" section  # Try to edit the """"Stylesheet"""" which will redirect user to the """"Stylesheet Editor""""  #* The save and cancel button is located at the top-left instead of under the editor. This occurred in release version 5.0, 5.0.1 and 5.0.2  !502layout.png|thumbnail!  # Try to edit the """"PDF Layout"""" which will redirect user to the """"PDF Layout Editor""""  #* """"PDF Space Export Header"""" and """"PDF Space Export Footer"""" is positioned on a different frame and looks broken. This issue only occurred in release version 5.0.1 and 5.0.2  !502pdflayout.png|thumbnail!  # Try to edit the """"PDF Stylesheet"""" which will redirect user to the """"PDF Stylesheet Editor""""  #* The save and cancel button is located at the top-left instead of under the editor. This occurred in release version 5.0.1 and 5.0.2  !502pdfstylesheet.png|thumbnail!    h3. Expected Results:    *Stylesheet Editor*    Here is the screenshot of what the editor look like in Confluence 4.3.x:    !435stylesheet.png|thumbnail!    In Confluence release version 4.3.x the """"Save and """"Cancel"""" button is positioned in the same frame as the editor. Positioning """"Save and """"Cancel"""" button in the same frame as the menu button might confuse the customer.    *PDF Layout Editor*    Here is the screenshot of what the editor look like in Confluence 5.0.0:    !500pdflayout.png|thumbnail!    In Confluence release version 5.0.0 the positioned of all the editor are in the same column and doesn't look broken compared with 5.0.1 and 5.0.2.    *PDF Stylesheet Editor*    Here is the screenshot of what the editor look like in Confluence 5.0.0:    !500stylesheet.png|thumbnail!    In Confluence release version 5.0.0 the """"Save and """"Cancel"""" button is positioned in the same frame as the editor. Positioning """"Save and """"Cancel"""" button in the same frame as the menu button might confuse the customer.  """
"CONFSERVER-28543","Bug","Macros - Gadgets",5,"Activity stream not respecting parent page restrictions","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-28543].   {panel}  The Confluence Activity stream will display all pages that the user has access to according to the restrictions. However, if the user is limited in viewing a page due to inherited restrictions from a parent page, the page in question will still show up in the activity stream, and when following the link, the user will be notified that due to inherited restrictions, they will be unable to view the page.    The activity stream should not display pages that are restricted for viewing due to inherited restrictions, or child pages should copy over parent page restrictions."""
"CONFSERVER-28550","Bug","Page - Export / Import",2,"People Directory displays 'profile: No user <username>' for users in external directories","""*pls refer to ticket https://jira.atlassian.com/browse/CONFDEV-15625    See screenshots. Users in the Confluence Internal Directory display correctly, whereas all external users display an error.     h3. Steps to Reproduce  # Import the attached XML backup to 5.0.1 (this is my live SRDL instance with email and the JIRA directory disabled, and no attachments)  # Log in with admin:admin  # View the People Directory and confirm that users display correctly.  # Shut down Confluence 5.0.1  # Unzip the 5.1beta2 installation.   # Point confluence.cfg.xml to the home directory of the 5.0.1 instance  # Start the 5.1beta2 instance and allow the upgrade to complete  # View the People Directory and confirm the error occurs.    Site Back up can be located in linked issue -> https://jira.atlassian.com/browse/CONFDEV-15625    """
"CONFSERVER-28621","Bug","User - Management",8,"User Loses all Local Group Memberships If LDAP Sync is Unable to find the User, but the User appears again in subsequent syncs","""h3.Steps to Reproduce  # Add a connection to LDAP in {{Confluence Admin >> User Directories}} with the *Read Only, with Local Groups* option  # Sync the directory and make sure that LDAP users are returned  # Add 1 LDAP user to a local group (membership)  # Change the User Object Filter in the directory's configuration in {{Confluence Admin >> User Directories}} to a dummy filter, such as the following:    # Sync the directory again (Notice that the LDAP users are missing)  # Revert the User Object Filter to the previous working filter  # Sync the directory again (notice that the LDAP users are back, but their local group memberships are gone)    h3. Workaround  # Restore the instance's database backup to a new database (i.e. not production) prior to the point where memberships were lost.    # Follow the instructions in step 1 of [Migrating Local Group Memberships Between Directories|https://confluence.atlassian.com/display/CONFKB/Migrate+Local+Group+Memberships+Between+Directories] to generate a CSV file of users and their memberships.  # Run through the rest of the instructions in that KB article to populate the production instance's group memberships."""
"CONFSERVER-29182","Bug","Integrations - JIRA",2,"JIRA Issues macro links to application URL rather than display URL - the search link uses the application URL.","""Application links have both an application URL, the URL by which the app connects on the backend (eg. http://jira.localhost), and a """"display URL"""", the link displayed to the user (eg. https://jira.company.com"""").    Currently this doesn't work with the jiraissues macro, because:  - If I use the """"application URL"""" parameter (eg. """"http://jira.localhost/sr/...""""), I get results, but *the hyperlink of the search is then wrong*.  - If, as a workaround, I try to use the """"display URL"""",  I get an message telling me """"This table displays contents from an external source. The contents will be displayed as HTML. If you trust the security of this source, you can display the original formatting and avoid this warning by creating an Application Link to this JIRA instance"""".    As for fixing this, I suggest: when rendering the search link, examine the search XML URL, and if it begins with an applink URL, substitute the applink's display URL."""
"CONFSERVER-49484","Bug","Apps - Team Calendar",3,"Edit Time Zone for JIRA Team Calendars","""We use JIRA Team Calendars in Confluence to track time-sensitive tasks (like promo start/end times/dates). It works really well, but it would be great if there were a way to set the time zone that data is displayed in.    Currently, the actual times shown in JIRA Team Calendars are taken from the JIRA server's system time and can't be adjusted. This causes some confusion and inconvenience.     Thanks,  -Roger"""
"CONFSERVER-29863","Bug","Integrations - JIRA",2,"JIRA Issues macro renders incorrectly when custom icons are used for issue types","""*Steps to reproduce*  # Have a Confluence instance linked with a JIRA instance  # Place a custom icon at {{<JIRA-INSTALL>/atlassian-jira/icons/}}  # Navigate to *JIRA Administration > g g > Issue Types*  # Click Edit, specify the new icon  # Go to Confluence, in the editor: *Insert > JIRA Issue*  # Notice that the icon is already not displayed and is used as a background of the {{<span>}} instead    Tested with Confluence 5.1.4 hooked up with JIRA 5.2.11. (Sample file attached to this ticket)  """
"CONFSERVER-30071","Bug","Editor - Page / Comment Editor",5,"Excessive CPU usage with Firefox when viewing page with Attachments macro","""When viewing a page containing the Attachments macro with Confluence 5.2-beta1 (which is running the recently-posted Attachments plugin 3.6.7 from CONF-22002), Firefox 22 consistently consumes 50-100% of CPU.    Navigating away from the page seems to cure the problem, as does removing the attachments macro. At least one other browser (Safari) does not seem to be impacted in the same way."""
"CONFSERVER-30079","Bug","Integrations - JIRA",0.5,"NullPointerException when attempting to render a JIRA issue where the resolution field has been hidden","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-30079].   {panel}  Steps to reproduce:  * Create an issue in JIRA (e.g. FOO-1).  * Change the field configuration of that issue to set """"Resolution"""" to """"Hide"""" (if using the default Field Configuration, this can be done at /secure/admin/ViewIssueFields.jspa).  * Edit a page in Confluence and insert a JIRA issue macro referencing FOO-1.  * Save or Preview the page.    *Expected result:* FOO-1 should be rendered by the macro as normal.    *Actual result:* The following error is displayed:  {quote}  Error rendering macro 'jira' : com.atlassian.confluence.macro.MacroExecutionException: java.lang.NullPointerException  {quote}    Full stack trace from the logs:      If the Resolution field is set back to """"Show"""", you will also need to flush Confluence's caches to get the macro working as expected (i.e. """"Flush All"""" on /wiki/admin/cachestatistics.action).     h5. Workaround:  Uninstall JIRA Macros Plugin v5.0 and then download v4.0.29 from [Marketplace|https://marketplace.atlassian.com/plugins/confluence.extra.jira/versions] and manually upload it into Confluence from the Plugin manager (Manage Add-Ons > Upload Add-On)."""
"CONFSERVER-30077","Suggestion","Integrations - JIRA",0,"JIRA issue macro aggressively caches, new issues take a while to appear in the issues macro ","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30077].   {panel}  The new JIRA Issue macro, accessible via Insert > JIRA Issue, does not allow the user the configure caching. Currently it's always on. The problem here is that with caching always enabled, the information shown in Confluence is not always up-to-date.    h4. Steps to reproduce  # In JIRA, create a project with a key of TEST  # Create one issue under TEST  # On the Confluence editor, use Insert > JIRA Issue, and set the JQL to """"project=TEST"""". Save the macro and page. One issue is shown  # Create another issue under TEST  # Refresh the Confluence page. The second issue does not appear until the cache is expired, or if it's flushed manually via Confluence Admin > Cache Statistics    A workaround solution, You can remove the cache by following steps:   # Go to the page """"Confluence Admin >> Cache Statistics >> Advanced""""  # Search for the term """"JIRA Issues"""".   # Change the value from """"100"""" (default) to """"1""""   # Click the button """"Adjust Size"""" to enable the change.     h4. Other issues  This is a related but separate issue from CONF-22845, which addresses the original JIRA Issues macro."""
"CONFSERVER-30116","Suggestion","Integrations - JIRA",0,"Ability to configure the maximum number of issues displayed in the JIRA issues macro","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30116].   {panel}  In earlier versions, the JIRA issue macro had a pagination feature. This feature was removed due to observed low feature usage, in addition with our strategic focus to simplify the Confluence user interface and to keep and complex JIRA operations in JIRA. My apologies for the may customers that were quickly impacted by this, we could have done a better job in communicating this and ensuring we had understood your needs with regards to this matter.     Since then we've received a lot of feedback to bring back pagination. Thank you for those of you who provided helpful comments below, and for those customers we have been able to speak to about this. With this in mind, we have concluded the following:    * It is very clear that the current issue limit we have is insufficient and does not meet most of your needs.   * It is important for you to be able to see _all_ the issues requested   * We still believe that the use case of navigating 100+ issues within inside Confluence is something that is extremely low and is something which should be done in JIRA.   * Some of you mentioned of the importance of seeing this also in PDF exports when you share the release notes or pages with customers.     With that in mind, what will we be doing to address this?  1. We will look at increasing the limit of the total number of visible issues  2. In addition, we will look at providing a parameter to configure this.  *Note:* You will always be limited by the total amount of issues JIRA provides, but [this setting can be changed|https://confluence.atlassian.com/display/ONDEMANDKB/Changing+maxResults+Parameter+for+JIRA+REST+API].  3. We will be looking at also implementing CONF-30114 (sorting) to assist with dealing with larger issue lists in Confluence.     Thank you all for your patience in this matter, we will update this issue as we make progress.     Sherif Mansour  Confluence Product Manager    Previous description:   {panel}  The new JIRA issues macro does not paginate. This feature request is to help us better understand why customers want this.   If you are going to comment on this ticket, please provide some understanding for why you want pagination. We removed this feature because we saw very low usage of it. Since then, we've had a few requests to bring it back.     One way we could solve the majority use case is to increase the default amount of search results displayed. We are a bit hesitant to bring this back as we want to understand what it is that we are missing. If you are embedding 50/100+ issues on a page and want pagination, you probably shouldn't be doing that in Confluence, but rather the JIRA issue navigator - that is why we tell you """"there are xxx more issues, open in JIRA"""".     Please help us understand why you want this and some examples where you really do have lots of issues on a page that you want your end-users to read (if that is the use case)  {panel} """
"CONFSERVER-30114","Suggestion","Integrations - JIRA",8,"Ability to sort issues in the JIRA issues macro table","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30114].   {panel}  In the new release of the JIRA issues macro, it is not possible to short the columns inside a table.    This feature request is to sort columns from viewpage for the JIRA issues macro. """
"CONFSERVER-51736","Suggestion","Apps - Confluence Questions",5,"When asking a question notify users of similar questions","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51736].   {panel}  This is intended to reduce the number of duplicate questions on the system. """
"CONFSERVER-51714","Suggestion","Apps - Confluence Questions",13,"Accept an answer","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51714].   {panel}  As an employee, I want to mark an answer as the """"accepted"""" answer."""
"CONFSERVER-51737","Suggestion","Apps - Confluence Questions",13,"link a CQ topic to a Hipchat room","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51737].   {panel}  """
"CONFSERVER-51705","Suggestion","Apps - Confluence Questions",8,"As a space admin, I want to display a list of questions on my page","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51705].   {panel}  macro parameters include:  * (must have) restrict to these topics (and / or) - e.g. (design AND faq)  * (nice to have) sort by: newest (default), oldest, most popular  * (nice to have) maximum number of questions to display  * (nice to have) show only answered or unanswered questions  * (nice to have) display just questions or questions + answers"""
"CONFSERVER-30428","Suggestion","Integrations - JIRA",1,"JIRA Issues Macro filter behaviour has changed so that it no longer saves the filter, but rather hard-codes the results.","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30428].   {panel}  h3. The problem  Inserting a URL to a saved filter, eg {{http://localhost:9604/browse/TEST-3?filter=10000}} autocompletes to the JQL content of the filter - 'description ~ """"description""""' in my test case - so when filter 10000 changes, the JIRA Issues  will still be 'description ~ """"description""""'. This is not the same as previous behaviour, where the filter would remain in the macro and changes to the filter would be reflected in Confluence.    h3. Steps to Reproduce  # Create and view a filter in JIRA  # Copy the URL  # Create a JIRA Issues Macro in Confluence 5.2.3  # Paste the URL into the macro  #- Observe that the URL is immediately changed to the JQL of the filter.  # Save the JIRA Issues Macro  # Change the filter in JIRA so that the results are different  # Reload the Confluence page  #- Observe that the results do not reflect the changes to the filter"""
"CONFSERVER-30575","Bug","Server - Source Distribution",2,"The confluence-space-ia plugin is missing from the Confluence source distribution","""The {{confluence-space-ia}} plugin, new in Confluence 5.x, is not currently included in the Confluence source distribution.    Customers would like to be able to access the source code to this plugin in order to customize it and/or learn how to replicate certain aspects of its behaviour.    This will be a general problem for new plugins. We need to solve this in a generic way, or identify missing plugins automatically.  """
"CONFSERVER-51754","Suggestion","Apps - Confluence Questions",8,"I want to be able to get a notification for every new question created regardless of topic","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51754].   {panel}  - An option to get notifications for all questions that are created.  - The tricky thing is where to place the button/checkbox for that.  - Should not send duplicate emails if I am also watching the topic for that question"""
"CONFSERVER-30874","Bug","Integrations - JIRA",0,"Re-searching the same JQL will not update the macro contents.","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-30874].   {panel}  I once had a JIRA Macro displaying all JIRA issues with a label """"MYLABEL"""" (JQL: labels = """"MYLABEL""""). This returned seven results.    I raised another ticket, and applied the label """"MYLABEL"""". This did not update the macro contents on view, but I believe that is expected.    I edited the page, and then the macro, and re-searched (the same search that was there). This second search returned eight results. I saved the macro and saved the page.    Upon viewing the page, the JIRA Macro still had seven results."""
"CONFSERVER-51712","Suggestion","Apps - Confluence Questions",13,"Support anonymous users in CQ","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51712].   {panel}  Add an """"anonymous use question"""" permission to the questions configuration screen."""
"CONFSERVER-47675","Bug","Apps - Confluence Questions",5,"Don't scale the topic avatar up","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47675].   {panel}  {quote}  I select an 48x48 png image and get a scaled up version of this to select the range?  If I do this I get a bad looking version of my good looking image with similar resolution.  {quote}    We should scale down the avatar if it's too big but shouldn't scale up if it's too small."""
"CONFSERVER-47613","Bug","Apps - Confluence Questions",5,"Unable to submit a question in IE.  I get an error stating that I must add at least one topic.","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47613].   {panel}  We just installed the Confluence Questions beta after updating to Confluence 5.3.  It is immediately unusable.  When I go to Ask a Question, I enter the summary and description and then add some topic tags at the bottom. As soon as I hit the submit button, I get a red error indicating that I must add at least one topic.  I have tried adding one and also two topics to no avail."""
"CONFSERVER-48045","Bug","Apps - Confluence Questions",5,"Question items appear on the popular stream for anonymous users even with restrictions in place","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48045].   {panel}  Steps to reproduce:     # Create a question  # Navigate to Administration > Confluence Questions Configuration and restrict access to questions to a group of users (say confluence-users)  # Grant anonymous users """"use"""" permission  # Logout and then navigate to Confluence dashboard   """
"CONFSERVER-31148","Bug","Integrations - JIRA",8,"JIRA Issues macro doesn't use display name for time tracking fields","""h5. Symptoms    When using a JIRA Issues macro including any time tracking fields as columns, the column header is not the correct display name, for example:    * """"Original Estimate"""" shows as """"Timeoriginalestimate""""  * """"Σ Time Spent"""" shows as """"Aggregatetimespent""""    h5. Steps to Reproduce    * Add a JIRA Issues macro to a page in Confluence, linked to JIRA via application links  * Specify at least one column as a time tracking field  * View the macro after saving the page"""
"CONFSERVER-47813","Bug","Apps - Confluence Questions",3,"No visual feedback for topic icon upload","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47813].   {panel}  We need a spinner/throbber/something to indicate that the topic logo is being uploaded.    https://support.atlassian.com/browse/CQS-60"""
"CONFSERVER-31200","Bug","Integrations - JIRA",0,"Jira Issues Not Working for Confluence 5.3 and Jira 4.4","""Jira issues macro version 5.1.x doesn't work properly when you link Confluence 5.3 with Jira 4.4 version.     h4.What's Working?    If you try to *Create a New Issue* it will work properly and you will be able to see the Jira issues within your Confluence page.    h4.What's not Working?    # *Search* feature isn't working. When you tip a search method in the field, the issues will display properly. However, when you click on *Insert* nothing happens and the dialog is still displayed.  # *Recently Viewed* option just display an 400 HTTP error:  !issue.png!    h4.Steps to Reproduce:     *On JIRA side*    # Install Jira 4.4 version  # Create an issue in JIRA    *On Confluence side*    # Install Confluence 5.3 version with Jira macros 5.1.x version  # Create an Application Link between both instances  # Edit/create a page  # Go to Insert > Jira Issues  # Click on Search and tip any issue key, search URL, JIRA link, JQL or plain text in order to display the issue(s)  # Click on Insert and the same symptom will happen  # Then, click on Recently viewed and the second symptom is displayed."""
"CONFSERVER-31209","Bug","Integrations - JIRA",3,"Column titles in the jira macro do not respect the global language configured at all, and remains English","""h4.Steps to Reproduce:  # Set the language of Confluence and JIRA to German, or French.  # Set the browser first language to the same language that you set for your Confluence.  # Insert Jira macro into a page     h4.Expected Results:  Column titles must be translated accordingly.    h4.Actual Results:  Column titles remain in English, and do not get translated.  !column.jpg|width=600!  """
"CONFSERVER-31255","Bug","Editor - Page / Comment Editor",3,"Page Tree Macro with ""Include Excerpts"" option shows raw HTML for formatted text","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31255].   {panel}  h5. Symptoms    When using the Page Tree Macro, with """"Include Excerpts in Page Tree"""" option, and an excerpt macro on one of the pages includes some text formatting, then the Page Tree Macro shows the raw HTML codes, rather than formatted or stripped text.    h5. Steps to Reproduce    # Create a page with an except macro, containing formatted text  # Create a page with a page tree macro, including the page with the excerpt  # Observe the excerpt with raw HTML codes in it    h5. Workaround    Don't use formatting in the excerpt macro."""
"CONFSERVER-47802","Bug","Apps - Confluence Questions",1,"CQ keyboard shortcuts interfere with regular Confluence shortcuts","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47802].   {panel}  [~dloeng@atlassian.com] has had a quick look at this and fixed the immediate issue on PUG, but the theory is that changing the context of our keyboard shortcuts will stop the clash from occurring."""
"CONFSERVER-51725","Suggestion","Apps - Confluence Questions",13,"As a question viewer I want to turn an answer into a comment","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51725].   {panel}  some people are posting answers that really should comments. you should be allowed to turn answers into comments.    Note - there should probably be a """"turn answers into comments"""" permission in the system"""
"CONFSERVER-31488","Bug","Integrations - JIRA",3,"JIRA issues macro throws exceptions when applinks are not configured correctly","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31488].   {panel}  Scenario 1:  1. Create applink to from Confluence to JIRA (2LO should be configured by default)  2. Insert JIM on a confluence page - see that it's rendered correctly  3. Disable the OAuth outgoing authentication from Confluence (Do not untick the """"Enable outgoing 2-Legged OAuth requests"""" option  4. View the JIM again - see that a MacroExecutionException is displayed    Scenario 2:  1. Create applink to from Confluence to JIRA (2LO should be configured by default)  2. Insert JIM on a confluence page - see that it's rendered correctly  3. Disabled """"Enable outgoing 2-Legged OAuth requests"""" from the JIRA incoming OAuth authentication  4. View the JIM again - see that a MacroExecutionException is displayed    Ideally we would display message to the end user indicating that there is an applink misconfiguration"""
"CONFSERVER-47594","Bug","Apps - Confluence Questions",3,"Downvote emails are not really anonymous","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47594].   {panel}  !https://s3.amazonaws.com/uploads.hipchat.com/10804/157979/7Op4DM7Y2te9XKq/%5BConfluence%5D+New+vote+for+an+answer+on+%22can+I+accept+a+question%3F%22+-+jhoarau%40atlassian.com+-+Atlassian+Mail+2013-11-06+14-26-18.png!"""
"CONFSERVER-31534","Suggestion","Macros - JIRA Macros",3,"When Epic Link is chosen as a display field in the JIRA macro, it should show Epic Name.","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-31534].   {panel}  This was recently fixed in Jira, where in Issue Navigator issues now show their Epic's name rather than the Epic's Issue Key.    In Confluence, the Epic's Issue Key is still displayed when using the JIRA macro."""
"CONFSERVER-31663","Bug","Integrations - JIRA",1,"JIRA Issues Macro does not work using Basic Access application link as described in documentation","""h4. Symptoms    In the JIRA Issues Macro documentation, it says that you can use Basic Access application link authentication, so that the issues that get displayed are those that the user in the application link has access to. This is no longer working, the only issues that can be viewed by an anonymous user, for example, are the ones that are viewable by an anonymous user in JIRA.    Whilst this makes logical sense from a security standpoint, our [documentation|https://confluence.atlassian.com/display/DOC/JIRA+Issues+Macro] explicitly says that you should be able to see any issues that the Basic Access user can see. This was also working in older versions of Confluence/JIRA Issues Macro.    h4. Steps to Reproduce    # Create an application link between JIRA and Confluence using Basic Access  # Create a page in Confluence, and add some JIRA issues  # Make sure that page is anonymously accessible and the JIRA issues are not anonymously accessible  # Load that page as anonymous (e.g. in incognito mode) and see that no issues are listed if it should be a table, or that only the issue key and no other details are showing if a single issue."""
"CONFSERVER-31695","Bug","Editor - Page / Comment Editor",3,"Emoticons disappear when inserted directly before a link","""SUMMARY  Confluence: Adding a check mark before a hyper link would fail silently.  STEPS TO REPRODUCE  1. Edit a page.  2. Insert a link to another page on a new line, then save.  3. Edit the page again and move the cursor to just before the link, then insert emoticon. See attached screenshot 1. Save.  RESULTS  After save, the checkmark does not show up. See attached screenshot 2.  WORKAROUND  1. Insert a space after the emoticon (before the hyperlink) and then click save. Then the emoticon stays.   2. Edit the page again and delete the space you added in step 1. Then save. Then the emoticon stays again whereas before it vanished.    Additional testing has show that emoticons can not be part of the title of a link. When inserting one directly next to a link in edit mode, the emoticon gets rendered (ie  for check mark).  Upon saving the page, the emoticon will disappear.   When clicking on the link in edit mode, navigate to the edit option of the link and adding the ( / ) to the title there, the short cut for the emoticon will not get rendered after page save, and the title of the link will simply display the 3 characters ( / )    In effect this appears to relate to CONF-26042    Besides that, another additional testing on Confluence 5.4.4 shows that this issue cannot be replicated if the link inserted to the page is a web link."""
"CONFSERVER-31708","Bug","Integrations - JIRA",5,"JIRA Issues Macro doesn't show resolution date","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31708].   {panel}  Steps to replicate:    # Link together a JIRA 6.2-OD-03, Confluence 5.3-OD-12 instance (or just use OnDemand) and JIRA Macros v 5.2 is installed.   # Create an issue in JIRA and resolve it  # Create a page in Confluence,  # Add the JIRA Issues Macro and perform a JQL search for the issue in step 2. Under display options add the Resolved field.  # Save the page    Result:    Resolutiondate (all one word for some reason) will be displayed, but it will be empty    Expected result:    Resolution date will appear in the resolutiondate field.    PS: This is affecting Confluence 5.3/5.3.4 and also JIRA issues macro version 5.1.1 and 5.1.3."""
"CONFSERVER-47633","Bug","Apps - Confluence Questions",8,"Content type icon for Questions doesn't show up in user's profile activity stream","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47633].   {panel}  """
"CONFSERVER-31934","Bug","Integrations - JIRA",3,"Unable to create issues from Confluence when linked to EPICs","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31934].   {panel}  Steps to reproduce:    - Highlight a text in a Confluence page and click on the popup to create JIRA issue.  - Make sure the """"Link to epic"""" is available and tick it.  - You will be faced with this error:    !conf-3.png!    In the logs, I observed the following stack :          Reasons: This is a known limitation where issues cannot be created with Epic links if the """"Epic Links"""" field is not enabled as a  field in a default screen in JIRA. Created with Epic links if the """"Epic Links"""" field is not enabled as a default field in JIRA.  Workaround:   1. Not select an epic to link the issues to.   2. Add epic link as a field in default screen via secure/admin/ConfigureFieldScreen.jspa?id=1 with admin privileges.  """
"CONFSERVER-32067","Bug","Integrations - JIRA",5,"Too many JiraChannelResponseHandler objects cached on Confluence taking too much memory","""While investigating the latest EAC outage I found that there were too many large objects consuming old gen memory.    One of the offenders is the JiraChannelResponseHandler. See screenshot -    !jira.png!    So 840 objects consuming an average of 70Kb each is not reasonable (for EAC anyway, especially in conjunction with some of our other heavy cache using plugins).    Regardless of any actual bug fix you might consider making could you please also get in touch with me and advise on what kind of tuning of caches etc I should be performing on EAC to avoid this much memory being consumed again."""
"CONFSERVER-32187","Bug","Integrations - JIRA",1,"Confluence uses Display URL when rendering links to JIRA Pie Chart image","""Confluence correctly uses the Display URL when rendering links to JIRA issues in Confluence.     However, it also uses the Display URL when rendering the url for pie chart images, even though those images are not interactive. It seems that since the chart image only provides information from JIRA, it should use the Application URL instead.     h3.STEPS TO REPRODUCE    * Install Confluence 5.4.1, JIRA 6.1.5  * Create application link, without changing the Display URL  * In Confluence, create a JIRA Status report  * Charts should display as expected  * In Confluence, re-configure the application link by changing the display URL to a fake url (e.g., http://www.fakehost.com/jira)  * Chart images are now broken (see screenshot)    Network information from Google Developer Toolbar shows the GET request and the resulting response (see screenshot).    """
"CONFSERVER-32234","Bug","Integrations - JIRA",3,"JIRA Issue Macro not Rendering HTML in custom fields ","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32234].   {panel}  h5. Steps to reproduce:    # Create a custom field in JIRA that contains any HTML within the custom field.  # In Confluence, include a JIRA Issue Macro in a page, and retrieve a list of issues that contains the custom field above.  # HTML in those custom fields will not be rendered and it will show plain text exposing the HTML tags.    h5. Workaround    No workaround yet.    h5.Screen shot:    !htmlbroken.png|thumbnail!  """
"CONFSERVER-32258","Bug","Integrations - JIRA",3,"Chrome locks up when pasting URL into editor","""I pasted https://jira.atlassian.com/issues/?jql=reporter%20%3D%20igrunert%20and%20project%20in%20(%22Confluence%20Team%20Calendars%22%2C%20Confluence%2C%20%22Confluence%20Development%22%2C%20%22Confluence%20Questions%22) into the comment editor, and it kills the page. I think this is an autoconvert infinite loop."""
"CONFSERVER-32306","Bug","Integrations - JIRA",1,"If URL doesn't match baseURL, creating a inline actions JIRA issue results in ""Unable to get a list of linked JIRA servers from Confluence.""","""*Steps to Reproduce:*  # Note your baseURL  # Create an application link to (for example) https://jira.atlassian.com  # access your instance via a URL that isn't what you've set in your baseURL. For example, I used http://127.0.0.1:10540/confluence  # Attempt to create a JIRA issue via the inline action popup    This results in the following:  !Screen Shot 2014-01-21 at 1.30.53 PM.png!  """
"CONFSERVER-32457","Bug","Editor - Page / Comment Editor",3,"Editor toolbar behaves incorrectly on quick edit","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32457].   {panel}  There are strange behaviors with quickedit. Most of the issues revolve around using the editor toolbar in quick edit (not in full edit).  These have been confirmed in 5.4.1. (as long as quick-edit is enabled) and possibly go back to 5.1    Using options like bold now adds additional blank lines after the content  !bold.gif|width=100%!    When attempting to user the list toolbar buttons on quick-edit of a blank page I'm seeing the following in the logs, coming out of 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions' 'jscripts/tiny_mce/plugins/lists/editor_plugin_src.js'. The button will not work again until the user clicks inside the body    !number.gif|width=100%!    """
"CONFSERVER-32525","Bug","Integrations - JIRA",8,"Pages/Blogs timeout if they contain too many JIRA Issues Macros ","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32525].   {panel}  When a page/blog has too many JIRA Issues Macros, the page times out as Confluence tries to make JIRA calls for all the macros.    The correct behaviour should be to call JIRA asynchronously and timeout the individual macros, not the page.    The number of calls that JIRA can handle should also be considered. We should avoid overloading JIRA.    h3. Workaround:    Split out the JIRA Issues Macro onto separate pages.    Also avoid using functionality that avoids loading multiple pages at once, such as viewing the blogs posts of a space, as this will trigger many calls to JIRA simultaneously.    h3. Fix  Upgrade to [JIRA Macros version 5.5.4|https://marketplace.atlassian.com/plugins/confluence.extra.jira]. This was bundled in Confluence 5.5.    h3. Important note:  This fix makes use of JIRA request batching which is only available since JIRA *6.0.29*. For the older version of JIRA (5+), this fix has no effect."""
"CONFSERVER-32523","Bug","Integrations - JIRA",5,"JIRA Links Button Missing when Create a Link to an Existing Page with JIRA Links","""*Please note: this issue is marked as resolved in Confluence 5.5, but you will also need version 6.2 or later of JIRA (and if using JIRA Agile, 6.3.8 or later)*    In the meantime, it's possible to manually force the cached count to be updated by making an edit to the Confluence page.    -----    With JIRA 6.1.5    h6. Steps to Replicate  # Ensure the Application Links is configured correctly  # Ensure Remote API Calls is enabled in JIRA  # Create a new space with a new page (e.g: 'Page A') in Confluence, and insert a new issue using JIRA Issue Macro in the page  # The JIRA links button is displayed in this new page  # In JIRA, try to link an Agile Report/Board/Sprint to the newly created page ('Page A')  # Go back to Confluence, click on the JIRA links button in the 'Page A' and see if the JIRA Agile Report/Board/Sprint is shown  # Create another Agile Report/Board/Sprint and Link it to 'Page A' in Confluence  # The link is missing    Scenario 2:  # Make a page A in Confluence.  # Link to that page from JIRA.   # No links are shows on page A in Confluence"""
"CONFSERVER-32633","Bug","Editor - Page / Comment Editor",3,"Editing a link in link dialog shows all the breadcrumbs text and it spans multiple lines","""Editing a link shows the full breadcrumb path even for very long breadcrumbs, instead of putting an ellipsis between the first and last breadcrumb elements.    http://cl.ly/image/2V2S1q262z2z    """
"CONFSERVER-50009","Bug","Apps - Team Calendar",3,"Calendar with public and private filters shows no events","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-50009].   {panel}  A shared calendar that contains JIRA Issue events from both public and private filters will not show any events _at all_ for users if one of the private filters is restricted from them.     h3.Steps to Reproduce    * Create a new calendar and add JIRA Issue events from a filter shared with everyone  * Add JIRA Issue events from a filter that is restricted to the creator  * Add the calendar to a shared page  * Navigate to the page as a user who is restricted from the private filter. The calendar will be empty (screenshot: calendar_userview.png). The expected behavior is that the calendar would at least show the events from the public filter. Users who have permission to view the events from all filters will see all the events (screenshot: calendar_adminview.png)    h3.Log Errors        """
"CONFSERVER-32762","Bug","Content - Attachments",3,"Image rotation of imported photographs is wrong","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32762].   {panel}  This may or may not be a duplicate of [#CONF-17621], about EXIF rotation, marked as """"won't fix"""".  I understand from that issue that there is some debate about whether this is Confluence's issue or a browser issue.  Let me explain my experience.    # I take a picture with my iPhone, it displays it the correct way up  # I email it to myself, Gmail displays it the correct way up  # I accidentally import it into my Google Drive, it displays it the correct way up  # I download it to my Mac, it display it the correct way up  # I import it into Confluence, it displays it the wrong way round  # I start writing this ticket, and have an idea or two...  # I access it in Chrome using a file:// URI, it displays it the right way up  # I boot a Windows 7 VM and ping it over there, it displays it the right way up (perhaps a file:// URI in IE6 would be the nail in the coffin?)      {panel:title=Atlassian Status as of February 14, 2017|borderStyle=solid|borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}    Hi All,    Thank you for your feedback on this issue thus far. This is certainly an issue which has done its round on the internet over the years for many browser and application vendors alike, with each pointing the finger at each other as to whether the application or browser should observe the EXIF rotation metadata.    The obvious solution is for all browsers to support the 'image-orientation' CSS, however after many years this is still only supported by Firefox.  We have explored no less than 6 different solutions to this issue as each brings pros and cons in terms of performance, behaviour and complexity.  As a result of this exercise, it has been decided that image rotation would be done server side based on the EXIF rotation metadata.    The actual implementation is somewhat different for Server and Cloud deployments, and thus the rollout/delivery may occur at different times, however is high up in the queue right now.    Confluence Product Management  {panel}"""
"CONFSERVER-32777","Bug","Translations",2,"Mixed language in Confluence blueprints ","""h3. Step to reproduce:  # Set the language setting in User profile as Deutsch   # Set language  in Confluence Admin > Languages as English.  # Create a Meeting Notes.    h3. Observed Result:  As you can see, some part of the meeting notes are in Deutsch  and some are in English.  !sample.png!      This issue affect other blueprint as well.    h3. Cause  The mismatch occurs when the user's language is different from the global language. In some places, the global language is preferred over the user's.    h3. Workaround  If it is feasible, ensure that the global language (Confluence Admin > Languages) is set to the same language as the end user's. The end user should also ensure that their browser language is set to their preferred language."""
"CONFSERVER-32861","Bug","Integrations - JIRA",2,"Insert JIRA Issues dialog missing sidebar or displaying ""No Macro Metadata"" error","""h2. Problem summary  Disabling in-app notifications (or the underlying Workbox plugins) will cause the JIRA Issue dialog to break in a few ways. This seems to be a regression of CONF-30822, originally fixed in 5.4.0    h2. Steps to reproduce  # Set up Confluence 5.4.2 with an application link to a JIRA instance  # {{Confluence Admin > In-App notifications}}, and choose to disable in-app notifications  # Add/edit a page and perform the following two tests:  ## Click the Insert (+) sign and select JIRA Issue. *Problem 1: Observe """"No Macro Metadata"""" error*. Cancel out of this.  ## Start typing {jir and press enter to bring up the JIRA Issues panel. *Problem 2: Observe that the sidebar and insert buttons missing*     I was also able to reproduce this in 5.4.3.    h2. Workaround  https://confluence.atlassian.com/display/CONFKB/No+Macro+Metadata+When+Trying+To+Insert+JIRA+Issue+Macro    h2. Resolution  This issue is fixed in [JIRA Macros 5.5.2|https://marketplace.atlassian.com/plugins/confluence.extra.jira], which is compatible with Confluence 5.4 and above. The fix will be bundled in Confluence 5.5."""
"CONFSERVER-32915","Bug","Integrations - JIRA",3,"JIRA Issue Macro shows wrong application link name, but searches in the correct application","""I have two application links to two JIRA instances: my test JIRA (Localhost JIRA) and the company's JIRA. I created both application links, made the company's application link the primary one.    However, when I open the JIRA issue macro the wrong JIRA application link is selected, at least it seems so. However, when I excute a search, the search is triggered in the correct JIRA. I think the labels / names are not correctly set."""
"CONFSERVER-32971","Bug","Editor - Attachment",1,"Attachment table drop zone UI is not consistent between attachment macro and tool attachments page","""Also can reproduced in PUG, version 5.5-DEV-4143  Create a page, add attachment macro. The attachment drop zone UI in attachment macro look like these pictures  https://jira.atlassian.com/secure/attachment/111970/5.3.1-1024x-ff-1.png  https://jira.atlassian.com/secure/attachment/111973/pug-1024x-chrome.png  https://jira.atlassian.com/secure/attachment/111974/pug-1024x-ie-1.png    The attachment drop zone UI when access from Tools>Attachments, it looks like this  https://jira.atlassian.com/secure/attachment/111975/Tool-Attachments.png    Expect the attachment drop zone in Tools>Attachments page follow UI of attachment macro.  """
"CONFSERVER-33068","Bug","Macros - Page Properties",3,"""Sort by"" function in ""Page Properties Report"" macro doesn't work ","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33068].   {panel}  """"Sort by"""" doesn't work at all when the column heading has a capital letter in it.  When you use lower-case characters sorting is doing something but the order isn't good.    This problem lower significantly the value of the """"Page Properties Report"""" macro."""
"CONFSERVER-49411","Bug","Apps - Team Calendar",2,"Editing a calendar event series subtracts one day","""*Description:*  Each time the user edit a Calendar Event in series, as soon as the edit form is opened, the """"Ends until"""" date changes to one day before automatically.    *Steps to reproduce:*  1. Create an event in the calendar.  2. Set it to repeat daily (for example).  3. Select the """"until"""" radio button.  4. Select a date to end.  5. Save it.  6. Edit the first occurrence (for example).  7. Uncheck the """"Edit this instance only"""" check box.  8. See that """"Ends until"""" date changed to one day before.  9. Save it.    Each time the event is edited, this behaviour occur.    Example:  Create a event:  - What: Test  - When: 03-Apr-2014 to 03-Apr-2014  - All day event checked  - Repeat: Daily  - Repeat every 1 day  - Ends until 24-Apr-2014  - Click on """"OK"""" button.  (Attachment: create_event.png)    - Event successfully created.  (Attachment: event_created.png)    - Click on the first occurrence and select """"Edit"""".  - The edit form will open showing the Ends until date 23-Apr-2014 automatically.  - Uncheck the """"Edit this instance only"""" option.  (Attachment: edit_event.png)  - Click on OK.    - The event will end on 23-Apr-2014.  (Attachment: event_edited.png)"""
"CONFSERVER-33244","Bug","User - Management",5,"User autocomplete not finding all users","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33244].   {panel}  *Problem:*  Some usernames aren't autocompleted when mentioning or assigning a task to a user.    *Cause:*  When adding Confluence to a JIRA Cloud instance, users are not properly migrated over.  This also causes [Duplicates in the People Directory|https://confluence.atlassian.com/display/CONFKB/Duplicates+in+the+People+Directory] (covered by this bug [CONF-9857|https://jira.atlassian.com/browse/CONF-9857])    *Steps to reproduce:*  # create a JIRA only instance  # add users  # add Confluence to the instance  # grant access to the users  # try to mention a user that was created previously (before they access Confluence for the first time) accessing just JIRA won't update the 'content' table.  Created users won't be displayed in the People directory although they are Confluence users with access.  Once the user logs in to Confluence, the user is mentionable.    *Expected:* users are mentionable because they have Confluence access  *Actual:* users are not mentionable    *Temporary Workarounds:*  * Manually run a Content Reindex   (due to [CONF-33400 - Confluence Administrators unable to Reindex Manually|https://jira.atlassian.com/browse/CONF-33400] please contact support at http://support.atlassian.com to run the Content Reindex)  * Login the user to Confluence  * Visit their Profile page manually by changing the username on another Profile page."""
"CONFSERVER-33440","Bug","Integrations - JIRA",3,"Custom date field data from JIRA displays in incorrect format in Confluence","""See attached screengrabs. We're using a custom date field called """"start date"""" in JIRA. We're feeding this field into Confluence pages and as you can see from the attachments, it's not following the admin preference we've set for date display. Instead of showing as MMM dd, yyyy it is showing as dd/MMM/yy. It displays properly in JIRA, however."""
"CONFSERVER-51782","Suggestion","Apps - Confluence Questions",8,"Document the REST API by using Enunciate maven plugin","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51782].   {panel}  """
"CONFSERVER-33626","Bug","Integrations - JIRA",3,"JIRA Issues Macro broken for Single Issue Display","""h5. Overview    When the *JIRA Issue Macro* is included in a page and there are more than a single issue (Table Display), the *Preview* and after *Saving* the page links to all the issues works fine. Eg. If you have set your JIRA Base URL to {{http://localhost:8623/jira_623}}, the issue will show the respective link:        On the other hand, if you set to _Singe Issue_ Display (this is where it gets interesting):  h6. Situation 1 (4 or less JIRA Issue Macro): The links are still showing the correct URL    h6. Situation 2 (5 or more JIRA Issue Macro): The links are *broken*, whereby the _context path_ of JIRA is ignored totally.    !not_ok_1.JPG|thumbnail!        !not_ok_2.JPG|thumbnail!    h5. Symptoms  The links are still shown correctly in *Preview* mode but after saving it, the links are all broken    """
"CONFSERVER-33768","Bug","Integrations - JIRA",2,"Jira macro insert button is disabled after naming a Jira custom field ""Length"" for any linked Confluence instance","""{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33768].    {panel}    h4. The problem:  The _Insert_ button in JIRA Issue Macro is greyed out and a Javascript error is thrown in the browser console:      The following appears on the screen:  !insert_button_not_working.png|thumbnail!    This error refers to the following JavaScript:      h4. Steps to reproduce:  # Install a Confluence 5.5.2 instance;  # Install a JIRA instance 6.2.6, and add a single line text field with name *Length* and global context;  (i) This issue also occurs when defining name *Length* in the [customfield translation|https://confluence.atlassian.com/display/JIRA/Configuring+a+Custom+Field#ConfiguringaCustomField-Translatingacustomfield].  # Setup an application link between Confluence and JIRA;  # Create a page and open the JIRA Issues Macro, and try and run any sort of query.     The results will return, but attempting to click the """"Insert"""" button won't do anything. Checking the JavaScript console in the browser should show the error above.     h4. Additional information:  After some debugging we narrowed it down to the fact that Confluence doesn't appear to escape some field names that can be misinterpreted as array method names. In this case, the Jira custom field was called *Length* and appears to be misinterpreted as a call to the {{array.length()}} method of a given array r[]    This didn't happen with Confluence 5.1.5, so the bug was introduced since then.    h4. Diagnosis:  Running this SQL Query on Jira Database should yield the easiest diagnosis if there is a custom field called *length*:  {code:title=Run on Jira Database}  select * from customfield where lower(cfname) = 'length'  {code}      h4. Workaround:   # Access the URL {{http://<JIRA_URL>/rest/api/2/field}} and use the search functionality in your browser to find the word *Length*, or execute the query bellow to identify the custom field that is causing this issue:   {code:sql}   select ps.propertyvalue as """"Translation"""", cf.cfname as """"Custom field"""" from propertystring ps join propertyentry pe on pe.id=ps.id join customfield cf on cf.id=pe.entity_id   where pe.property_key like'%jira.translation.custom.fieldcustomfield%' and lower(ps.propertyvalue)='length' or lower(cf.cfname)='length';   {code}   # Rename the custom field or custom field translation."""
"CONFSERVER-33792","Bug","Macros - Task Report",3,"Empty task item crashes Task report Macro","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33792].   {panel}  When a page contains a Checkbox without any Text written next to it the Task report Macro crashes the site it is embedded in. Here is the Stacktrace:  """
"CONFSERVER-33889","Bug","Integrations - JIRA",3,"JIRA issue description doesn't save when using Firefox","""When you insert a JIRA issue into a Confluence page the JIRA issue description is not always saved.     We noticed that this was only happening for some of our employees but not others. The employees all have the same permissions so It wasn't until we did some browser testing that we found the problem.     The JIRA issue description gets saved when Confluence is open in a Chrome browser but not when open in Firefox.     """
"CONFSERVER-33990","Bug","Page - Export / Import|Space - Export / Import",3,"Missing web image causes PDF space export to fail repeatedly","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33990].   {panel}  Steps to replicate:    # Create a page, and on that page paste in an image on the internet that will not load.  # Create a PDF space export of the space containing that page    Result:    Export will continue to run forever and the following error will be displayed in the logs:        Expected Result:    Either the export will fail, or it will produce an export that does not contain the image."""
"CONFSERVER-34066","Bug","Editor - Page / Comment Editor",1,"Bullet list keep extra space line after merged","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34066].   {panel}  Step to reproduce:   # In add two bullet list in the page like  !before.png!   # Remove the line contain the string """"line 2"""", and it keeps one extra empty line after merging two bullet list.   !after.png!    As a workaround solution, press the back space at the beginning of the second bullet list to remove the empty line."""
"CONFSERVER-34149","Bug","Integrations - JIRA|Macros - JIRA Macros",2,"JIRA Issue Macro not showing value for Σ Remaining Estimate","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34149].  {panel}  h3. Summary    Total Remaining Estimate values are not showing in Jira issue macro in Confluence.  h4. Steps to reproduce   # Configure applink between JIRA and Confluence   # Create a DEMO project in JIRA   # Create a sub-task to one of the issue   # Add Remaining Estimate value for the parent and sub-task issues   # Create a page, add JIRA Issue Macro with filter of {{project = DEMO}}   # Include {{Σ Remaining Estimate}} for the _Columns to Display_   # Search in JIRA using {{project = DEMO}} and compare the results    h3. Expected Results    The value should be showing correctly in Confluence as it is already in JIRA.  h3. Actual Results    The Σ Remaining Estimate values are missing.   !screenshot-1.png|thumbnail!  h3. Additional Information    Last reproduced on Confluence 6.15.6 and JIRA 8.2.4.  Issue can be seen on the following column as well:  * Σ Original Estimate  * Σ Time Spent     Screenshots of JIRA, Confluence, and XML data from JIRA search   !Selection_004.png|thumbnail! !Selection_005.png|thumbnail! !Selection_006.png|thumbnail!  h3. Workaround    No workaround."""
"CONFSERVER-34204","Bug","Server - Administration",2,"findspaceattachments.jsp fails","""When attempting to run findspaceattachements.jsp with a valid space key the following error pops up in our log:      The full error:  """
"CONFSERVER-34246","Bug","Integrations - JIRA",8,"JIRA Issues Macro contributes to performance problems and outages in OnDemand","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34246].   {panel}  JIRA Issues Macro contributes to performance problems and outages in for large cloud customers. This overloads Apache and JIRA, eventually causing [AOD-6539|https://jira.atlassian.com/browse/AOD-6539] in some cases."""
"CONFSERVER-34264","Bug","Integrations - JIRA",1,"JIRA Chart Not Rendered when Inserting to Confluence page and throwing 504 Error ","""h4. Summary  Trying to add JIRA Charts in Confluence page will render the chart properly in the screens before inserting it to the page, but clicking on _Insert_ will get the chart disssapear and the Confluence page is unable to be saved. Seems like Confluence renders JIRA Charts data using both Application URL and Display URL.    h4. Steps to reproduce  (*execute the test from machine1*)  # Set up JIRA on machine1 (sample IP: 10.60.5.193) and Confluence on machine2 (sample IP: 10.60.5.198)  # (Test scenario) Current Base URL of JIRA is *http://10.60.5.193:8630/jira* and Confluence is *http://10.60.5.198:10561/confluence*  # Set up /etc/hosts on machine1 with _127.0.0.1 jiraisawesome_  # Login to *http://10.60.5.193:8630/jira* from *machine1*  # Set up application link using IP and ports (e.g: connect to *http://10.60.5.198:10561/confluence*)  # Login to *http://10.60.5.198:10561/confluence* from *machine1*  # Create a new Confluence Page  # Insert JIRA Chart by searching any existing JIRA project and Save the page (_Chart is displayed successfully_)  # Login to *http://10.60.5.193:8630/jira* from *machine1*  # Change the base URL of JIRA to use *http://jiraisawesome:8630/jira*  # Login to *http://10.60.5.198:10561/confluence* from *machine1*  # Modify the application link of JIRA - Display URL in Confluence to use *http://jiraisawesome:8630/jira*  # Perform Step 7 and 8 again    Here are the results  * We can view the chart in the preview of the prompt, but when _insert_ the chart, its not showing in the page preview and unable to click on the save button.  * URLs of the problem can be seen in the browser's developer mode  {code}HTTP 200 http://jiraisawesome:8624/jira/charts?filename=jfreechart-onetime-2627007503907999135.png    HTTP 504 http://10.60.2.176:8553/553/plugins/servlet/image-generator?macro=jirachart&jql=project+%3D+DEMO&statType=assignees&appId=29d6aed3-a496-3929-a14b-c4653473b6b3&chartType=pie&authenticated=true{code}    h4. Logs information  * Confluence log    * JIRA logs      h4. Additional Information  JIRA 6.2.7  Confluence 5.5.3    h4. Use case  There are users who configures JIRA and Confluence integration to be using a different Application URL than the Display URL. This configuration is used when the two servers not able to be contacted between each other using the Display URL. At times this is the prefered configuration with communication between two internal servers to be using internal IP/hostnames instead of the external IP/hostnames.    h4. Expected behaviour  The charts to be rendered normally in Confluence when using configurations of Display URL different than Application URL. With Display URL not necessarily able to reach the other server, but Application URL can."""
"CONFSERVER-34274","Bug","Server - Administration",1,"Help tips wrongly formated in ""Page Level Permissions"" screen","""The _Help Tips_ in the _Page Level Permissions_ are wrongly formatted and it is very difficult to read the permissions (check left side of the screenshot).    Reproduced in Google Chrome 35.0.1916.153 on Linux."""
"CONFSERVER-34385","Bug","Page - Export / Import",3,"Embedded images placed inside of a table are not displaying properly when page is exported to PDF","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34385].   {panel}  h3. Summary  Images in tables that are not manually sized increase in size or are missing when exported to PDF.    h3. Steps to Reproduce  # Create a table in a Confluence Page  # Insert an image in one of the cells  # Export page to PDF    h3. Expected Results  The exported PDF matches what is displayed in the page when viewed    h3. Actual Results  The small image is displayed much larger than its actual size or the image is missing in the table.    h3. Workaround  # Edit page with the image  # Click on image, resize to any size *use the _px_ value* . i.e. :  !Screen Shot 2015-04-17 at 3.03.42 AM.png|thumbnail!  # Press enter to apply the change to the image  # Click on image again, resize back to the desired size i.e. :  !Screen Shot 2015-04-17 at 3.03.59 AM.png|thumbnail!  # Press enter to apply the change and save page  # Export page to PDF"""
"CONFSERVER-34406","Suggestion","Integrations - JIRA",3,"Support batching for old wiki markup in the old format {jira:ABC-xyz}","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-34406].   {panel}  In [CONF-32525|https://jira.atlassian.com/browse/CONF-32525] batching was introduced for pages with multiple JIRA Issues Macros. This batching did not extend to JIRA Issues Macros which were entered in wiki markup, eg:      Please support batching for wiki markup format as well.      h3. Resolution  This issue has been resolved in JIRA Issues Macro version 5.6.3. Please download this version from the Marketplace (https://marketplace.atlassian.com/plugins/confluence.extra.jira/versions)"""
"CONFSERVER-34628","Bug","Editor - Page / Comment Editor",1,"Empty page layout cells are excluded from storage format","""Steps to reproduce:    1. Create a page with a 2 column layout  2. In the left column, add a heading  3. Save the page - observe that the heading is in the left column  4. Edit the page, select all the content in the left column, cut and paste into the right column  5. Save the page and observe that the content has not moved    Workaround is to ensure that the left column has some content (e.g. a space).    It turns out that empty page layout cells are excluded when the page is converted to storage format.    Storage format for two-column layout with an empty cell (storage format is the same regardless of which column has content):      Storage format when both columns contain content:  """
"CONFSERVER-34529","Bug","Search - Indexing",3,"Unable to Search Office Open XML Files","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34529].   {panel}  # Create 2 duplicate documents, 1 .doc and 1 .docx  # Attach both in Confluence  # Perform search of text that is in file, results only return .doc file.  # Also both attachments do not appear in drop-down search window that comes up, you have to click the Search query to see it."""
"CONFSERVER-34716","Bug","Core - Content REST APIs",1,"REST API throws 500 with null pointer exception","""I'm sending the following via PUT using the REST API browser    The response looks like:    {panel}  Response  PUT http://confluence.imagehawk.local:8090/rest/api/content/2359303 (500)  Date: Wed, 27 Aug 2014 20:24:25 GMT  Content-Encoding: gzip  X-Content-Type-Options: nosniff  Server: Apache-Coyote/1.1  X-Seraph-LoginReason: OK  Vary: User-Agent  Content-Type: application/json  Access-Control-Allow-Origin: http://confluence.imagehawk.local:8090  Transfer-Encoding: chunked  Connection: close  Access-Control-Allow-Credentials: true  Access-Control-Allow-Headers: Content-Type  X-AUSERNAME: mjones  {panel}    """
"CONFSERVER-34751","Bug","Space - Export / Import",3,"Importing an XML Export does not create inline tasks and comments correctly","""{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34751].    {panel}    {panel:title=Fix description|borderStyle=solid|borderColor=#ebf2f9 | titleBGColor=#ebf2f9 | bgColor=#ffffff}  Hello everyone,    The fix for this issue will not fix the links for XML exports that are already imported, but will prevent the issue from happening on newer import jobs.  This applies to Space XML exports prior to Confluence 7.0.1 as well, and they will not hit into this issue if imported into Confluence 7.0.1 and later.  {panel}    h5.Steps to Reproduce  # Create a new Space  # Export the Space as XML  # Delete the Space you just created  # Import the Space Export  # On a page, create the Task Report Macro, and point it at the imported space.    h5.Expected Result  The Task Report Macro should show the tasks that are incomplete, or complete (depending on the settings). Using this example, the report should show 4 incomplete tasks (from the default home page)    h5.Actual Result  The Task Report Macro doesn't show the tasks that are incomplete. Marking a task as complete and then incomplete doesn't show the task either.    The task does not appear in the database.     h5.Workaround (not applicable to Confluence Cloud)  # Perform a full backup of the Confluence Database  # Shutdown Confluence  # Execute the following SQL Queries:   # Start Confluence    Confluence will re-migrate any inline tasks to the new inline task format, which will correctly re-add the tasks not handled when importing.    h3. Notes    It is possible to tweak the migration task thread number to speed up the process. To do so, add the following system property to the instance before starting the process:      To define the ideal number of threads for the process, we can use the following formula:  """
"CONFSERVER-34793","Bug","Integrations - JIRA",5,"JIRA Issues Macro returns ""Data cannot be retrieved due to an unexpected error""","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34793].   {panel}  h3. Note    This error message is the catch-all exception for the JIRA Issues Macro, so there are a number of possible causes for this. The below example is one way of triggering the problem. Another known cause is the response from JIRA taking too long and exceeding the timeouts in Confluence. If you suspect this is the case in your instance, please refer to [this KB article|https://confluence.atlassian.com/display/CONFKB/Timeouts+in+the+JIRA+Issues+Macro+or+Highlighting+Plugin] for more information.    If you run into this problem, please add the following packages to *Confluence Admin > Logging and Profiling* and set them to DEBUG level logging:  * com.atlassian.confluence.extra.jira  * com.atlassian.confluence.plugins.JIRA    Having done so, please create a ticket at http://support.atlassian.com/ and attach a Support Zip with this extra logging.     h3. Steps to reproduce    # Add many JIRA issue links on a Confluence page. Try 30.  # Save the page    h3. Expected Results    The JIRA issue links display fine with summary, status, etc.    h3. Actual Results    Confluence displays an error message for each JIRA issue link:    bq. JIRA Issues Macro: Data cannot be retrieved due to an unexpected error    h3. More info    Confluence logs show:    """
"CONFSERVER-47583","Bug","Apps - Confluence Questions",3,"Fail create the question will cause you loosing the Files attached in the ""insert image dialog""","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47583].   {panel}   Steps:  - Create a question, add some image on it. You can attach image on the question  - Before you click button """"save"""", make sure you have no label. Click save. It will tell you that you need to select a topic  Error:  - Check the """"insert image dialog"""" again, you will see there are no file attached.    This issue is found on version confluence-questions-1.0.618 which doesn't have to rework of insert dialog yet."""
"CONFSERVER-34990","Bug","User - Global / Space Permissions",2,"Copy Page: Notifications are sent to receivers that cannot view the page","""Don't use Copy Page function for copying restricted pages. If the space is watched (through Space watch and RSS); notifications are sent even if restrictions are set that should inhibit such notifications.    To reproduce:  1. Restrict viewing for a page to some individuals.    2. Log in with an account that is not allowed to see the page. Watch the space containing the page (through Space watch and RSS).    3. Log in with an account that has viewing access and editing permission for the page. Copy the page.    4.The watcher will be notified although the watcher has no viewing permission.    Expectation:  If a a page viewing restriction is set, it is also applied to page copies before notifications are sent.    Technical issue:   It seems that page restrictions are set or checked after (instead of before) the copy-page notification is generated."""
"CONFSERVER-35080","Bug","Content - File Previews",5,"Adding a pptx into Confluence fails with ""There was a problem converting this attachment""","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-35080].   {panel}  If you upload a pptx file into a Confluence page you will get the following error:  !img.PNG|thumbnail!    Into the atlassian-confluence.log you will get below stack trace:      h4. Steps to Reproduce:  # Setup a Confluence 5.6.3.  # Create a test page.  # Drag and drop the example attachment added in the restricted comment (it's for internal use only).  # Save the page.    h4. Notes:  * The power point file was created in Office 2013.  * Office Connector version 3.3.8 (latest on Confluence 5.6.3)  * We don't know which specific configuration causes this error.    h4. Additional information  The error occurs on this pptx ([link|https://support.atlassian.com/secure/attachment/1104238/1104238_WG_GlobalPres_template_del_001+%281%29.pptx]) as well.  However, once the pptx is modified by 'Save As' PowerPoint 97-2003 Presentation (.ppt) or PowerPoint Picture Presentation (.pptx), it can be displayed successfully."""
"CONFSERVER-35114","Bug","Core - Content REST APIs",1,"REST API documentation refers to children instead of child in its examples","""In the examples for https://docs.atlassian.com/confluence/REST/latest/#d3e456, we see {{http://example.com/rest/api/content/1234/children/comment}}."""
"CONFSERVER-35282","Bug","User - Mentions",1,"SOAP Method addProfilePicture() no longer creates @mention thumbnails","""This used to work in Confluence 5.4.3. Since upgrading to 5.5.6, I can no longer update a user's @mention thumbnail picture.    As there is no REST equivalent for this method, we'd really appreciate a fix or workaround.    h2. Reproduction:    1. Use the sample [Python script|https://answers.atlassian.com/questions/72487/how-do-i-use-addprofilepicture-in-python] to upload a 48x48 picture.   2. User's @mention picture will show the generic unset avatar  3. User's full profile picture in their homepage shows the correct avatar    h2. Workaround:  Trigger a reindex via Confluence Admin > Content Indexing    """
"CONFSERVER-35279","Bug","Navigation - People Directory",5,"Missing people from People Directory on Confluence","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-35279].   {panel}  *Steps to Reproduce:*  # Have JIRA + Confluence  # Add user just to JIRA (jira-users)  # Grant this user application access to Confluence. Let's say, update the same user and add him/her to Confluence (confluence-users)    *Expected Results:*  # This user should show up in the People Directory on Confluence.    *Actual Results:*  # This user is missing from People Directory on Confluence    *Workaround:*  # Access this URL:      *Notes:*  Documentation ([Searching the People Directory|https://confluence.atlassian.com/display/confcloud/Search+the+People+Directory]) states that  bq. The people directory includes anybody who has logged into Confluence or *who has had a user account created for them in Confluence*."""
"CONFSERVER-35306","Bug","Integrations - JIRA",3,"Confluence does not respect the selected application when creating an issue through the JIRA Issues Macro.","""When Confluence has Application Links created for more than one JIRA, if the user tries to create a new issue through JIRA Issues Macro on the JIRA that is not set to primary on the applinks list, Confluence actually creates the issue on the primary JIRA instead.    Also, if both projects (from Primary JIRA and the other JIRA) have different types for issues, the creation button won't work, keeping Confluence on the same screen.    *Steps to reproduce:*  # Install 2 JIRA 6.2.3 instances  *On JIRA 1*  # Create a new Software Development project called """"Project1""""  *On JIRA 2*  # Create a new Simple Issue Tracking project called """"Project2""""  (i) The Project Type does not matter, we just need to create a custom Issue Type  # On JIRA2. create a custom Issue Type called """"new"""", for example  # Now, install a Confluence 5.6.3  # Create the application links between Confluence and those 2 JIRA instances  # Set *JIRA1* to primary on Confluence's applinks list  # Create a page on Confluence  # Insert the JIRA Issues Macro  # Create a new issue  # Server = JIRA1, Project = Project1, issue type = Bug, fill in summary and description  # Click insert  #* Issue is created and displayed on page  # Save the page  # Edit the page  # Insert the JIRA Issues Macro  # Create a new issue  # Server = JIRA2, Project = Project2, issue type = new, fill in summary  # Click on insert  #* No response - popup still open, nothing changed  # Change issue type to _New Feature_, fill in summary   # Click on insert  #* The issue is inserted, however, if you look at this just created issue, it was actually created on JIRA1 (Project1) instead of JIRA2 (Project2)    Also, another issue related to this bug is if the secondary JIRA (JIRA2) has 2 projects while the primary JIRA (JIRA1) has only one. If the user selects the second project, Confluence shows a red error text: """"Project is required"""""""
"CONFSERVER-35516","Bug","Core - Content REST APIs",1,"AttachmentResource.update incorrectly requires version+1","""PUT to rest/api/content/<id>/child/attachment/<attachmentid> only updates attachment metadata - it doesn't change the attachment content nor create a new version, which is correct.    However it requires that the version in the post is <currentversion+1> (it rejects <currentversion> with a 409 Conflict error), which is incorrect, since the metadata on <currentversion> is updated, and no <currentversion+1> is created."""
"CONFSERVER-35681","Bug","Editor - Page / Comment Editor",2,"Pages including own excerpt show error rendering macro 'excerpt-include' : null","""Since recently upgrading Confluence to latest stable versions, pages with excerpt-include references to the page on which they are on no longer work correctly. Instead displaying the message...    Error rendering macro 'excerpt-include' : null    So, to clarify. Impacted pages have the """"Excerpt Include"""" macro with the """"Page Containing the Excerpt"""" parameter set to the current page, the very same page where the macro itself resides. Hope that makes sense.    Here's the source, looks like this could be an issue with the Macro Browser as the name parameter appears to be a null link. Hope this helps...    <ac:structured-macro ac:name=""""excerpt-include""""><ac:parameter ac:name=""""""""><ac:link /></ac:parameter></ac:structured-macro>"""
"CONFSERVER-35755","Bug","Core - Content REST APIs",3,"REST API ""list pages"" does not return all pages","""When I try to list all pages in a space using the REST API, I send HTTP GET to:  """"http://localhost:8090/rest/api/content?limit=1000'"""". I get back 100 entries and a """"next"""" link to the next 100 entries.  Following the links until there is no """"next"""" in the result, Confluence returns only 300 entries from a space which contains 342 pages.    Using the JSON-RPC API returns all pages without a problem.    When I tried to repeat the queries """"manually"""" using execution of multiple """"curl"""" calls I got back more entries but many were duplicates.    I think this likely has something to do with restrictions and the PaginationService"""
"CONFSERVER-35780","Bug","Integrations - JIRA",5,"NPE when display single JIRA issue link with anonymous user","""Here are the steps to reproduce:  # Install JIRA 6.1.x or later and Confluence 5.4.x or later.   # Set up the application links between JIRA and Confluence with trusted applications and Oauth using the option """"Allow user impersonation through 2-Legged OAuth"""".  # Create project TEST with one issue TEST-1. JIRA and project do not have anonymous access.  # Create a new space on Confluence with anonymous access.  # Copy the issue link and parse the link to an empty page.   # Try to open the page with anonymous user. Then got the error:      If switch the single issue link to a table view by change the JQL, the NullPointerException is gone."""
"CONFSERVER-35945","Bug","Page - Export / Import",3,"Export to PDF, Centered Images are not included in .pdf file","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-35945].   {panel}  PDF Exports of wiki page with centered images don't include images.    *Steps to reproduce:*  # Create a page and insert an image jpg, png etc...  # Export the page to PDF. You should see that the image(s) did export.  # Edit the page and align the image to the center.  # Export the page to PDF again.  *Expected result:* Image shows in the center.  *Actual result:* Image is not displayed.    *Cause:*  The alignment done using the image tags is not being exported:    This is the """"Storage Format"""" of a centered image that is not exported to PDF:    and this is the one of an image centered by using the workaround and is exported to PDF (without alignment)        *Workaround:*  center-align the cursor +before+ including the image to the page.  The image will be added in the center and will be displayed in PDF exports.        """
"CONFSERVER-48944","Bug","Apps - Team Calendar",5,"The event of Calendar creation is viewable at Activity even by users who are restricted","""The event of calendar creation is viewable at Activity even by users who are restricted. Hence, users have to be careful not to describe sensitive information on the name of calendars.    This is how I reproduced:  # Install Confluence 5.6.6  # Install Team Calendar 5.1.21 addon  # Create two confluence-users - user1 and user2  # Login as user1 and:  ## create a calendar - """"User1's Calendar""""  ## Give viewing restrict only to user1  # Login as user2 and:  ## Go to People Directory and choose user1  ## user2 can see the activity that """"User1's Calendar"""" was created though user2 cannot view the calendar (See also the attached ActivityStream.jpg)    """
"CONFSERVER-36376","Bug","Page - Export / Import",3,"PDF Export: Images on the beginning of a page have huge white space in front","""Images in a pdf export, which doesn't fit on a page are moved to the next page. With Confluence 5.7 these images have exactly the same whitepace in front, which was left blank on the page before. For large images, that can be more than half of the page. In this case the image is split on the following 2 pages.    The attachment is from a fresh space with no css styling. Sadly I didn't find any workaround for that (margin/padding has no impact as well as setting a fixed size of the picture). This bug prevents proper exports of customer documentation."""
"CONFSERVER-36424","Suggestion","Core - Content REST APIs",3,"REST API to render content needs content id support","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-36424].   {panel}  See CONF-25086 which was marked as fixed, but was not complete.    Add a Content representation with embedded styles, similar to SOAP API.  """
"CONFSERVER-36547","Bug","Integrations - JIRA",8,"Jira Issues Macro slowdown when saving pages","""When saving a page with Jira Issues Macro on it *and* you've authorized the connection, page saving gets very slow, and lots of DB and/or JIRA requests (not sure which ones) are made, making the node/instance very slow.    This impacts versions 5.8, 5.8-m13 and 5.8-m18 of the JIRA issues macro"""
"CONFSERVER-36560","Bug","Content - Blueprints / Templates|Editor - Page / Comment Editor",2,"Task Report Macro Headers field from Confluence Inline Tasks plugin are not translated.","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-36560].   {panel}  h3.Step to replicate  # Create a page with a Task Report Macro   # Change the language setting  for the user to a non English language  # Go back to the page.    h3. Expected Result  The Task Report Macro is displayed in the selected languages      h3. Observed Result  The Headers of the Task Report Macro are not translated even when a different languages is selected.  !test_1.png|thumbnail!    h3. Cause  The mismatch occurs when the user's language is different from the global language. In some places, the global language is preferred over the user's.    h3. Workaround  If it is feasible, ensure that the global language (Confluence Admin > Languages) is set to the same language as the end user's. The end user should also ensure that their browser language is set to their preferred language."""
"CONFSERVER-36711","Bug","Page - Export / Import",3,"Regression: Large images are cut off on PDF Export","""The original thread: https://jira.atlassian.com/browse/CONF-33727    A large image is just cutted in width on a PDF export instead of being resized.    h3. Steps to reproduce:    # Create a new page;  # Include an image (I am attaching the one I used in the test, adding borders in order to better notice the cut);  # Save the page;  # Export as PDF;  # Notice the right part is cut.  """
"CONFSERVER-36841","Bug","Macros - Other Macros",3,"5.7 Comments Not Working on Headings when other Macros on page","""Hi there,    This page won't allow me to add comments to the headings. Running Confluence 5.7. Any ideas?  !testing.png|thumbnail!    Here's the page's source code:   !testing.png|thumbnail!      """
"CONFSERVER-48462","Bug","Apps - Team Calendar",3,"Sort Event Types alphabetically in calendar view","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48462].   {panel}  Steps to reproduce:  - Add new calendar  - Add some custom Event types for the new calendar, named """"A"""", """"B"""", """"C"""" etc.  - Add events with the different custom event types  - In the calendar view page, the event types are not sorted alphabetically, but in an odd and not comprehensible order. See screenshot.    This is very annoying in a calendar with many event types."""
"CONFSERVER-37890","Bug","Macros - Page Properties",3,"Page Properties Report is fetching a limited number of pages","""h3. Summary  Page Property Report Macros only fetches a limited number of pages.     h3. Environment  Experienced in 6.3.1 while issues reported from previous versions listed in the """"Affected Version""""    h3. Steps to Reproduce   h5. How to reproduce method #1: Use the sample Space Export   Get this XML space export  [^900pagesPPRmacro.zip]  which is a space that contains 900 pages containing Page Property macro with the labels """"discussion""""  # Load the page with the title """"PP Report Macro with Number of items to display = 100"""" from the xml export  # Load the page with the title """"PP Report Macro with Number of items to display = 10000"""" from the xml export    h5. How to reproduce method #2: create own space with 900 pages containing page-properties (any number more than 500):  {panel}  # create a space with more than 500 (eg: 900) pages containing page-properties.  # create a page containing the page-properties-report macro and set the """"number of objects to be shown"""" to 100 and 10000    {panel}    h3.Expected Results  # all 900 pages should be listed and the page should have 9 tabs appeared (100 result for every tab)  # all 900 pages should be displayed    h3.Actual Results  # only 5 tabs are listed in this page (100 pages on every tab = only displaying 500 pages)  # only 500 pages are listed   #* Results may vary from 500-550     The following appears in atlassian-confluence.log:    # Increasing http threads and database connection threads does not make any difference  # Disabling Analytics does not make any difference and the logs above still appears  # Increasing Page Property Report Caching does not make any difference    h3. Notes  The issue is specifically caused by an issue in """"fetching"""" the complete result. This is because when we change the Page Property Report macro configuration as """"Reverse Sort"""" (and the pages are sorted based on modified date), the oldest pages now appears in the list while the recently created pages disappeared.  """
"CONFSERVER-38036","Bug","Search - Core",5,"Confluence Attachment search does not work if the attachment name has hyphen  ""-""","""I have uploaded an attachment which has hyphen(""""-"""") in its name, to a confluence page.   When I try to search the attachment by clicking """"insert -> images -> Search -> This space"""",   attachment was not found in Search result.   Confluence Search is not able to find the attachment if it has """"-"""" in the name.    +Steps to reproduce:+  * Upload an attachment which has """"-"""" in it's name to a confluence page.(Ex: Outlook-encrypt.png)  * Edit the page and try to embed the attached image on this page by clicking """"images => Search => This space"""".  * Enter the search string as """"Outlook-encrypt"""" and search.  * Even though attachment exists, it will not be displayed while searching with search string """"Outlook-encrypt"""".    It's very common practise to have hyphen in file names.   There are many attachments uploaded to our Confluence pages by users have the hyphens in attachment names.  Our users are not able to search the attachments because of this issue."""
"CONFSERVER-38277","Bug","Macros - Gadgets",3,"Confluence Page gadget throws ""The resource rest/webResources/1.0/resources, cannot be found."" error","""h3. Summary  After creating an application link between JIRA and Confluence, have JIRA subscribe to Confluence gadget and add the *Confluence Page Gadget* to a JIRA dashboard. You will see the following error in it.    h3. Steps to Reproduce  # Install JIRA 6.4.7 with context path (http://localhost:6471/jira)  # Install Confluence 5.8.4 with context path (http://localhost:5841/conf)  # Create an AppLink between them  # Subscribe to Confluence gadget in JIRA  # Add the *Confluence Page Gadget* to a JIRA dashboard  # Select a space and a page    h3. Expected Results  The page shows up fine with no error    h3. Actual Results  You will see the below error while nothing is thrown in the logs:    *The resource /conf/rest/webResources/1.0/resources, cannot be found*  !error.png|thumbnail!    Clicking on the link will redirect to http://localhost:6471/conf/rest/webResources/1.0/resources which is the wrong port/context path combination     h3. Notes  * Tested with both Trusted Application and OAuth  * Also tested with JIRA 6.3.15 and Confluence 5.8.4  * Does *not* happen with JIRA 6.4.7 and Confluence 5.7    h3. Workaround  If JIRA and Confluence URLs do not have a context path, the error doesn't appear."""
"CONFSERVER-38191","Bug","Macros - Page Properties",2,"HTML-encoded characters aren't found in text searches","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-38191].   {panel}  Found with customer [~georg.kraler1] in a Page Properties Report issue CONF-37890.    Specifically, pages with words including &amp;uuml; aren't being found when searching for ü."""
"CONFSERVER-38182","Bug","Editor - Page / Comment Editor",3,"Internet Explorer 11 memory increases continuously when browsing Confluence","""h3. Summary    When browsing Confluence via IE 11 , the browser memory increases and after sometime IE does not response.  h3. Environment    Internet Explorer 11  h3. Steps to Reproduce   # Access Confluence using IE 11   # Open any page (You can also test this on confluence.atlassian.com)   # Press the development tools with F12, open Memory and start profiling ([https://msdn.microsoft.com/en-us/library/dn255003(v=vs.85).aspx])   # Just switch between pages and browse the confluence instance   # You should see an increase of memory usage with every switch    h3. Expected Results    IE 11 should not crash and run normally  h3. Actual Results    IE 11 stops working  h3. Notes    You will not be able to replicate this issue if you have large amount of RAM on your machine . I was able to replicate this when the browser memory reached 2 GB .  {panel:title=Atlassian Resolution|borderStyle=solid|borderColor=#3c78b5|titleBGColor=#3c78b5|bgColor=#e7f4fa}  Thanks for your interest in this issue.    As we dug deeper into the IE11 memory leak issue, we have been able to reliably reproduce the leak within IE11 11.0.9600.18861 (circa 08/2017) on Windows 8. Using a vanilla Confluence installation and refreshing the page a number of time, it can be observed that the memory consumed by the page itself remains consistent, however the iexplore.exe process continues to grow.    Restesting on IE11 11.251.16299.0 (circa 02/2018) and Edge 41.16299.248.0 on Windows 10 we were unable to reproduce the same memory leak.    We have not been able to find a definitive list of the issues fixed in this IE11 release, but believe the issue is [Memory leak - IE Edge - Microsoft Edge 8020622|https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8020622/] (previosuly fixed in Edge only). Therefore, whilst we are confident that this issue can be resolved, there is a small chance that there still remains an issue.    *Resolution:* Please upgrade to Windows 8/10 and the latest version of IE11 (11.251.16299.0) circa 02/2018 and Edge 41.16299.248.0 or greater to fix this issue. NOTE: The issue persists on Windows 7 for which we have not plans to address this as we believe the issues lies with Microsoft.    Cheers,    The Confluence Server team  {panel}"""
"CONFSERVER-38951","Bug","Content - Inline Comments",3,"Inline Comments Missing After Space Export/Import Process","""{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-38951].    {panel}    h3. Summary  In-line Comments and Resolved Comments are imported with a Space Export, but throw a 500 error when the REST call is made for rendering the Page. This has been replicated with space exports from Confluence Cloud and Confluence Server.    h3. Environment  * Confluence Cloud  * Confluence Server 5.7, 5.8.18 or 5.9.4.  * The Space has Resolved in-line comments    h3. Steps to Reproduce  # Go to a Space and a Page within that Space. Add two in-line comments and resolve one of them.  # Do a full XML export of the Space  # Import the Space export into a new instance (either same version or same major version)  # Notice the import completes successfully, but the in-line and resolved comments are not displayed even though they are present in the {{entities.xml}} file and database.    h3. Expected Results  In-line comments are displayed.    h3. Actual Results  The in-line comments are imported into the database, however the {{user_key}} is not mapped correctly from the old instance to the new instance.     h3. Workaround  {color:red}SQL manipulation in the database is not supported. Please make sure you have a database backup.{color}    # Shutdown Confluence  # Run this query   {code:language=sql}  select stringval from contentproperties where propertyname = 'status-lastmodifier' and stringval not in (select user_key from user_mapping) group by stringval;  {code}  # In next step after this, you will need to run update statements to replace the _username_ and _old_user_key_ values.  To obtain the corresponding _username_ values, you can use the SQL below on your *source* Confluence database.  If the source was a Cloud instance, you can ask Atlassian Support to run this query for you on your Confluence Cloud database, using the list of values from the previous step.  {code:sql}  select distinct cp.stringval, um.username, um.lower_username from contentproperties cp   join user_mapping um on cp.stringval = um.user_key  where propertyname = 'status-lastmodifier'  and stringval in (  'ff80808157d6342b0157d8d795020000',   'ff80808158be2e8d0158c14ba8ec0001',   'ff80808159726edc015983f2cb090001'  );  {code}  # Run this code to update the resolved comment's user to the correct {{user_key}}  {code:language=sql}  update contentproperties set stringval = (select user_key from user_mapping where username = '<username>') where stringval = '<old user_key>';  {code}  Where  #* {{<username>}} is the username of the User who originally resolved the in-line comment.  #* {{<old user_key>}} is the value identified from the first SQL query.  # Restart Confluence    In-line comments should now display    h3. Analysis  In-line comments are generated by a REST call  * http://confluence.mycompany.com/rest/inlinecomments/1.0/comments?containerId=<pageid>&_=1460592565065    And this returns a 500, which in the logs is  {code:title=atlassian-confluence.log|language=none}  2016-04-14 10:44:11,224 ERROR [http-nio-8090-exec-8] [common.error.jersey.ThrowableExceptionMapper] toResponse Uncaught exception thrown by REST service: null   -- url: /rest/inlinecomments/1.0/comments | userName: jrichards  java.lang.NullPointerException   at com.atlassian.confluence.plugins.inlinecomments.helper.InlineCommentUserHelper.getFullNameForUserKey(InlineCommentUserHelper.java:31)   at com.atlassian.confluence.plugins.inlinecomments.entities.InlineCommentBuilder.buildResolveData(InlineCommentBuilder.java:54)   at com.atlassian.confluence.plugins.inlinecomments.entities.InlineCommentBuilder.convertCommentToInlineComment(InlineCommentBuilder.java:111)   at com.atlassian.confluence.plugins.inlinecomments.entities.InlineCommentBuilder.build(InlineCommentBuilder.java:84)   at com.atlassian.confluence.plugins.inlinecomments.service.InlineCommentServiceImpl.getCommentThreads(InlineCommentServiceImpl.java:255)   at com.atlassian.confluence.plugins.inlinecomments.resources.InlineCommentResource.getInlineComments(InlineCommentResource.java:82)   at sun.reflect.GeneratedMethodAccessor1269.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:497)  {code}    Here's the code  {code:title=InlineCommentUserHelper.java}     public String getFullNameForUserKey(String userKey)      {          if (StringUtils.isNotEmpty(userKey))          {              return userAccessor.getUserByKey(new UserKey(userKey)).getFullName();          }            return i18nBeanFactory.getI18NBean(getUserLocale()).getText(ANONYMOUS_KEY);      }  {code}    In the Space export XML, the in-line comment is associated with the {{user_key}} but if the user is not in the new Confluence, or if they do exist but don't have that same user_key then there's no Full name.    # The above code needs to be more robust for checking nulls  # The import needs to map in-line comments to username the same way Page ownership and other items are mapped"""
"CONFSERVER-38993","Bug","Space - Export / Import",3,"XML Exports containing special characters (like an Ellipsis) in Highlighted Inline Comments Increases String Length, causing the XML Import to Fail ","""{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-38993].    {panel}    h3. Summary  Whenever a user inserts an ellipsis character (i.e. """"…"""" which is three dots represented as a single character) as content in Confluence, and an inline comment is created from highlighting that content, the resulting Site Export (or Space Export containing comments) will convert the ellipsis to three separate period characters (i.e. 3 """"."""" in a row). Thus, the resulting string in the entities.xml import will be longer in character count than the original string. If the original string was close to 255 characters, the 'converted' string will be greater than 255 characters. This causes subsequent attempts to import this data to fail with the following error:    {code} ERROR [Long running task: Importing data] [sf.hibernate.util.JDBCExceptionReporter] logExceptions Data truncation: Data too long for column 'STRINGVAL' at row 1{code}    or this one:    {code}Caused by: java.sql.BatchUpdateException: Batch entry 2 insert into CONTENTPROPERTIES (PROPERTYNAME, STRINGVAL, LONGVAL, DATEVAL, PROPERTYID) values ('inline-original-selection', 'typedef struct EthrLagGroupCbkEntryData{    EthrLagGroupLagLinkList ethrLagLinkList; /* List of LAG links */    EthrLagMemberSpeed ethrLagMemberSpeed;    EthrManualMacAddress ethrManualMacAddress;    ......    EthrLagSpared16 spareField1;    EthrLagSpared8...', NULL, NULL, XXXX) was aborted{code}    This error is dependant on the content you are making a comment from.      h3. Steps to Reproduce  # Log in to Confluence and create a new page  # Enter the following as text in the page   # highlight the content and wait for the inline comment icon to appear  # create an inline comment  # notice the string length for the highlighted text is less than 255 characters  # Perform a space export, selecting custom to include comments  # Once the zip is created, open the entities.xml and search for the inline comment  # Notice the new content is more than 255 characters   # This breaks the Space Import since the data column size for STRINGVAL is 255.      h3. Expected Results  The export does not add characters to special characters like the ellipsis.    h3. Notes  For the error to be replicated in an import, the original string for the highlighted text has to be close to 255 characters. If the string is not close, the conversion will not affect the import as it will remain under 255.    h3.Workaround  Before exporting, delete the inline comments which are highlighting text which are close to 255 characters and contain the ellipsis character. Alternatively, you can edit the entities.xml file and shorten the inline comment there to be less than 255 characters."""
"CONFSERVER-39298","Bug","User - Management",0,"The entity_picker.js  loading is slow for the first response","""The file {{entity_picker.js}} takes 20 seconds+ to load for the first response in a vanilla Confluence. The subsequent response is usually fast after it has been cached. This prevents large instances from loading the file due to a timeout.    h3. Step To Replicate   # Go to *!https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > General Configuration > Global Permissions*  # Click search for the *Grant browse permission to* field for Groups.    h3. Observed Result  The following result takes 20 second to complete even in a newly installed instance.    !sample.png|thumbnail!   This bug affect all the features that require {{entity_picker.js}}, for example adding restrictions to Team Calendars or Pages.    h3. Workaround  Turning off HTTP compression in *!https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! >  General Configuration > Connection Timeouts* may work in some instances.    !image-2016-08-16-16-39-58-530.png!     """
"CONFSERVER-39393","Bug","Macros - Gadgets",3,"Confluence performance can degrade when JIRA/Bamboo has performance problems due to gadget feed retrieval","""It was observed when Confluence is configured to retrieve a gadget feed from an external application, such as JIRA or Bamboo, if that application becomes unresponsive, Confluence can also gradually become unresponsive as well. This is due to threads attempting to read gadget feeds from the linked application, triggered by common Confluence Editor operations such as inserting a macro or loading the macro browser.    Thread dumps taken from the Confluence JVM during this time will show the majority of HTTP threads (245 out of 300 in the case observed) looking like the below:      These threads will be long-running and appear in multiple thread dumps taken over a period of time. The impact to users is that eventually Confluence will not have enough threads free in order to service users.    Other indications include in {{atlassian-confluence.log}} messages like  {code:title=atlassian-confluence.log}  2017-08-14 11:45:46,664 ERROR [http-nio-8887-exec-6] [[Standalone].[localhost].[/].[servlet-module-container-servlet]] log Servlet.service() for servlet [servlet-module-container-servlet] in context with path [] threw exception  java.lang.RuntimeException: java.util.concurrent.TimeoutException      h3. Workaround  Effort should be made to address the JIRA or Bamboo unavailability problem as that is the trigger for this bug. In the short term, the offending gadget feed may be temporarily removed from Confluence Admin > External Gadgets in order to avoid further outages."""
"CONFSERVER-39392","Bug","Editor - Page / Comment Editor",3,"When using Editor, scrollbar does not work at top of the page","""h3. Summary    When editing a page in Confluence, the portion of the scrollbar that lies within the title bar area of the page cannot be clicked and dragged.  Typically, this occurs when the page is very long and scrollbar is small.  However, in certain instances where the scrollbar straddles the title bar and the rest of the content, you can click on the lower portion of the scroll bar that lies within the main content area and drag it.    h3. Steps to Reproduce    # Create a page in Confluence and provide a title and add more than a screen full of text or content.  # Save the page.  # Edit the page.  # Click on that portion of the scrollbar that lies within the title bar area of the page.  It won't move.  # If a portion of the scrollbar lies within the content area of the page, it should be draggable.      h3. Workaround    Use the mouse wheel, touchpad or down arrow key to move the cursor down the page and move the scrollbar down.  Once the scroll bar is out of the title bar area, it should resume working."""
"CONFSERVER-39555","Bug","Macros - Panels",2,"When inserting a macro into a page, macro browser errors with ""Failed to get macro details"" because of race condition in gadgets ehcache acquiring","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-39555].  {panel}  h3. Summary    Occasionally users will attempt to insert a macro into Confluence and receive an error, {{Failed to get macro details}}    !Screen Shot 2015-09-15 at 1.50.46 pm.png|thumbnail!  h3. Environment   * Confluence 5.9.1-OD-2015.40.1-0001    h3. Steps to Reproduce   # Unknown what triggers, but may be a caching issue.   # On an affected instance, go to edit a page in Confluence, type a curly bracket, and instead of the macro browser loading, you receive the error above.    h3. Expected Results    Generally typing curly bracket will load the macro browser  h3. Actual Results    From clog when loading the macro browser:    h3. Workaround 1   # Disable the """"Gadget Plugin"""" and the """"Gadget Plugin SPI"""". This will allow the macro browser to load, minus gadgets   # Re-enable each plugin    h3. Workaround 2   # Restart Confluence    h3. Workaround 3   # If you are using Copy Page Tree, downgrading Copy Page Tree plugin from 2.5.X to version 2.4.2.   # You may follow the knowledge base below to downgrade Confluence   #* https://confluence.atlassian.com/upm/downgrading-an-add-on-to-an-earlier-version-311918719.html   # Download version 2.4.2 from the link below.  #* https://marketplace.atlassian.com/plugins/com.nurago.confluence.plugins.treecopy/versions    *Dev Notes*   * PR: [https://stash.atlassian.com/projects/CONF/repos/confluence-gadgets/pull-requests/23/overview]"""
"CONFSERVER-39744","Bug","Content - Inline Comments",3,"Using emoji on a page disables inline commenting ","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-39744].   {panel}  h3. Summary  Using Emoji on a Confluence Page prevents Inline Commenting    h3. Environment  * Confluence 1000.95 (Cloud)   * Confluence 5.8.5 (Server)    h3. Steps to Reproduce  # Create a Page in Confluence which includes a Unicode-6 Emoji Character (📷 🏈)  # Attempt to Inline Comment    h3. Expected Results  A comment is added inline to the Page    h3. Actual Results  When attempting to save the Inline Comment, an error appears indicating """"Unable to Save The Comment""""    Confluence logs show:       h3. Notes  Seems to only be affected by [Unicode-6 Emoji|http://emojipedia.org/unicode-6.0/]  Using ⚽️ (not listed in the link above) seems to work    h3.Workaround  Remove Emoji Characters from Page"""
"CONFSERVER-40008","Bug","Editor - Page / Comment Editor",3,"Icons aligned incorrectly on Spaces list macro","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40008].   {panel}  See screenshots of how it looks in 5.8 vs 5.9"""
"CONFSERVER-39893","Bug","Search - Core",3,"Font not found warning messages when indexing PDF","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-39893].  {panel}  Confluence is throwing warning messages regarding font not found when performing the index of the instance:    This warning happens to other fonts as well, not limited to only Times new roman.    I could locate this bug report for the pdf font box: [https://issues.apache.org/jira/browse/PDFBOX-2110]    Seems to be fixed in pdfbox 2.0.0 version. Confluence 5.8.10 is currently using pdfbox 1.8.10.         *Workaround*    Install the missing fonts using steps described in the following KB article:   [https://confluence.atlassian.com/confkb/the-text-in-a-powerpoint-excel-or-word-document-looks-different-when-using-the-viewfile-macro-200213562.html]    *Possible fix*   Upgrade to pdfbox 2.0.0."""
"CONFSERVER-48771","Bug","Apps - Team Calendar",3,"JIRA options can be very slow to return with a high number of Roles and/or Shared Filters","""When adding JIRA content to Team Calendars, Confluence will reach out to JIRA to obtain options that are returned by the following JIRA URL: http://<jira_base_url>/rest/ical/1.0/ical/config/query/options    This options query times out after 10 seconds by default. Administrators can extend this timeout by following [this KB|https://confluence.atlassian.com/display/CONFKB/JIRA+Calendar+Read+Timed+Out].    Through SQL logging in JIRA, we find that the following components appear to impact the query return time greatly:  * For every project, JIRA appears to fire off one SQL query for each role that exists. In other words, the cost is _number of roles_ times _number of projects_.  * JIRA fires off one SQL query for each shared filter (i.e. excluding private filters).    In one observed instance, there were:  * 1000 projects, 3 roles =  3000 SQL queries  * 15000 shared filters = 15000 SQL queries    Each query took 1-3ms including DB connection borrow and return. Adding latency and other overhead, http://<jira_base_url>/rest/ical/1.0/ical/config/query/options on this instance took 56000ms to finish, well over the 10000ms default timeout.  """
"CONFSERVER-40154","Bug","Macros - Content by Label",3,"""Content by label"" can render itself recursively, causing a stack overflow","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40154].   {panel}  h3. Summary  A page with the """"Content by label"""" macro, combined with an Excerpt Display of """"Rich content"""", will render itself leading to a stack overflow.    *This causes:*  * high CPU usage with more than 10MB of log every second.  * Confluence becomes unresponsive until the overflow finishes.  * Going to the page can also return an Error page when the page is displayed.  * The page may render with infinite traces of itself.  * In Cloud the page will automatically try to refresh every 2 minutes if window is left open and will trigger the problem again.    h3. Environment  * Confluence 6.0 or 5.9  * Content by Label macro    h3. Steps to Reproduce  # Create a new page  # Add a """"Content by label"""" macro, configured as:  #* Label: """"testing""""  #* Excerpt Display: """"rich content""""  # Save the page  # Add a label to the page: """"testing""""  # Refresh the page (May require 2 or 3 refreshes for the label to be updated)    h3. Expected Results  Page renders quickly and no error are shown in the logs.    h3. Actual Results  Log shows many errors:      On Screen it may show the error: """"Oops - an error has occurred"""" with the following error:         h3. Notes  Wasn't happening in Confluence v5.7 and v5.8.10 because the macro didn't have the 'Rich Content' excerpt.  This is the Macro setting:  !rich_content_setting.jpeg|thumbnail!         h3.Workaround  User a different 'Excerpt Display' option in the macro.    To open the page directly in edit mode:  # get the contentid from the database (Cloud customers please contact Cloud Support)    # use the 'contentid' as the page id value in: {{https://<confluence-url>/pages/editpage.action?pageId=}}"""
"CONFSERVER-40165","Bug","Search - Indexing",8,"Indexing attachments does not remember that an operation has been attempted","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40165].   {panel}  h3. Summary    If a fatal exception (ie, OutOfMemoryError) occurs during the processing of an attachment (such as a large/corrupt PDF or DOCX), Confluence will not record the failure.  When it restarts, it will re-try the indexing.  This leads to a loop of failure, and the application becomes unusable.    h3. Expected Result    Application fails catastrophically only once.  The underlying failure can be investigated and fixed, but the application does not enter a loop of catastrophic failures as it tries to index an invalid file.    h3. Actual Result    Applications enteres a loop of failures where it will become unavailable until Support (or other system administrator) removes the offending file.    h3. Workaround    Identify the file being indexed, and remove it."""
"CONFSERVER-48449","Bug","Apps - Team Calendar",3,"recurring events changes not being reflected correctly","""Steps to reproduce  *Scenario 1*  # Login to Confluence  # Install Team Calendar  # Click on """"Calendars"""" on the top navigation bar  # Click on Add Calendar on the top right and add a calendar called """"test""""  # Create a new events called """"testing recurring event"""" and set it to Repeat weekly as per the screenshot below :  !recurringEvent1.jpg|thumbnail!  after that click OK  # Select on the recurring events and click on Edit as per the screenshot below :  !editRecurringEvent.jpg|thumbnail!  # Add admin user to the """"Who"""" field as per the screenshot below :  !editRecurringEvent2.jpg|thumbnail!  then Click OK  # click on another recurring event and add test user to the """"Who"""" field as per the screenshot below :  !editRecurringEvent3.jpg|thumbnail!  !editRecurringEvent4.jpg|thumbnail!  # Now go back to the first event that have the admin user added in the """"Who"""" field as per the screenshot below and edit the text to """"testing recurring event 2"""". Please ensure that the """"Edit this instance only"""" is unticked :  !editRecurringEvent5.jpg|thumbnail!  !editRecurringEvent7.jpg|thumbnail!    *Current result* : the first event does not show """"testing recurring event 2"""". It seems that other recurring event is showing the changes but not the event that have user test added to the """"Who"""" field as you can see from the screenshot below :  !changes1.jpg|thumbnail!    *Expected result* : the first event should show the changes along with all the recurring events.    Steps to reproduce  *Scenario 2*  # Login to Confluence  # Click on """"Calendar"""" on the top navigation bar  # Add a new Calendar named test2  # Add event on test2 calendar named """"test recurring event"""" and ensure that Repeat is set to Weekly  # Click one of the events to edit and add user """"admin"""" to the """"Who"""" field. Ensuring that """"Edit this instance only"""" is ticked  # Click on the same event to edit and add user """"test"""" to the """"Who"""" field. Ensuring that """"Edit this instance only"""" is unticked.    *Current result* : the recurring event that we have edited shows that only """"admin"""" is in the """"Who"""" list while others show the changes that was made as per the screenshot below :  !recurrentEvent.jpg|thumbnail!    *Expected Result* : All recurring event should show the changes including one of the recurring event that we have made changes to.    *Scenario 3*  # Create a recurring weekly event   !Screen Shot 2020-02-18 at 17.09.42.png|thumbnail!   # Edit one specific instance of this recurring event   !Screen Shot 2020-02-18 at 17.10.14.png|thumbnail!   # Add a user on the """"Who"""" field (with """"Edit this instance only"""" enabled)   !Screen Shot 2020-02-18 at 17.10.37.png|thumbnail!   # The following day's event will switch to the same day as the edited event:   !Screen Shot 2020-02-18 at 17.11.01.png|thumbnail! """
"CONFSERVER-40272","Bug","Themes / Theming",1,"Customizing Link Color via Customizing Color Schemes does not affect Sidebar links in Spaces","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40272].   {panel}  h3. Summary  Customizing the *Link* Color via the [Customising Colour Schemes|https://confluence.atlassian.com/doc/customising-colour-schemes-135906.html] panel does not affect all links in the sidebar within Spaces.    h3. Steps to Reproduce  * *Confluence Administration* > *General Configuration* > *Colour Scheme* > *Edit*  * Change *Links* to a custom color (#E90029)  * *Save*    h3. Expected Results  All links should be turned red on all pages-- Dashboard, Spaces, Pages    h3. Actual Results  Not all links' colors are changed. If you go to any Space, the *page tree* will not be affected  !Screen Shot 2015-12-17 at 12.03.03 PM.png|thumbnail!     h3. Notes  * Tested, and does not affect versions 5.8.18, 5.8.16  * Version 6.0.0-OD-2016.02: Only affect unvisited links. Visited links worked fine.    h3. Workaround (For Server Version)  Adding the below CSS to fix the issue:  * *Confluence Administration* > *General Configuration* > *Style Sheet* > *Edit*  *   * *Save*    No workaround for Cloud version at the moment"""
"CONFSERVER-40283","Bug","Editor - Page / Comment Editor",3,"Setting posting date for a blog doesn't work","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40283].   {panel}  * """"Create blog"""" in the UI (createblogpost.action)  * Edit the """"Posting Date"""" field at the bottom of the page, changing it from today (2015-12-18) to two days ago (2015-12-16)  * Publish  * Date in all of the following shows as today, not as the posting date I entered:  ** address bar  ** breadcrumbs  ** rest/api/content/<id> :  *** version.when  *** history.createdDate  """
"CONFSERVER-46588","Bug","Apps - Confluence Questions",3,"Confluence Questions is waiting for a lock that is locked by the index","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-46588].  {panel}  CQ appears to be waiting for a lock that is locked by the index, which is currently trying to process a large amount of updates.    The thread 'http-nio-8081-exec-3 is a doeditquestion.action:  ||Thread ID||Thread name||User ID||Type||Summary||Duration||  |252|http-nio-8081-exec-3|amckague|web-request|/cq/doeditquestion.action?id=2669904138|1 hour, 16 minutes, 20 seconds|    The only threads that are getting stuck are CQ threads (see screenshot). Why would we be blocking on a Lucene lock in CQ?    !cq stuck requests.png|height=450!  h3. Impact of this bug    This bug can cause threads to become stuck, which means indexing does not occur, and questions/answers cannot be posted to Confluence Questions (they simply hang). A restart of the instance (or a rolling restart of the full cluster) is required to resolve it.    It can also cause indexing to be delayed after a restart, by up to 20m, depending on the size of your instance."""
"CONFSERVER-40451","Bug","Integrations - JIRA|Macros - JIRA Macros",3,"Confluence 'Create JIRA Report - Change log' doesn't load","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40451].  {panel}  h3. Summary    The JIRA 'Change log' Report creator in Confluence no longer works.    When attempting to create a report the screen the 'loading' icon is displayed indefinitely and the report never loads.    This worked in 5.9.4, and broke in 6.0.0  h3. Environment   * Confluence Version 6.0.0-OD-2016.02.1-0006    h3. Steps to Reproduce   # In confluence click on the '...' next to the 'Create' button in the top menu bar   # Select 'JIRA Report' and click 'next'   # Select 'Change Log' and click 'next'   # Select a Project from the drop down menu, leave other fields as default and click 'create'    h3. Expected Results   # The report is created and the page is loaded    h3. Actual Results   * The loading icon will be displayed indefinitely and nothing will happen, the report is not created   * The below exception is thrown in the logs       * Error showing in the Chrome browser Console:      h3. Workaround    """"switch to advanced"""" prior to hitting """"create"""" works for some users  h4. Resolution    Upgrade to Confluence 6.6.10+, or Confluence 6.8+    Note that this issue is not fixed in Confluence 6.7.x"""
"CONFSERVER-40499","Bug","Macros - Page Properties",2,"Page properties report broken when using nested macros. ","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40499].   {panel}  h3. Summary    When nesting a macro within a Page Properties the Page Properties report macro will not populate the macro content.      h3. Steps to Reproduce  h3. Steps to Reproduce  # Start with a JIRA + Confluence Cloud instance.  # In Confluence, create a page with a Page Properties Report macro on it.  # Create another page with the Page Properties macro in it that'll show in the Page Properties Report macro above.  # Insert a table into the Page Properties macro that contains a JIRA Issues Macro that will return some number of issues from JIRA.  # View the original page with the Page Properties Report on it.    h3. Expected Results    The page properties for the space will populate in the page properties report.     h3. Actual Results    In two cases I tested it in using the Contributor Macro and Jira issues filter  JIRA issues it will just hang on """"Getting issues"""". On the contributors macro it doesn't render and returns an odd result: {""""contextEntityId"""":12222521} although in preview """"mode"""" it works expected.       """
"CONFSERVER-48563","Bug","Apps - Team Calendar",1,"The system is not logging me in after using my password","""Am using a stand alone computer"""
"CONFSERVER-40833","Bug","Search - Indexing",5,"Deleted Pages, Blogpost and Attachments Returning in Confluence Search Results ","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40833].   {panel}  h3. Summary  Attachments which have been deleted from a Confluence Page are still searchable after a Content Index is performed    h3. Environment  * Confluence Cloud version 6.0.0-OD-2016.07.2   * Confluence server version 5.9.x and above    h3. Steps to Reproduce  # Add an attachment to a Confluence Page (does not need to be embedded on the page itself)  # Search for the Attachment using the Filename of the Attachment; it should display in the Search Results  # Delete the Attachment  # Search again for the Attachment; should not display in the Search Results  # Perform a task which triggers a Content Index (Move Pages, Create Space, etc) or as SysAdmin, manually trigger a Content Re-Index    h3. Expected Results  Deleted attachment does not return in search results    h3. Actual Results  * Deleted Attachment is shown in search results however when clicked displays a file not found error:  !AttachmentError.png|thumbnail!  * In some versions, deleted Attachments are able to be viewed like normal attachment  * The attachment also reappeared in the Space Attachment list by going to Space Tools > Content Tools > Attachments    Database shows that the Attachment has been deleted:         h3. Notes  # Rebuilding Cache does not seem to correct the issue  # Reindexing from scratch does not seem to correct the issue either    h3.Workaround  # Delete the attachment from the trash by going to Space Tool > Content Tools > Trash > choose the deleted attachments > Delete  # Purge the trash by going to Space Tool > Content Tools > Trash > purge"""
"CONFSERVER-40860","Bug","Macros - Other Macros",5,"Page Index macro in large space is bringing down Confluence","""{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40860].    {panel}    {panel:title=Resolution|borderStyle=solid|borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}  The Page Index macro can be quite memory hungry in large spaces.  To prevent it causing out of memory errors in your site, we don't show page excerpts when there are more than 200 pages in the space, and don't list any pages if there are more than 5000 in the space.  This 5000 page limit can be reduced further by setting the system property page.index.macro.max.pages to a lower value.  For example to lower the limit to 500 set the system property to:    -Dpage.index.macro.max.pages=500    More info on how to set system properties for Confluence can be found [here|https://confluence.atlassian.com/doc/configuring-system-properties-168002854.html].  {panel}    h3. Summary    Page Index macro in large space is bringing down Confluence  h3. Environment   * 6.0.0-OD-2016.08.1-0001, server 5.8.18  h3. Steps to Reproduce     # Create a page in a large space (with > 2800 pages)   # Insert _page index macro_   # It would take long to be generated.    h3. Expected Results    Confluence generates the index on the page the macro is inserted with no issues.    h3. Actual Results    Confluence keeps going down with this error:    and      h3. Notes  Error still happens even after the _pool size_ has been increased.    h4. Workaround 1 (for Confluence Server)    This is the Confluence Index Macro, which can be enabled/disabled via:   # !https://confluence.atlassian.com/download/attachments/590259974/Cog.png! > *Add-ons*   # Choose *System* from the drop-down   # Expand *Advanced Macros*   # Expand the *modules* on the right side   # Locate the *index* macro and *Disable* it   !disable_index_module.png|thumbnail!   # Restart Confluence to release the existing threads    h4. Workaround 2    # Search for: {{macroName:index}} and you will see all pages containing this macro.   ** Note that your content indexing may need to be rebuilt for this search to work.   # Delete the macro from the pages in the search results   # Restart Confluence to release the existing threads    If you prefer to search via the database for a list of pages, you can use this query:    (!) This workaround is for *Confluence Server*. For Confluence Cloud, please contact Support to get a list of pages using this Macro. You could then remove the macro from those pages."""
"CONFSERVER-40914","Bug","Search - Indexing",5,"Check size of attachment before content indexing","""When indexing larger attachments, it would benefit our clients greatly if we checked the size of attachment before indexing same. In other words, when an attachment is too large, instead of attempting the indexing, bail earlier if the attachment is too large.    System property atlassian.indexing.contentbody.maxsize is meant to provide this functionality, however has been reported not to be working.  h3. Workaround    As of 5.9 there is 'canary' functionality in the Office Connector that will abort indexing on large documents if they would cause an OutOfMemory error. More details can be found [here|https://confluence.atlassian.com/confkb/jvm-crashes-during-import-from-word-in-confluence-815577714.html].    NB: The canary is now enabled by default and does not require a dark feature."""
"CONFSERVER-40912","Bug","Server - Performance",3,"cwd_user table missing a index","""h3. Summary    Everywhere in Confluence DB tables, the creator is now set as the user hash. This username hash is stored in the table user_mapping which is made of three columns (user_key, username, lower_username). The last column has a unique index.    Now in cwd_user, there is no index on column lower_user_name. The only index there is on lower_user_name is composed with the other column directory_id.    So this means that for every action where Confluence looks up for creator information, it makes a full table scan on cwd_user. (Unless the caching in Confluence helps to avoid this ? )    h3. Environment    * Confluence 5.9.4  * PostgreSQL 9.3.10    h3. Steps to Reproduce    There are many actions in Confluence which could cause this to occur. One such query which has been found is the below one:        An explain plan on that shows a table scan is run on the lower_user_name field in cwd_user, if there is enough data in the tables being queried (in a fresh install there is no table scan, probably due to optimization from analyze statistics).    h3. Expected Results    Database query returns quickly without performance impact, by using an index lookup.    h3. Actual Results    Database query returns slowly, and causes a performance hit, as it's using a record lookup (table scan).    h3.Workaround    Manually add an index on lower_user_name in the cwd_user table, for example:        NOTE: If any future fix adds a new index, you may need to manually remove this index before that."""
"CONFSERVER-41264","Bug","Data Center - Core|Integrations - JIRA",5,"JIRA Issue Macro sends much higher hazelcast traffic between the Data Center nodes","""h3. Summary  The Hazelcast 5801 port traffic between the nodes is much larger (about 50~200 times) in Confluence Data Center 5.9.x when browsing a page containing JIRA Issue Macro, comparing to Confluence 5.7.5. The more access the cluster gets, the more traffic is generated between the nodes.    h3. Steps to Reproduce  # Install Confluence Data Center 5.9.5 cluster including 2 nodes  # Install JIRA Software 7.0.5  # Generate an Application Link between the JIRA and the CDC  # Create a page with JIRA Issue Macro in Confluence  # Access to the page by using jMeter or so forth (I used jMeter with 10 parallel threads and infinite loop count)  # Measure the traffic between the nodes by dstat command (specifically """"dstat -n -N <interface>"""" command)  # You'll find the traffic is much larger (In my case, the traffic was about 50Mbps):  -- much larger than the case when accessing a page without JIRA Issue Macro (In my case, the traffic was about 250Kbps)  -- much larger than the case when accessing the same page in Confluence Data Center 5.7.5, which is the version that the customer is currently using (In my case, the traffic was about 250Kbps)  # As a result, CPU usage is also increased, though the CPU % does not grow disastrously severe    (i) I confirmed the traffic was hazelcast 5801 port, by creating a separate network interface only for the hazelcast traffic. Another network interface is used for all other traffics such as HTTP, PostgreSQL, NFS.    h3. Expected Results  The traffic is as high as it used to be in Confluence Data Center 5.7.5    h3. Actual Results  The traffic is about 40~200 times higher than it used to be in Confluence Data Center 5.7.5    h3.Workaround  There is no workaround found at the moment."""
"CONFSERVER-41390","Bug","Macros - Gallery",2,"Misspelling/typo in the Gallery Macro description text","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-41390].   {panel}  There is a misspelling in the *Confluence Gallery Macro* description text:    Create a thumbnail gallery from a *pages *attachments Documentation    That should be """"page's"""" with an apostrophe for a possessive noun.    """
"CONFSERVER-41579","Bug","Macros - JIRA Macros",5,"Missing or corrupted icons of JIRA issues in PDF export","""A Confluence page uses the JIRA Issue/Filter macro, either for displaying a single issue or a list of issues.    When exporting this page to PDF, there are several icons missing or they are corrupted:  * ID of imported issue  * Status of imported issue  * Type of issue  * Priority of issue  """
"CONFSERVER-41610","Bug","Editor - Drafts",5,"TDM merger fails due to infinite recursive loop","""{panel:bgColor=#e7f4fa}  *NOTE:* After a thorough investigation and analysis of the issue by Development and Support teams, we found that this TDM Merge issue did not have as high of an impact to memory as previously assessed. Our attempts at reproducing an OutOfMemoryError (OOME) or stability problem have been unsuccessful. Both the support and development teams have done a thorough investigation around the linked support cases; and the conclusion is that TDM code is not to blame. The stack trace in the logs is merely just a warning which indicates that the infinite loop has been detected and hence terminated.    We are closing this issue as Cannot Reproduce. If you are still experiencing the symptoms that relate to this bug please contact support by following the links at [https://support.atlassian.com/confluence/] so we can help identify the root cause of your issue.    This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-41610].  {panel}  Regression of CONFSERVER-32164  h4. Problem summary    When Collaborative editing is disabled, or in a version of Confluence below 6.0, under specific conditions, Confluence can run out of memory when a user goes to edit a Confluence page or view his drafts (Username > Drafts), following a sequence of events:   # User A goes edit a page (Version 1)   # Confluence auto-saves a draft based on Version 1, and user does not save the page   # User B edits the same page and saves, promoting the page to Version 2   # User A views his drafts (or edits the page again)   # Confluence tries to merge the three versions (Version 1, Version 1 draft, and Version 2), and results in Confluence hanging    Stack trace:    Details:   * https://jira.atlassian.com/browse/CONF-32164?focusedCommentId=854595&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-854595   * https://jira.atlassian.com/browse/CONF-32164?focusedCommentId=904073&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-904073    h4. Workaround    *6.0 and later*    Make sure that Collaborative Editing is enabled and working, as the affected merge code is not used unless it is disabled.    *Warning:*  The below workarounds involve deleting one or more drafts. Drafts contain edits that have not yet been saved, so important work can be lost by deleting them.    *5.5 and later*  If a user has been identified causing this problem, they can go to {{/users/viewmydrafts.action}} page and discard either all of their drafts or just the draft for the page that is known to trigger this problem.    *All versions*  Alternatively, all the drafts can be deleted directly from the DB:   # Back up Confluence DB as a precaution   # Run the following DELETE statements against the DB:       # Confluence Admin > Cache Statistics > Flush all (down at the bottom)"""
"CONFSERVER-41664","Bug","Site - Backup / Import",3,"CONFVERSION table empty after full site import","""h3. Summary  {{CONFVERSION}} table is empty after full site import    h3. Environment  Bug reproduced on 5.5.6, 5.8.18, 5.9.4 and 5.9.7    h3. Steps to Reproduce  # Install a fresh instance of Confluence  # Configure it with an external database  # Once Confluence is up and running, run the following query on the database    # You should see the entry for the build number  # Import a full site XML Backup  # Once done, query the {{CONFVERSION}} table again    \\  h3. Expected Results  We should see the same build number entry    \\  h3. Actual Results  {{CONFVERSION}} table is empty now     \\  h3.Workaround  There is no workaround for the time being"""
"CONFSERVER-48832","Bug","Apps - Team Calendar",3,"Users receive emailed notifications for calendars they don't watch","""{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48832].    {panel}    One of our calendars, which isn't embedded in any page, has been sending email notifications to users who are not watching the calendar. Not all users are affected. There appears to be no way to unsubscribe them from receiving these notifications.    * The users' lists of watched items doesn't contain this calendar  * When the users access the Calendars page and select this calendar's drop down menu from the elipsis, they find that they are not watching this calendar (status reads """"Watch"""" and not """"Stop Watching"""" or """"Watched"""")    I used this query to see if the calendar is embedded anywhere returned no results:    embeddedSubCalendarId:CALENDARID    This seems to be a known issue, as reported here: https://jira.atlassian.com/browse/TEAMCAL-3709    Is there any fix for this?     *Workaround:*    (!) If you navigate to the calendar by following the link provided in the email notification, it has """"Watch"""" instead of """"Stop Watching"""" as the option. You can see the """"Stop watching"""" option by following the specific instructions below to navigate to the calendar.    # Click """"Calendars"""" in the top Confluence navigation bar.  # Locate the target calendar and click the ellipses button (!https://confluence.atlassian.com/doc/files/704577869/704577870/1/1422393340385/ellipsis.png!)  # Click *Stop Watching*."""
"CONFSERVER-43054","Bug","Server - Installer / Setup",2,"Oracle 11c driver is listed in the setup wizard but Oracle 11 is no longer supported ","""Oracle 11.1 and 11.2 support was dropped in Confluence 5.9.      The setup wizard still provides an option to choose Oracle 11g.  We should remove this to avoid confusion. """
"CONFSERVER-51861","Bug","Integrations - Office Connector",5,"NoAuthenticationException in Office Connector plugin (with IE)","""IE NoAuthenticationException in the office connector.    For IE, the path authentication filter is not being applied, so documents don't open.    We need the filter so that the ocauth is added to the path.    Related to comment: https://jira.atlassian.com/browse/CONF-38024?focusedCommentId=902895&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-902895"""
"CONFSERVER-43173","Suggestion","Integrations - JIRA",2,"Increase Character Limit of the Description from JIRA Issues Macro creation","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-43173].   {panel}  In Confluence, when we create JIRA issues macro using the highlight option, it will limit the description field when having it created in the JIRA side if we use the option to create multiple issues from a table.    For example, with the following screenshots, we can see how it behaves:    When highlighting the same content as we can see in the below table:    !Screen Shot 2016-07-11 at 5.14.29 PM.png|thumbnail!    It will give us the following result, when selecting the *Create Multiple Issues from Table*:    !Screen Shot 2016-07-11 at 5.58.55 PM.png|thumbnail!    This is a suggestion to either increase the character limit for the description or allow the user to configure it, instead of using ellipsis for the rest of the description."""
"CONFSERVER-43207","Bug","Macros - JIRA Macros",3,"JIRA Macro couldn't render issues when the filter contains multi-byte characters","""h3. Summary    JIRA Macro couldn't render issues when the filter contains multi-byte characters.    h3. Environment    * Confluence 5.10.1  * JIRA 7.1.9    h3. Steps to Reproduce  # Install vanilla JIRA 7.1.9  # Create a project  # Create two issues as follows  ## Create an issue with Japanese summary (The summary is """"テスト"""".)  ## Create another issue with English summary (The summary is """"test"""".)  !issues.png|thumbnail!   # Install vanilla Confluence 5.10.1 and integrate it with the JIRA  # Create a space and a page  # Use JIRA Macro with the following two types of filters  ## {{summary ~ """"テスト""""}}  ## {{summary ~ """"test""""}}  # Check if the macro works fine in the preview dialog   !preview.png|thumbnail!     h3. Expected Results    Even if we use Japanese characters in the filter, the issue should be rendered in the page as it works fine with the other filter which contains only English characters.   !english_filter.png|thumbnail!     h3. Actual Results    When we use Japanese characters in the filter, the issue wasn't rendered in the page correctly.  !japanese_filter.png|thumbnail!     h3. Notes    * We can use the filter (JQL) in JIRA to find the issue  * The filter which contains Japanese characters also works fine in the macro preview dialog as I mentioned in the above image  * You can reproduce this bug not only with Japanese characters but also Russian, Korean, Chinese characters (any muti-byte characters)  * This bug *WASN'T seen on Confluence 5.9.12 with JIRA 7.1.9    h3.Workaround    # Stop Confluence  # Add the following line into the bin/setenv.sh file    # Start Confluence"""
"CONFSERVER-43385","Bug","Translations",3,"Date Picker no longer set to Monday On European Languages ","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-43385].   {panel}  h5. Summary:  In Confluence 5.8, when using the German Language pack, the date picker:  * Has Monday as the first day of the week  * Days are displayed in German    !screenshot-2.png|thumbnail!     However, In Confluence 5.9 and above, when using the German Language pack, the date picker:  * Has Sunday as the first day of the week  * Days are displayed in English   !screenshot-1.png|thumbnail!     h5. Notes:  Checked in {{confluence-language-pack-de_DE-5.10.0.rc1-v2r12978-2016-06-06.jar/i18n/aui_de_DE.properties}} noticed the line  {{ajs.datepicker.localisations.first-day}} was set to {{1}},     which supposed to set the day picker to start on Monday. However, the date picker still shows Sunday as the first day of the week    Most of European countries start the week with Monday, see https://en.wikipedia.org/wiki/Week.  h5. Workaround:  No workaround yet  """
"CONFSERVER-43947","Bug","Server - EAP",2,"6.0.0m70 upgrade via windows installer failed","""This morning I attempted to upgrade Confluence on Windows from 6.0.0-m68 to 6.0.0-m70    I've been upgrading this Confluence with all the milestones using the windows installer.    This time I got an error that was something like 'file still in use', the installer didn't complete, and I was left with most of my install directory empty.    I've attached my application log. All that is left in my installation directory is Logs directory (Catalina logs etc are gone though), and the confluence\WEB-INF\lib and the JRE directory.    We should confirm this isn't a freaky one off.    See also https://jira.atlassian.com/browse/CONF-43948"""
"CONFSERVER-43776","Bug","Mobile",5,"Confluence mobile version serves up login screen even when the anonymous access is enabled","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-43776].  {panel}  h3. Summary    When accessing Confluence from a mobile device on iOS 10 and Safari, the application serves up a login screen that is invalid. This is true for all pages, even with anonymous access enabled.  h3. Steps to Reproduce   # Install Confluence 5.10.4 (this can also be replicated in previous versions of Confluence such as 5.9.10)   # Enable anonymous access   # Make sure the system add-on called the 'Confluence Mobile Plugin' is enabled   # Access the Confluence instance using iOS 10 and the vanilla Safari browser that comes included   # Notice you will get an invalid login prompt asking you to login to Confluence    h3. Expected Results    Confluence mobile should open up Confluence without asking you to log in.  h3. Actual Results    A prompt comes up in Confluence asking all users to log in every few seconds.    !Login Prompt.png|thumbnail!  h3. Notes    This prompt only happens in Safari that comes bundled with iOS 10.   Switching to Desktop version does *not* correct the situation in Cloud, and is not a workaround. Nor is disabling Confluence Mobile.   Tested in iOS 9 and it is not a problem there.  h3. Workaround   - Install the [Confluence Server|https://itunes.apple.com/au/app/confluence-server/id1288365159?mt=8] iOS app and use that instead - requires Confluence 6.8 or later   - Or install Google Chrome or Firefox instead on the device and use that.   - Or disable Confluence Mobile by disabling the system add-on called the 'Confluence Mobile Plugin' . Please note CONF-40782 - """"Disabling the Confluence Mobile Plugin also disables the Workbox - Host Plugin in Confluence 5.9.X"""" when performing this workaround."""
"CONFSERVER-43952","Bug","Editor - Collaborative editing",3,"""Not Permitted"" error on page refresh using Collab Editing","""I have a space called """"Lars"""", with a page called """"Collab""""    I log in to confluence, and edit the page:  http://documentation.example.com/pages/resumedraft.action?draftId=6652144&draftShareId=cf4a941e-b40c-4149-a30f-5d1e6c10b67c    If i hit F5 (refresh) i get """"Not Permitted"""" and the url changes  http://documentation.example.com/pages/editpage.action?useDraft=true&spaceKey=LARS&draftId=6652144&pageId=6652143    Pressing back, lets me choose edit the page one again. It will let me save. My user is also member of confluence-administrators"""
"CONFSERVER-43949","Bug","Content - Inline Comments",3,"Cannot save inline comment with MS Edge","""{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-43949].    {panel}    h3. Summary  Cannot save inline comment when the page has code block macro or in a table.    h3. Environment  * Windows 10 Professional version 1607  * Edge 38.14393.0.0 or later  * Confluence 5.10.0 or later     h3. Steps to Reproduce  Case 1:  # Create a page and add some text then save   # Try to add an inline comment then save it. It works (/)  # Edit the page and add a code block macro in the middle of the page then save it  # Try to add an inline comment before the code clock and after (also the table)    Case 2:  # Create a page and add some text then save   # Try to add an inline comment then save it. It works (/)  # Edit the page and add a table in the middle of the page then save it  # Try to add an inline comment before the table, in the table  and after it    h3. Expected Results    The inline comment should be able to save wherever the text is selected    h3. Actual Results    Can't save inline comment after the code block, in the table or after the code block or table. Error in the screen """"Could not save the comment""""      Error appearers in the log  {code:borderStyle=solid}  2016-09-16 13:04:00,174 WARN [http-nio-8090-exec-25] [plugins.inlinecomments.service.InlineCommentServiceImpl] attemptInlineCommentCreateForPage The text selection is wrong  – referer:  | url: /rest/inlinecomments/1.0/comments | traceId: 3d669b131184c2e7 | userName: admin  com.atlassian.confluence.plugins.highlight.SelectionModificationException: The text selection is wrong  at com.atlassian.confluence.plugins.highlight.service.SelectionValidator.validateSelection(SelectionValidator.java:65)  at com.atlassian.confluence.plugins.highlight.service.SelectionValidator.validate(SelectionValidator.java:29)  at com.atlassian.confluence.plugins.highlight.service.DefaultSelectionModifier.modify(DefaultSelectionModifier.java:46)  at com.atlassian.confluence.plugins.highlight.DefaultSelectionStorageFormatModifier.markSelection(DefaultSelectionStorageFormatModifier.java:57)  at sun.reflect.GeneratedMethodAccessor2691.invoke(Unknown Source)  {code}"""
"CONFSERVER-44194","Bug","Editor - Collaborative editing",5,"Random blank lines inserted around panels","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-44194].   {panel}  This page shows two places where extra white space has been added, making it hard to layout a page the way you want:  # Blank space above the """"info"""" and """"panel"""" macros in the side-columns.  # Blank space above and below the """"excerpt"""" macro in the info box (despite having """"inline"""" mode selected)."""
"CONFSERVER-44094","Bug","Editor - Collaborative editing",3,"""Update published page"" dialog overlaps the Update button on Windows browsers","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-44094].   {panel}  h3. Summary  When Collaborative Editing is on and you're editing a page the """"_Update published page_"""" dialog overlaps the Update button itself making it hard to click the Update button to save the changes.    h3. Environment  Confluence Cloud  This could only be reproducible on all browsers running on Windows 7 (IE11, Chrome and Firefox)    h3. Steps to Reproduce  # Have Collaborative Editing enabled  # Access a page and click the Edit button  # Hover the mouse over the Update button    h3. Expected Results  The dialog is completely above the button    h3. Actual Results  The dialog overlaps the Update button       h3.Workaround  No workaround on Windows"""
"CONFSERVER-51879","Bug","Server - Platform",1,"Fix Skate Dependency Order","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-51879].   {panel}  Make sure Skate depends on Almond explicitly."""
"CONFSERVER-45096","Bug","Editor - Collaborative editing",8,"Trying to delete the whitespace at the start of a nested macro can duplicate and break the macro","""With an info box and a nested excerpt (Not sure if this issue is isolated to these two particular macros but they're the ones I encountered it with), if you navigate to outside the excerpt macro, and hit backspace to attempt to delete the empty paragraph tag (which will get reinserted by editor_plugin_src.js#addSurroundingCursorTargetParagraph), the macro gets duplicated and the content is messed up    It's a little hard to reproduce reliably, so I've attached a video and the source of the page after it's been messed up"""
"CONFSERVER-48498","Bug","Apps - Team Calendar",5,"Changes to JIRA issues never synchronize to Team Calendars without manually refreshing the calendar","""h3. Summary    Team Calendars are configured to display JIRA data. Making a change to a JIRA issue in JIRA is never reflected in Team Calendars unless the calendar is manually refreshed or Confluence's cache is cleared. Changes also do not get pushed through to  external subscription feeds.     h3. Steps to Reproduce  # Create a calendar in Confluence.   # Add a new JIRA event using the 'Event Type' - JIRA Issue Date.  # Select Project and an applicable Project in the Display drop-down list.   # Select all check boxes under Single Date:  # In JIRA, make a change to the Due Date on one of the existing issues.   # Wait    h3. Expected Results  The calendar will update within 1 hour.    h3. Actual Results  The calendar never updates.     h3.Workaround (only available for Confluence server)  # Go to !https://s3.amazonaws.com/uploads.hipchat.com/10804/2041359/oZYNLidcDNI3S8o/Dashboard%20-%20Confluence%202015-05-13%2013-43-47.png!  > General Configuration > Cache Management.  # Choose *Show Advanced View*.  # For all Team Calendar caches, click the *Adjust Size* link and change the 'Maximum elements' to *1*.  # Click Submit.    The following caches are available:  * Team Calendars - iCal subscription sub-calendar data  * Team Calendars - JIRA Agile Sprints sub-calendar events   * Team Calendars - JIRA connection drag drop support   * Team Calendars - JIRA Project Release sub-calendar events   * Team Calendars - JIRA sub-calendar data (old)   * Team Calendars - JIRA sub-calendar events   * Team Calendars - JIRA sub-calendars   * Team Calendars - User preferences"""
"CONFSERVER-51880","Bug","Editor - Synchrony|Site - Backup / Import",3,"Database Lock timeout after site import","""Looks like it's possible to hit a database lock timeout due to stopping and then starting Synchrony during an import, according to our tests. This situation is highly unlikely and almost certainly involves also installing or uninstalling or enabling/disabling other plugins while doing an import."""
"CONFSERVER-45080","Bug","Content - Page",3,"Cannot copy an old version of a page","""h3.Steps       # View any page   #  Open the Page History   # View any version    # Click Copy button to copy it     *What happened...*   The Copy Page dialog is showed, but we can't do anything else (no space can't be searched, the Copy button is disabled)   *What should have happened...*  The destination Space should be searchable and the dialog should allow me to copy it."""
"CONFSERVER-44930","Bug","Editor - Collaborative editing",3,"BR elements between inline macros","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-44930].   {panel}  Steps to reproduce:    * create empty page  * insert excerpt macro using { notation then write something inside then hit the down arrow  * insert second excerpt macro using { notation then write something inside then hit the down arrow  * insert third excerpt macro using { notation and write something inside  * check that all three macros have the """"inline"""" display option selected (by clicking on the macro placeholder to show the property panel)  * update the page to go back into the page view mode  * result shared-drafts turned on: spans are on three different lines  * result shared-drafts turned off: spans are on the same line"""
"CONFSERVER-45098","Bug","Editor - Collaborative editing",8,"Clicking layout dashed lines selects all the page text","""h3.Steps      # Edit a page that has layouts   # Click on the one of the double dashed lines that separates the layout sections   # it selects all the text then the usual single clicking inside of the same text area doesn't unselect it  # Noting that this is especially strange because it'll select text across several different sections - which is otherwise impossible in Confluence these days  # If you keep clicking randomly, maybe after 4 or more clicks it'll unselect the text     *What happened...*   Full text on page selected, and not easily unselected     *What should have happened...*  The full text on the page doesn't get selected and I can go about my merry way editing the page"""
"CONFSERVER-45084","Bug","Editor - Collaborative editing",2,"The files preview shows up underneath the show changes dialog when a picture is clicked on","""h3.Steps      # make an attachment picture to a page, and add it to the page   # ensure collab edit is on, and have someone make changes to the page   # update the page, show up the changes dialog, and see the changes   # click on the image     *What happened...*   The image shows up as a files preview, but the preview is underneath the dialog.     *What should have happened...*  The preview should be above the dialog. Or not be able to preview in the show diffs view."""
"CONFSERVER-45659","Bug","Editor - Page / Comment Editor",1,"Extra paragraph added when a paragraph is selected and a symbol inserted in collab editor","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-45659].   {panel}  Steps to reproduce:    * Create a page with two paragraphs. Publish.  * Edit the page. Select the first paragraph.  * Click on insert > symbol  * Insert a symbol  * Notice another blank paragraph got added after the paragraph you selected.    """
"CONFSERVER-44977","Bug","Macros - JIRA Macros",2,"Creating JIRA issues from Confluence is not updating the project list based on the selected JIRA instance selection","""Environment:    *JIRA 7.1.4*   *JIRA 7.1.6*   *Confluence 5.10.8*    (i) Cannot replicate this with Confluence 5.8.18 or Confluence 5.9.9. Can replicate it with Confluence 5.10.0 and Confluence 5.10.7 as well.    Steps to Reproduce:   Create Application Links between Confluence 5.10.8 to both JIRA instances    JIRA 7.1.4 has the following projects:   !jira714_projects.png|thumbnail!    JIRA 7.1.6 has the following projects:   !jira716_projects.png|thumbnail!    Highlight some text on a Confluence page and select """"Create JIRA issue"""":   !create_jira_issue.png|thumbnail!    The JIRA set a primary will be displayed with it's projects:   !jira716_selected.png|thumbnail!    However, if you change for the other JIRA instance linked to your Confluence, the project list won't be updated:   !jira714_selected.png|thumbnail!    If you end up clicking on """"Create"""" and the project doesn't exist on your JIRA instance, the issue creation screen will keep spinning until times out. Logs won't show any stacktrace.  h2. Resolution    The recommended resolution is to upgrade to Confluence 6.2.3 and above when it is released.    If upgrading is not possible and you are running Confluence 6.0.2 or above, an alternative is to upgrade the JIRA content plugin to 2.0.5 or newer which can be downloaded here: [^confluence-jira-content-2.0.5.jar] Note that this version of the plugin is only known to work with Confluence 6.0.2 and above."""
"CONFSERVER-45081","Bug","Editor - Collaborative editing",3,"Blank page on edit after collaborative editing switched off and on again","""h3.Steps      # Find a page to edit   # Switch collab editing off   # Switch collab editing on   # Edit the page you chose in the first step     *What happened...*     9 times out of 10 I am getting a blank page instead of the page contents when I click edit.       *What should have happened...*    Editor should have loaded with the content.    *Workaround*  Refreshing the page loads the editor fine and this only seems to happen to the page the first time after collab editing has been switched back on.  """
"CONFSERVER-48891","Bug","Apps - Team Calendar",2,"Add event button not responding when embedding a Team Calendar to a page in Chrome","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? See the corresponding bug reports   * https://jira.atlassian.com/browse/CONFCLOUD-48891   * https://jira.atlassian.com/browse/CONFCLOUD-56825{panel}  h3. Summary    When embedding a team calendar to a page, the *Add event* button is unusable in Google Chrome.  h3. Enviroment   * Confluence 6.1.3 (64bit linux)   * Google Chrome 61.0.3163.79 or 61.0.3163.100   * Internet Explorer 11    h3. Steps to Reproduce   # Add a date picker (by typing //datetime) to a page   # Embed a calendar to the page with the *Team Calendar* macro and save the page   # Click on the *Add event* button to add some events.    h3. Expected Results    A pop-up is displayed allowing you to add events to your calendar.  h3. Actual Results    Nothing happens after clicking on the *Add event* button.   The following JS error is seen in the browser's console.    h3. Workaround    Add events from the calendar itself on the *Calendars* page as it is still working there."""
"CONFSERVER-45189","Bug","Platform - Application Links",8,"External gadgets in Confluence should not prompt users to Login and Approve","""Problem:    When using an external gadget (e.g., JIRA gadget """"Pie Chart"""") in a Confluence page, every user who views the page is prompted to """"Login and approve"""" the gadget in JIRA before they can see the content.    This happens *for every user for every gadget,* meaning that if I create a Confluence page using Pie Chart, Filter Results, Average Age Chart, and Two-Dimensional Issue Statistics and send it to executives for review, every executive has to """"Login and Approve"""" every gadget. Worse, sometimes the """"approval"""" token doesn't stick, and a user has to go through the process again.    We have tried single sign-on, creating a trusted application link, setting up 2-way oauth with impersonation, and combinations of all of the above, to no avail.    Atlassian support has confirmed there is currently no way to bypass or automate the approval.    This is unacceptable for our 10,000 user base and makes our Confluence look unprofessional.    *Please allow 2-way oauth with impersonation to automatically approve external gadgets.*    Note: We never experienced this problem on Confluence 5.6. We cannot roll-back our upgrade, but we are severely regretting it.    h3. Steps to Reproduce:  # Integrate JIRA with Confluence through Application link.  # On the create application link wizard, check the same user base option and make sure the user used for the integration is exist on Confluence.  # After it, an applicaiton link with Oauth(Impersonation) will be created.  # On JIRA Dashboard, add a new gadget to find JIRA Gadget XML e.g. Filter Result Gadget.  # Copy the XML link and navigate to Confluence _General Configuration > External Gadgets_.  # Add the gadget by using the XML link.  # Create a new Confluence page and add a gadget by using """"Other Macros""""  # Choose the newly added JIRA """"Filter Results"""" gadget.    h3. Expected Result:  - Just like JIRA Issue Macro, the filter will be researchable or issues for JIRA Issue Macro.    h3. Actual Result:  - """"Login & Approve"""" will come out and user need to authenticate to retrive filters in JIRA.    h3. Note:  Referring to the documentation [Oauth Security for Applinks|https://confluence.atlassian.com/display/APPLINKS/OAuth+security+for+application+links] that using impersonation would not be needed for the user to authenticate as long the user is not redirected to the linked information:  bq. they're automatically authenticated on the other application and don't get asked to authorize requests.  """
"CONFSERVER-45182","Bug","Editor - Collaborative editing",8,"Vertical spacing removed on preview or publish after certain user operations","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-45182].   {panel}  h3. Summary  Using some operations are causing vertical spacing between the macros to be stripped out as {{auto-cursor-target}} class is applied.    h3. Steps to Reproduce  Steps to reproduce:  # Start creating a newpage  # Insert a block macro (e.g. the info macro)  # Insert another macro below the first (e.g. another info macro)  # In the space between the two macros, add a line break (in the editor DOM there are now two paragraphs between the macros - one with the {{auto-cursor-target}} class and one without)  # Click on preview and observe that there is vertical spacing between the macros  # Perform one of the """"user operations"""" listed below - do this below the two macros to make the effect clearer to observe (in the editor DOM, both paragraphs between the macros now have the {{auto-cursor-target}} class applied)  # Click on preview and observe that the vertical spacing between the macros has been stripped out    User operations known to cause this issue:  * Wiki autoformatting (e.g. when you type {{h2.}} followed by a space to trigger heading formatting)  * Cutting content (e.g. via {{cmd + v}} shortcut)    This issue is only reproducible on instances that do *not* have the collaborative editing feature enabled.  h3. Expected Results  The spaces are not modified    h3. Actual Results  Vertical spacing between the macros were stripped out.    h3.Workaround  Use operations on the top menu when available, such as selecting a text and making it title, instead of using {{h2.}}.    """
"CONFSERVER-45232","Bug","Editor - Collaborative editing",8,"The Collaborative Editing Plugin may fail to start due to disabled plugins after upgrade","""This bug was raised to investigate problems with the collaborative editing plugin not starting correctly.    This error appears in the browser's console:    There are no errors in the Confluence logs.  h5. Symptoms    You cannot edit any pages after upgrading to Confluence 6.0.1. You get the message """"Collaborative editing is taking a while..."""".  h5. Environment    This problem has been observed in a Windows Environment, with the following factors:   * SQL Server 2012   * No reverse proxy    h5. Workaround  # Enable JIRA Integration :: Plugin (com.atlassian.integration.jira.jira-integration-plugin)  #* This plugin has been confirmed as a cause for the editor to not load.  ## Click the !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! and click Manage add-ons  ## Search for JIRA Integration :: Plugin  ## Click Enable  # If the editor is still missing enable all plugins  #* [How to Manually Reset All Plugin Back to its Default State Through the Database|https://confluence.atlassian.com/confkb/how-to-manually-reset-all-plugin-back-to-its-default-state-through-the-database-859509873.html]  #* [#comment-1045971]    h5. Attempted Patch    Development provided a patched library, however, it did not have any positive impact on the problem. Instead, the browser then reported the following:    In the end, we had to get the customer to roll back their instance. This bug is being raised to determine if this is a bonafide bug, or a freak occurrence."""
"CONFSERVER-45325","Bug","Macros - JIRA Macros",3,"Epic Name/Link column on JIRA issues macro displaying wrong Epic Name","""h3. Summary    When listing issues using the JIRA Macro on Confluence, if the issues are Epics and you add the column Epic Name/Epic Link, only the first Epic Name is shown correctly:    Confluence:     !Confluence.png|thumbnail!         JIRA (same filter):    !JIRA.png|thumbnail!    h3. Environment   * Confluence server 6.0.1, 5.10.8   * JIRA Server 7.2.0    h3. Steps to Reproduce   # Create 3 Epics on JIRA   # Add a JIRA Macro on a Confluence page with the filter: {{project = <PROJECT-NAME> and issuetype = Epic}}   # Add Epic Name/Epic Link in the *Columns to Display* field    h3. Expected Results    Epics are listed with the correct name inside the lozenge with the Epic Link.  h3. Actual Results    Only the first Epic is listed with the correct name, the other are listed with the same name as the first one.  h3. Notes    Inspecting the link, we can see that it leads to the correct Epic on JIRA, so just the Name is incorrect:    !Link.png|thumbnail!    This issue is probably related to the latest changes to the Epic Name/Link, where both columns are intended to show the same information. Also, the Epic key used to shown in the link name, and now the Epic Name is shown as per the following suggestion:    * https://jira.atlassian.com/browse/CONF-31534         One other behavior observed is that issues that are *not* Epic nor are linked to an Epic, are listed by the macro with the same Epic as the other issues. Here is an example, where *BT-21* is a Story and it is not linked to any Epic:      !Screen Shot 2016-12-14 at 4.19.17 PM.png|thumbnail!    The filter used here is {{project = BT ORDER BY created ASC}}. If it is changed to {{project = BT ORDER BY created DESC}} and the Story issue is the first listed, the Story is not listed as linked to an Epic. However, the other issues are listed as the same Epic as the first one:    !Screen Shot 2016-12-14 at 4.32.52 PM.png|thumbnail!  h3. Workaround    There is no known workaround for this issue."""
"CONFSERVER-45344","Bug","Editor - Synchrony",5,"Collaborative editing does not work when Confluence is running with SSL configured in Tomcat and behind a firewall with DNAT port forwarding ","""{panel:title=UPDATE as of 29 May, 2017|titleBGColor=#ccd9ea}  This issue only happened in Confluence 6.0.1 because Confluence failed to route Synchrony requests to its built-in proxy when SSL is configured in Tomcat. The problem has been fixed since Confluence 6.0.2 (with this ticket: [CONFSERVER-45273|https://jira.atlassian.com/browse/CONFSERVER-45273]) and above. In Confluence 6.1+, the built-in proxy is properly utilised when Confluence detects that SSL is terminated at Tomcat. I will close this ticket to avoid any confusion.  {panel}  h5. Example configuration:   * No Proxy. Just SSL   * Sample confluence URL: {{[https://mycompany.com:8016|https://mycompany.com:8016/]}}   * reza.port=8017   * synchrony.port=8017      Registered JVM Arguments in the application.xml:    h5. other notes   * Connector ports used for HTTP and HTTPS are 8015 and 8443 but we're accessing Confluence via HTTPS and port 8016   * Address {{mycompany.com}} is currently a redirection from the public gateway to the internal confluence machine, using *DNAT portforwarding*   * If we access Confluence using HTTP and port 8015: {{[http://mycompany.com:8015|http://mycompany.com:8015/]}} synchrony is working    h5. Observation:    Confluence is *accessible* in HTTPS and port 8016, :{{[https://mycompany.com:8016|https://mycompany.com:8016/]}} while *Synchrony is not*. We keep seeing this error:  """
"CONFSERVER-45357","Bug","Editor - Synchrony",3,"A new synchrony-standalone jar temp file should not be generated every time Confluence is restarted","""Each jar file occupies around 60MB of disk space. Multiple jar files will occupy a considerable space until the temp directory is cleaned up.  The synchrony-standalone jar must be named in a consistent way, for example: synchrony-standalone-6.1.0.jar"""
"CONFSERVER-45572","Bug","Server - Administration",0,"NPS view sample survey on the admin panel is broken","""*How to reproduce*  - enable NPS plugin  - navigate to General Configuration > Analytics  - click """"View a sample""""    *Expected*  - a sample nps dialog is displayed    *Actual*  - no inline dialog is displayed    instead there is the following error message in the console :      which is triggered from the following piece of code :         Note : that is the case for plugin version 3.1.18, however it has been addressed in most recent versions    So a simple plugin upgrade would solve all our issues    *Done When*  - Main Plugin build includes an nps plugin job (/)  - Bump nps plugin version to latest (/)  """
"CONFSERVER-45555","Bug","Editor - Synchrony",1,"Confluence incorrectly using HTTP protocol to reach synchrony-proxy during healthcheck when running over SSL","""h2. Problem summary    When Confluence's server.xml is configured to run over SSL, the healthcheck URL continues to use the HTTP protocol to reach synchrony-proxy, which causes a failure as the request should be over HTTPS.  h2. Steps to reproduce    Install Confluence 6.0.2 to run over SSL (e.g. port 8443) at the Tomcat level (no external proxy involved). Self-signed cert is ok as long as it is imported into the Java trust store that Confluence is using.    After startup, observe the following repeated in logs:    Healthcheck URL should be [https://localhost:8443/synchrony-proxy/healthcheck] (HTTPS) rather than plain HTTP.  h2. Workaround   1. Enable the standard HTTP connector port in the {{server.xml}} file, for example:       2. Disable the healthcheck request by setting a system property *synchrony.proxy.healthcheck.disabled* to true (in setenv.sh or setenv.bat) in Confluence 6.1.0 (when it's released). For example:      If you are running Confluence as a Windows Service, access the [Java Options|https://confluence.atlassian.com/confkb/how-to-set-system-properties-for-confluence-running-as-a-service-on-windows-873858384.html] and add this line:        The 1st workaround is already included in our documentation as below:   - [Troubleshooting collaborative editing|https://confluence.atlassian.com/display/DOC/Troubleshooting+Collaborative+Editing]   - [Running Confluence Over SSL or HTTPS|https://confluence.atlassian.com/display/DOC/Running+Confluence+Over+SSL+or+HTTPS]    The 2nd workaround will be added in the same documentation when 6.1 is released. This ticket will now be resolved since the workarounds have been provided."""
"CONFSERVER-45575","Suggestion","Editor - Collaborative editing",2,"More descriptive error messaging when Synchrony is down","""Currently in Confluence 6.0.x when the editor can't connect to a Synchrony server the following error appears on the UI:    {quote}  Loading the editor's taking longer than usual.  Give it a few moments, then refresh your page if  it still doesn't load. Speak to your Confluence  admin if that doesn't fix it.  {quote}    A more specific error message to Admins may be more helpful, for example pointing to the [collab editing troubleshooting guide|https://confluence.atlassian.com/doc/troubleshooting-collaborative-editing-858772087.html] or even better, explaining what the error is (eg: socket already in use, base-url issue, etc...)    !image-2016-12-15-14-36-40-936.png|thumbnail! """
"CONFSERVER-45778","Bug","Server - Administration",2,"fix class cast exception on MailEventServerListener","""We seem to hit the following error on the Cluster Acceptance Test build      The root cause is definitely legit      we are casting the wrong Edit Event"""
"CONFSERVER-45657","Bug","Data Center - Core",2,"Synchrony keys are not generated during Confluence DC upgrade","""""""_jwt.private.key_"""" and """"_jwt.public.key_"""" properties are not generated during Confluence DC upgrade from 5.x to 6.x.    The workaround is to create a fresh Confluence installation (either DC or demo would work) and copy appropriate properties from _confluence.cfg.xml_ file from confluence home directory, for example:      h5.Workaround  # Download attached jar utility  [^Sec.jar], run it from the command line (this can be run on any system with Java, not necessarily the server):    # Copy and paste the output into {{confluence.cfg.xml}} before the {{</properties>}} tag, and restart Confluence for the changes to take effect."""
"CONFSERVER-46178","Bug","Editor - Synchrony",2,"Synchrony Status Cache doesn't work in cluster","""The SynchronyStatusCheckJob runs every 30 seconds but doesn't actually save anything to the cache. This is most-likely a bug in VCache to do with the Hazelcast cache. It works fine in non-DC instances.    Because of this, Synchrony might be down but the big red banner will never display, since if there is nothing in the cache, we assume Synchrony is just up and everything is fine. That should only happen the first time the job runs. Every other time it will be populated with Synchrony's actual status.    We should fix the VCache issue with Hazelcast. We shouldn't use a supplier in the get for the cache miss, because it will make all page loads slow since it is used by the SynchronyDownBannerDataProvider which determines if the banner should be displayed or not. That runs on every page, and we can't be waiting for a rest request there, even if it's only for Sysadmins. Additionally, it accesses the cache multiple times in the job itself."""
"CONFSERVER-45712","Bug","Editor - Collaborative editing|Editor - Synchrony",3,"Fix Synchrony Process Manager TimeoutException on Confluence start.","""There is a TimeoutException that happens sometimes on Confluence Startup when Synchrony doesn't start within its timeout limit. This is a result of fixing a deadlock in Tomcat with the Synchrony Proxy webapp by dropping the timeout from 30 seconds to 10.     We should get rid of this TimeoutException, either by increasing the timeout back to 30 seconds, or by simply removing that block altogether, if it's not really required.    The timeout doesn't actually affect Synchrony's operation. It will still start normally after that."""
"CONFSERVER-45676","Bug","Page - Export / Import",0,"Copy page hierarchy doesn't work with SQL server ","""h3. Summary    Unable to copy page hierarchy when using start *Start titles with* and *Replace title text* options    h3. Environment  * Confluence 6.0.2  * SQL Server 11.00.6020    h3. Steps to Reproduce  # Install confluence 6.0.2 and configure it with SQL server 11.00.6020 according to [Database Setup for SQL Server|https://confluence.atlassian.com/doc/database-setup-for-sql-server-9258.html]  # Create a space with pages that contains child pages  # Click on the (...) and then pick copy  # Check """"Include child pages"""" then hit next  # In the *Start titles with* put some random text, in my case *new*  # In the *Replace title text* put some random text, in my case *ion*  # In the *With this text* put some random text, in my case *aaa*  # Hit *copy*     ps: see video for more details http://recordit.co/fIquIjx70V    h3. Expected Results  Pages should be copied and text should be replaced    h3. Actual Results  Error is showing """"Something went wrong."""" and pages are not copied    The below exception is thrown in the atlassian-confluence.log file:       h3. Notes  This is working fine with other database  """
"CONFSERVER-46917","Bug","Apps - Confluence Questions",5,"The language pack update is not pick up by Confluence question","""h3. Step to reproduce:  # Install Confluence question plugin with the Confluence question French Language pack.  # Create a new user and set his default language to French via profile setting  # Create a new space and create a new question.   # Go the question page via the space side bar.     h3. Expected behaviour  The text in the search bar should be """"Que voulez-vous savoir à propos de <space name>"""", as set in the language pack from the file """"confluence-questions_fr_FR.properties"""" :     !Screen Shot 2017-01-10 at 22.15.20.png|thumbnail!     h3. Actual behaviour  The text in the search bar is showing """"Que voulais vous savoir à propos de <space name>"""" as set in the default  translation mapping of the Confluence question plugin.    which is a wrong translation of the sentence.    h3. Workaround  {panel:borderStyle=dashed| borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}  (!) *PLEASE READ*: As with all recommendations made by Atlassian Support, please follow best practices for Change Management and *test and validate* these settings in a Test/Development and Staging environment *prior to* rolling any changes into a Production environment. This is to validate these changes and ensure that they will function well within your infrastructure prior to placing these changes in production.  {panel}    For Confluence Questions 2.6.11:  # Download [^confluence-questions-2.6.11.obr] (fixed version attached here)  # Navigate to !https://confluence.atlassian.com/download/attachments/590259974/Cog.png! > *Add-ons*  # Click *Upload add-on*   # Upload the new obr downloaded in step 1  """
"CONFSERVER-51868","Suggestion","Content - Inline Comments",3,"Stream inline comments to a page to avoid connection timeout that makes all inline comments disappear","""{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51868].   {panel}  """
"CONFSERVER-45733","Bug","Editor - Collaborative editing",2,"Discarding a shared draft for a new page does not allow other users to save or discard the changes in the page afterwards","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-45733].   {panel}  h3. Summary  h5. Scenario    Two users are editing a newly created page, whereby user A created the page and passed the URL {{<base-url>/pages/resumedraft.action?draftId=xxxxx&draftShareId=xxxxx}} to user B.  h5. Outcome #1    If user A closes the editor (as the creator of the page draft), user B will not be able to publish the changes or close the editor.  h5. Outcome #2    If user B closes the editor, the user gets an error in the top-right corner of the editor that says, """"There were errors discarding your draft. An unknown error has occurred. Please check your logs.""""  h3. Steps to reproduce   # Login as user A in a browser and login as user B in incognito browser.   # As user A, create a new page.   # Copy paste the link in incognito browser so user B can join the editing session.   # Add some text.    h5. For outcome #1   # Get user A to click on 'Close' and 'Discard everyone's changes'.   # Afterwards, get user B to try to publish the page.    h5. For outcome #2:   # Get user B to click on 'Close' and 'Discard everyone's changes'.    h3. Expected Results    For both outcome #1 and #2, the page should be able to be discarded or saved depending on the user's option.  h3. Actual Results  h5. For outcome #1:    The page just loads, but nothing happens. This is what we see in the browser console:    !Outcome 1.png|thumbnail!  h5. For outcome #2:    We see the following error in the editor:    !Outcome 2.png|thumbnail!"""
"CONFSERVER-45732","Bug","Core - Email",5,"Recommended Updates email process runs for a long time consuming resources","""h3. Summary    When using a large instance of Confluence, the recommended updates email process may run for a long time while pulling large amounts of data from the database. This can sometimes cause an outage to Confluence as everything gets bottlenecked on this. This differs from CONF-30581 as that bug was caused by multiple concurrent running schedules, but this bug is caused by a single large schedule.    h3. Steps to Reproduce    # Have a very large instance of Confluence  # Allow the recommended updates email process to run    h3. Expected Results    No hit to performance    h3. Actual Results    Confluence performs slowly and may even become totally unresponsive    h3.Workaround    Disable the Daily Summary Email scheduled job as described at [Configuring the recommended updates email notification|https://confluence.atlassian.com/doc/configuring-the-recommended-updates-email-notification-281480712.html]"""
"CONFSERVER-45760","Bug","Core - Content REST APIs",2,"Confluence getBlogEntry does not always return the full exception message","""h3. Summary    Confluence XML-RPC function getBlogEntry does not always return the full exception message if the ID requested is a page  h3. Environment   * Confluence 5.10+    h3. Steps to Reproduce   # Install Confluence   # Enable XML-RPC from *Administration* -> *Further Configuration*   # Send multiple requests for _getBlogEntry_    h3. Expected Results    Every time Confluence will reply with the below error    h3. Actual Results    After multiple attempts, the returned error looks like this:    (!) Note the difference:   java.lang.Exception: java.lang.ClassCastException   java.lang.Exception: java.lang.ClassCastException: com.atlassian.confluence.pages.Page cannot be cast to com.atlassian.confluence.pages.BlogPost  h3. Workaround   * The problem on the Confluence side is caused due to JVM does JIT optimisation and suppresses stack-trace for frequent errors.   * Restart of the Confluence temporary solves the problem.   * Disable JIT optimization in Confluence, add to JVM parameter:  """
"CONFSERVER-45910","Bug","Server - Administration",3,"Confluence throws ""Comparison method violates its general contract!"" when trying to sort multiple long-running tasks","""h3. Code to reproduce    Use a unit test below to reproduce this by running the comparator:    Which is copied from Confluence code.    Confluence will throw the following error message:    That basically means that the comparator is not written correctly.  h3. Environments    Attached a test class to reproduce the error: [^ContractViolationTest.java]   - on Windows 10,   - java version """"1.8.0_111"""" Java(TM) SE Runtime Environment (build 1.8.0_111-b14), Java HotSpot(TM) Client VM (build 25.111-b14, mixed mode)   - Important: it only breaks if collection size is >= 32    h3. A possible fix in Confluence    Switching the +1 and -1 return values in the comparator's two if blocks fixes the problem.    Note that this change makes """"null key"""" cases appear before """"not-null key"""" cases in the sorted list. It does not affect the original order of objects where the key is not-null.  h3. Workaround    Adding this JVM system property fixes the issue:   -Djava.util.Arrays.useLegacyMergeSort=true  h3. References   * TimSort has been introduced in Java 7, it is a stable sort that was designed for relatively expensive comparison operations. Only used for sorting objects, not primitives. Its problematic code path is only reached for collections with size >= 32. See [http://stackoverflow.com/questions/4018332/is-java-7-using-tim-sort-for-the-method-arrays-sort]   * Exception might be caused by non-transitive comparators: [http://stackoverflow.com/questions/8327514/comparison-method-violates-its-general-contract]   * Atlassian has seen something similar, too: [https://confluence.atlassian.com/fishkb/comparison-method-violates-its-general-contract-387941517.html]   * Oracle has open issues related to this, promised to be fixed in Java 9: [http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7075600]   * See: com.atlassian.confluence.api.impl.service.longtasks.LongTaskFactory#buildStatus"""
"CONFSERVER-45921","Bug","Content - Blogs",3,"Blog post titles for different dates within the same space must be unique if Collaborative Editing is enabled","""h3. Summary  If you enable Collaborative Editing in Confluence 6.x and create two blog posts with identical titles in the same space (whether they're created on the same day or not), Confluence throws an error message saying:  {quote}A page with the title 'blog 1' already exists in this space. Enter a different title for your page.{quote}    In short, this means the behaviour with Collaborative Editing turned on is as such:  # Two blog posts with identical titles set for the same day cannot be saved.  # Two blog posts with identical titles set for different days cannot be saved.    The behaviour is different with Collaborative Editing turned off / in Confluence 5.x, whereby the results are as such:  # Two blog posts with identical titles set for the same day cannot be saved.  # Two blog posts with identical titles set for different days *can* be saved.    This change is not mentioned anywhere in the [Confluence 6.0 Release Notes|https://confluence.atlassian.com/doc/confluence-6-0-release-notes-844235309.html].    h3. Steps to reproduce  # Install Confluence 6.0.4.  # Create a space.  # Create a new blog post for January 20, 2017 titled 'blog 1' and save it.  # Create another blog post for January 3, 2017 titled 'blog 1' and save it.    h3. Expected Results  The second blog post can be saved.    h3. Actual Results  The second blog post can't be saved with the following error:     !Screen Shot 2017-01-26 at 9.57.15 PM.png|thumbnail! """
"CONFSERVER-45919","Bug","Site - Backup / Import",5,"Server Base URL becomes N/A after restoring from a Cloud backup.","""h5. Steps To Replicate :   # Export a backup from cloud   # Import into Confluence Server   # Generate a support zip   # Check *application.xml* file   # Search for <server.base.url> in the xml file   # The server base url becomes N/A      h5. Workaround   # Log in Confluence as a system administrator   # !https://confluence.atlassian.com/download/attachments/703398523/Cog.png?version=1&modificationDate=1421718696855&api=v2! > General Configuration   # Select *Edit*   # Ensure Server Base URL is displayed correctly in the text field   # Save    or follow the steps in  * [How Do I replace all 'hard' links to my old Base URL|https://confluence.atlassian.com/confkb/how-do-i-replace-all-hard-links-to-my-old-base-url-284366235.html]    to make the changes.    Note : Due to this issue, it may prevent synchrony from working properly right after the restoration."""
"CONFSERVER-45966","Bug","Editor - Page / Comment Editor",2,"Links containing umlaut or cyrillic characters become invalid","""h3. Summary    When you insert a link that contains umlaut or cyrillic characters via {{Insert more content > Link > Web link}} or the shortcuts {{⌘+K}} / {{CTRL+K}}, the link changes so that Confluence encodes the percentage (%) symbol as {{%25}}. This renders the link to be unusable.    For example:   # Correct link inserted into a Confluence page: [https://de.wikipedia.org/wiki/Die_L%C3%B6wen]   # Incorrect link after saving the page and clicking on the link: [https://de.wikipedia.org/wiki/Die_L%25C3%25B6wen]    You can see the % symbol in the original link has been replaced as {{%25}}.  h3. Steps to Reproduce    Option 1   # Create a new page and insert a web link via one of the methods below:   ** {{Insert more content > Link > Web link}}   ** {{⌘+K}} / {{CTRL+K}}   # Insert this URL into the 'Address' field: [https://de.wikipedia.org/wiki/Die_L%C3%B6wen]   # Insert any text into the the 'Link text' field.   # Click on """"Insert"""".   # Save the page.   # Try to open the link.    Option 2   # Create a new page and paste a web link   # Edit the link and see that the 'Address' and 'Link text' field have not changed   # Change the 'Link text' field to new text   # Save the link   # Edit the link again   # The URL in the 'Address' field has now been changed    h3. Expected Results    The link on the page should direct you to the correct page: [https://de.wikipedia.org/wiki/Die_L%C3%B6wen]  h3. Actual Results    The link directs you to an invalid page: [https://de.wikipedia.org/wiki/Die_L%25C3%25B6wen]  h3. Notes    Tested in Confluence 5.9.14. The functionality works as expected  h3. Workaround    -Option 1: Replace all {{%}} signs in links with spaces instead-   # -Take: {{[https://de.wikipedia.org/wiki/Die_L%C3%B6wen]}} URL-   # -Change to: {{[https://de.wikipedia.org/wiki/Die_L] C3 B6wen}}-    Option 1: Paste the link into the editor instead of using insert link dialog.   * In this method you cannot modify the link text, so the link text will be automatically set based on the url    Option 2: Use square brackets to insert the link. [ ]   # Type """"[""""   # Type the text you want for your link in the editor, for example """"My Link""""   # Type a """"|""""   # *Type* the url   # Type """"]"""" to complete the link.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.    For step 4, you could also try pasting the url but this might have less success since the url will be converted to a link automatically and you might have to first undo that automatic conversion, which in turn may cause the closing """"]"""" to have no effect. See option 3 instead.    Option 3   # Paste the URL into the editor.   # Press undo to undo any automatic link creation/extraction so you see the original URL.   # If the URL is still a link, click it, and click """"Unlink"""" to return it back to regular text.   # At the beginning of the link, type [ followed by `Escape` to exit the Link Autocomplete   # Type the text to display for the link followed by """"|""""   # Now your link should look like this   ## !Screen Shot 2017-05-11 at 7.37.39 AM.png|width=379,height=48!   # Click at the end of the link and type """"]"""" to complete the link. This should auto-convert it to a link with the desired text.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.         Option 4: Using the Source Editor to change links after adding them   # Install the [Confluence Source Editor|https://marketplace.atlassian.com/plugins/com.atlassian.confluence.plugins.editor.confluence-source-editor/server/overview] (free add-on)   # Edit the page   # Click on the {{<>}} icon in the top right   # Find the *href=* attribute that contains the '%25' in the URL   # Replace it with just '%'   # Apply the changes and save the page"""
"CONFSERVER-46040","Bug","Integrations - Office Connector",2,"Edit in Office (WebDAV Launcher 1.1.0) install loop on Firefox 51.0","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-46040].   {panel}  h3. Summary    Attempting to edit a document in Office using the Edit in Office link in a Firefox 51 browser will always prompt to install the WebDAV extensions.  h3. Environment    (Optional - If Applicable)   * Windows   * Firefox 51   * MS Office    h3. Steps to Reproduce   # Attach a word document to a page in Confluence   # Install Firefox (updated to latest version)   # Attempt to Edit in Office    h3. Expected Results    The extension installs and the document opens in Office for editing.  h3. Actual Results    The extension is installed, but when you click on Edit in Office again it asks to install the extension again. You can then repeat the loop until you get bored enough to stop. See the video below:   [^firefox51_webdav_install_loop.mov]  h3. Notes   * This currently is only affected in the latest release of Firefox (51)   * Currently verified in Windows 7    h3. Workaround   # Use a different browser/version   ** Use Edit in Office in Internet Explorer   ** Uninstall Firefox 51, install [Firefox 50.1|https://ftp.mozilla.org/pub/firefox/releases/50.1.0/], disable autoupdate   # Disable autostart:   ## Go to """"about:config"""" in firefox address bar   ## Search """"browser.tabs.remote.autostart""""   ## Double click the entry to make the value false. If you see """"browser.tabs.remote.autostart.x"""" entries, make them false too.   ## Restart firefox   ## Go to """"about:support"""" and make sure the value of """"Multiprocess Windows"""" is """"0/1 (Disabled)""""    h3. Notes for the fix   * You don't have to upgrade to 6.0.7 or 6.1.0. The fix is just the firefox add-on and it is backward compatible.   * The new version hosted by Mozilla is still under review and there is no timeline for when it will be public. Thus you can not install it using standard update of Firefox at this moment.   * To get it installed:   ** You can download it from [here|https://update.atlassian.com/office-connector/URLLauncher/latest/webdavloader.xpi] and manually install it    ** Or you can remove the existing add-on from Firefox and then confluence will prompt the installation.     """
"CONFSERVER-46039","Bug","Editor - Page / Comment Editor",3,"Links can't be edited or clicked on after saving the page","""h3. Summary  When you insert a link via {{Insert more content > Link > Web link}} or the shortcuts {{⌘+K}} / {{CTRL+K}}, the link is no longer clickable or editable once you save the page.    h3. Steps to Reproduce  # Create a new page and insert a web link via one of the methods below:  #* {{Insert more content > Link > Web link}}  #* {{⌘+K}} / {{CTRL+K}}  # Insert any one of the URLs with the protocols below into the 'Address' field:  #* {{Notes://xxxxxxxxxxx/xxxxxxxxxx}} (For Lotus Notes)  #* {{File://xxxxx}} (For local file links)  #* {{scp://user@ip_address}}  # Insert any text into the the 'Link text' field.  # Click on """"Insert"""".  # Test that the link can be edited by clicking on it.  # Save the page.  # Test that the link can be clicked on and works.  # Click on """"Edit"""" to edit the page again.  # You can see that the link is no longer editable because nothing appears when you click on it.  # Save the page.    h3. Expected Results  The link on the page should be clickable.    h3. Actual Results  The link is not clickable and nothing happens when you click on it.    h3. Note  This happens because it changes the storage format of the page from:  {code}<p><a href=""""File://xxxxx"""">Test</a></p>{code}  To:  {code}<p><a>Test</a></p>{code}    *Identifying Affected Pages*  This isn't foolproof as it may bring up lines that Confluence believes are links due to automatic formatting, however, you can try searching the database for instances of {{%<a>%</a>%}}:  {code:sql}  SELECT c.contentid,c.title,bc.body FROM bodycontent as bc  JOIN content as c  ON c.contentid=bc.contentid  WHERE bc.body like '%<a>%</a>%' and prevver is null;  {code}  (i) Depending on your database, you may need to rewrite this query to be suitable for your DBMS"""
"CONFSERVER-46227","Bug","Editor - Synchrony",3,"Shortcut links become empty after editing the page with Collaborative Editing turned on","""h3. Summary  If you use a shortcut link in a page, editing the page with Collaborative Editing turned on will result in the link to become empty. Thus, the link on the page will point to the page itself.    h3. Steps to replicate  (i) Make sure Collaborative Editing is turned on.  # Navigate to {{Confluence Administration > General Configuration > Shortcut Links}} and make sure the default key 'google' and expanded value 'http://www.google.com/search?q=' is still valid.  # Create a new page.  # Insert a link to the page and under the 'Advanced' tab, insert the following values:   *Link*: atlassian@google   *Link text*: atlassian  # Save the page.  # The link opens this page (as expected): https://google.com/search?q=atlassian  # Edit the page again and save it.  # Try to click on the same link as before.    h3. Expected results  The same page as before should be opened: https://google.com/search?q=atlassian    h3. Actual results  The link refers back to the URL of the page itself. If you edit the page and click on 'Edit' for the link, you can see that the 'Link' field is now empty."""
"CONFSERVER-46312","Bug","Editor - Page / Comment Editor",3,"When editing a page, text is being changed to a hyperlink","""With Collaborative Editing enabled, some pages turn text into hyperlink text when editing.    h3. Steps to Reproduce  # Download the attached Storage Format  # Create a new page in Confluence 6.0 with Collaborative Editing enabled  # Download *Source Editor* plugin from the marketplace  # Copy the text from the Storage Format  # Use the source editor plugin to paste the text to the new page  # Update  # Edit  # Update again    h3. Expected Result  Text will appear normally with no links    h3. Actual Result  The entire section will appear as a hyperlink    h3. Other Information  Please note, if you disable Collaborative Editing, the page appears as expected.    """
"CONFSERVER-46504","Bug","Editor - Synchrony",5,"Pasting a large amount of text will disconnect Synchrony","""h3. Environment  This has only been seen when using IIS as a reverse proxy.    h3. Workaround  Enable the Synchrony proxy as well, by adding {{-Dsynchrony.proxy.enabled=true}} to the JVM params. See [Administering Collaborative Editing|https://confluence.atlassian.com/doc/administering-collaborative-editing-858772086.html#AdministeringCollaborativeEditing-Confluence'sinternalSynchronyproxy] for more information."""
"CONFSERVER-46523","Bug","Content - Restrictions",2,"request access to unpublished draft or content created by anonymous fails","""*Steps to reproduce*   * enable anonymous access   * anonymous user creates a page P   * User A with set restrictions permission (for instance space admin) restricts page P to themselves   * User B views the page and is presented with request access panel   * User B clicks """"Request Access""""    *Expected Behaviour*   * a notification is sent to space admin   * User B is prompted that a notification was sent    *Actual Behaviour*   * no notification is sent   * User B is prompted that a notification was not sent     """
"CONFSERVER-46542","Bug","Content - Attachments",5,"XLSX File Conversion Service causes OutOfMemory","""h3. Summary    Uploading some XLSX files to Confluence can cause OutOfMemory error while generating preview.  h3. Steps to Reproduce   # Upload with 700x40 XLSX file to Confluence   # Open file in preview window    h3. Expected Results    Preview generated or """"Not possible to preview"""" showed.  h3. Actual Results    Confluence became unresponsive.   The below exception is thrown in the catalina.out file:    The below exception is thrown in the atlassian-confluence.log:    h3. Heap Dump Analysis    !Screen Shot 2017-02-23 at 10.33.27.png|thumbnail!    !Screen Shot 2017-02-23 at 10.35.04.png|thumbnail!  h3. Workaround    Upgrade the Document Conversion add-on with the latest version, below   * Download the right *document-conversion-library-x.x.xx.jar*  ||Confluence version ||Document Library  Version||  |6.0 - 6.4|Document conversion [1.2.25|https://packages.atlassian.com/maven-closedsource-local/com/atlassian/plugins/document-conversion-library/1.2.25/document-conversion-library-1.2.25.obr] ([mirror|https://drive.google.com/file/d/1oqv9iuJDnsxE_aRRRMOQ6Yc0DHOoJlnl/view?usp=sharing])|  |h4. after 6.4|Document conversion [2.0.2.1|https://packages.atlassian.com/maven-closedsource-local/com/atlassian/plugins/document-conversion-library/2.0.2.1/document-conversion-library-2.0.2.1.jar] |     * Install the add on by file upload, as per [installing plugins |https://confluence.atlassian.com/upm/installing-add-ons-273875715.html#Installingadd-ons-Installingbyfileupload]     """
"CONFSERVER-48483","Bug","Apps - Team Calendar",3,"TC is making too many requests to the Media API","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48483].   {panel}  As you can see on https://zipkin.atlassian.io/traces/352e5b2b2c21229f , TC is making 39 requests to the Media API for the exact same file.    Transcription from HC:    {quote}  [11:33 AM] Eduardo Garcia [Atlassian]: so it's asking for the same icon ~30 times?  [11:34 AM] Eduardo Garcia [Atlassian]: is it possible to cache that somehow, at least for the same call? (which is what we're seeing here)  [11:41 AM] Richard Atkins [Atlassian]: I'm still trying to see where the rest resource inlines any attachments, rather than just generating links to them  [11:41 AM] Richard Atkins [Atlassian]: (because browsers are great at ensuring they only retrieve a link once)  [11:41 AM] Eduardo Garcia [Atlassian]: yeah :D  [11:41 AM] Eduardo Garcia [Atlassian]: although for that to work, you probably need a signed url  [11:41 AM] Eduardo Garcia [Atlassian]: but in any case, that'd be better, yes  [11:42 AM] Richard Atkins [Atlassian]: com.atlassian.confluence.extra.calendar3.rest.resources.EventResource#getEvents(java.lang.String, java.lang.String, java.lang.String, java.lang.String) is the entry point for that rest request  [11:42 AM] Eduardo Garcia [Atlassian]: or using something like VCache or whatever to cache the icons for a while, if the probability of them being repeated is high  [11:42 AM] Eduardo Garcia [Atlassian]: we can also do some kind of caching in our side at some point, but it's a lot more involved of course :)  [11:48 AM] Richard Atkins [Atlassian]: I'm not seeing anything that would cause a rest request to have an inlined attachment of any kind. Have you been able to reproduce this on any test env?  [11:49 AM] Richard Atkins [Atlassian]: What I am seeing is that reminder notifications (and other notification types) will inline images, but that's only when generating emails  [11:50 AM] Richard Atkins [Atlassian]: What sort of zipkin trace header integration was created for the jobs triggered by the external job scheduler?  [11:50 AM] Richard Atkins [Atlassian]: are they triggered through rest requests, or through SQS?  [11:51 AM] Richard Atkins [Atlassian]: Because it all feels like we're looking in the wrong place  [11:54 AM] Richard Atkins [Atlassian]: hmmmmm, maybe not  [11:54 AM] Richard Atkins [Atlassian]: any time DefaultResourceDataHandler.createAttachmentDataHandler is called, it reads all the bytes in the relevant attachment  [11:55 AM] Richard Atkins [Atlassian]: and that *could* be being called on rest requests, even when that DataHandler is subsequently not used for anything  [11:56 AM] Richard Atkins [Atlassian]: that's all as a side effect of invoking com.atlassian.confluence.extra.calendar3.calendarstore.event.transformers.SubCalendarEventSupportingInviteesTransformer#transform  [11:59 AM] Richard Atkins [Atlassian]: It looks like that Transformer will only trigger the problem if there is precisely one invitee for the event that's being sent. If there are more, then we'll just append the names of the invitees (sounds like bad ux)  [11:59 AM] Richard Atkins [Atlassian]: Looks like you're getting 30 requests for the same file because you're retrieving 30 events with the same user  [12:00 PM] Richard Atkins [Atlassian]: You'll be happy to know that switching to Aa managed avatars will probably make this problem go away for you  [12:02 PM] Richard Atkins [Atlassian]: of course, it will also *break* in that case, because it assumes that all profile pictures are still managed by Confluence's AttachmentManager  [12:11 PM] Richard Atkins [Atlassian]: @DuyLuong which issue tracker should @Edu  raise a bug in?  [12:12 PM] Richard Atkins [Atlassian]: Looks like we can fix an ugly performance and memory problem at the same time, simply by making the Transformer (or DataHandler) aware that it's rendering for REST vs a notification  [12:13 PM] Richard Atkins [Atlassian]: (notification ==> inline any Avatar that isn't external)  [12:13 PM] Richard Atkins [Atlassian]: And at the same time, we can fix the bug where external avatars will cause NPEs or worse  [12:14 PM] Richard Atkins [Atlassian]: Just because a ProfilePictureInfo has a downloadPath, it doesn't mean that path is inside Confluence  [12:15 PM] Richard Atkins [Atlassian]: I'm assuming that there's another team taking care of the Cloud side of the TeamCal fork...  {quote}    """
"CONFSERVER-51568","Bug","Macros - JIRA Macros",8,"JIRA issues Macro instead of Epic Name showing Epic Link column","""{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-51568].  {panel}  h3. Summary    JIRA issues macro in table view is showing Epic Link when in display options only Epic Name is chosen.  h3. Environment    JIRA 7.2.4   Confluence 5.10.8 - 6.4.x  h3. Steps to Reproduce   # Create an Epic in JIRA   # In Confluence insert JIRA Issues Macro to the page   ## Select the issue key of the Epic in a search   ## In the display options   ### select columns to display = Key, Summary, Epic Name, Epic Status, Issue Type => the table shows Epic Link instead of Epic Name   [^Screen Shot 2017-03-02 at 13.58.50.png]    [^Screen Shot 2017-03-02 at 13.58.33.png]   ### select columns to display = Key, Summary, Epic Name, Epic Status => Same result for JIRA 7.2 and error for JIRA 6.4:   [^4-View without Issue Type.JPG]   ### select columns to display = Key, Summary, Epic Name, Epic Status, Epic Link => the table shows Epic Links instead of Epic Name and column Epic Links doesn't exist    h3. Workaround    No workaround available at the moment.  h3. Solution    Upgrade to Confluence 6.5.0 or newer."""
"CONFSERVER-51631","Bug","Server - Platform",5,"Upgrading from 5.9.x to 5.10.x or above fails if any data exists in user_relation, content_relation or usercontent_relation tables","""h3. Summary    When upgrading to 5.10 or above from 5.9.x, the RelationConstraintsPreSchemaUpgradeTask gets re-run due to the build number being bumped since 5.10. This means that if any data exists in any of the affected tables user_relation, content_relation or usercontent_relation, then the upgrade task will fail, and hence the upgrade as a whole.      h3. Steps to Reproduce    # Install Confluence 5.9.x  # Perform some action which causes data to exist in these tables (I am not actually sure how it gets there)  # Upgrade to 5.10 or above    h3. Expected Results    Upgrade succeeds    h3. Actual Results    Upgrade fails with the below log entry:    {code:none}  2017-01-27 17:24:59,240 ERROR [localhost-startStop-1] [atlassian.confluence.plugin.PluginFrameworkContextListener] launchUpgrades Upgrade failed, application will not start: RelationService upgrade failed to prevent data loss. Please read https://confluence.atlassian.com/x/MRJZLw for more details  com.atlassian.confluence.upgrade.UpgradeException: RelationService upgrade failed to prevent data loss. Please read https://confluence.atlassian.com/x/MRJZLw for more details          at com.atlassian.confluence.upgrade.upgradetask.RelationConstraintsPreSchemaUpgradeTask.assertTableIsEmpty(RelationConstraintsPreSchemaUpgradeTask.java:72)          at com.atlassian.confluence.upgrade.upgradetask.RelationConstraintsPreSchemaUpgradeTask.upgradeTable(RelationConstraintsPreSchemaUpgradeTask.java:64)          at com.atlassian.confluence.upgrade.upgradetask.RelationConstraintsPreSchemaUpgradeTask.doUpgrade(RelationConstraintsPreSchemaUpgradeTask.java:58)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager$UpgradeStep$3.execute(AbstractUpgradeManager.java:641)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager.executeUpgradeTask(AbstractUpgradeManager.java:248)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager.executeUpgradeStep(AbstractUpgradeManager.java:228)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager.runSchemaUpgradeTasks(AbstractUpgradeManager.java:190)  {code}     h3.Workaround    The workaround is to store the data in a temporary table while upgrading, and then copy it back after it's complete. Here's some steps to perform this. The examples below are for MySQL and Postgres environments, but the same concept can be adapted to other DBMS though the syntax may be different:    h4. MySQL  # Stop Confluence and ensure you take a database backup in case anything goes wrong  # Create a new temporary table which is a copy of the table containing data, for example:  {code:sql}  create table usercontent_relation_backup like usercontent_relation;  insert usercontent_relation_backup select * from usercontent_relation;  {code}  # Truncate the original table, for example:  {code:sql}  truncate table usercontent_relation;  {code}  # Perform the upgrade as normal  # Stop Confluence  # Move the data back from the temporary table into the newly created empty table, for example:  {code:sql}  insert usercontent_relation select * from usercontent_relation_backup;  {code}  # Remove the temporary table:  {code:sql}  drop table usercontent_relation_backup;  {code}  # Start Confluence again    h4. Postgres  # Stop Confluence and ensure you take a database backup in case anything goes wrong  # Create a new temporary table which is a copy of the table containing data, for example:  {code:sql}  CREATE TABLE usercontent_relation_backup AS SELECT * FROM usercontent_relation;  {code}  # Truncate the original table, for example:  {code:sql}  TRUNCATE usercontent_relation;  {code}  # Perform the upgrade as normal  # Stop Confluence  # Move the data back from the temporary table into the newly created empty table, for example:  {code:sql}  INSERT INTO usercontent_relation SELECT * FROM usercontent_relation_backup;  {code}  # Remove the temporary table:  {code:sql}  DROP TABLE usercontent_relation_backup;  {code}  # Start Confluence again    h4. Oracle   # Stop Confluence and ensure you take a database backup in case anything goes wrong   # Create a new temporary table which is a copy of the table containing data, for example: {code:sql}  CREATE TABLE usercontent_relation_backup AS SELECT * FROM usercontent_relation; {code}  Per [https://stackoverflow.com/questions/8997399/creating-duplicate-table-from-existing-table]   # Truncate the original table, for example: {code:sql}  TRUNCATE TABLE usercontent_relation; {code}  Per [https://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_10007.htm#SQLRF01707]   # Perform the upgrade as normal   # Stop Confluence   # Move the data back from the temporary table into the newly created empty table, for example: {code:sql}  INSERT INTO usercontent_relation SELECT * FROM usercontent_relation_backup; {code}  Per [https://www.techonthenet.com/oracle/insert.php]   # Remove the temporary table {code:sql}  DROP TABLE usercontent_relation_backup PURGE; {code}  Per [https://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_9003.htm]   # Start Confluence again."""
"CONFSERVER-51661","Bug","Site - Backup / Import",5,"There are many errors ""executeClusteredJobWithRecoveryGuard Unhandled exception"" in atlassian-confluence.log after migrating from Cloud to Server or after an upgrade","""h3. Summary  There are many errors """"executeClusteredJobWithRecoveryGuard Unhandled exception"""" in atlassian-confluence.log after migrating from Cloud to Server or after upgrading Confluence        h3. Environment  * Migrated from Confluence Cloud to Server 6.0.2  * Confluence Upgrade      h3. Steps to Reproduce  # Restore Confluence Cloud backup into Confluence Server  # Restart Confluence    h3. Expected Results  No errors in atlassian-confluence.log    h3. Actual Results  The below exception is thrown in the atlassian-confluence.log file:          h3. Workaround  # Shut down Confluence  # Backup scheduler_clustered_jobs table or the whole Confluence database *This must be done*  # Executing the following SQL query to clear off the table :    # Start Confluence"""
"CONFSERVER-51651","Bug","Core - Email",1,"Add User token expired in email","""h3. Summary  When using the Add User option to invite a user to Confluence the link that is sent contains an expired token.  h3. Environment  NA  h3. Steps to Reproduce  # Setup Confluence 6.0.6 with an email server  # Go to !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png!>Users>Add User  # Add the user and send the email to the user to set their password    h3. Expected Results  The user is sent a link to set their password    h3. Actual Results  The link will be sent but the token is expired:  !resetpasswordtoken.png|thumbnail!     h3. Notes  h3.Workaround  The user can click on the """"get a new token here"""" link and reset the password.  """
"CONFSERVER-52797","Bug","Site - Backup / Import",2,"Large synchrony EVENTS table leads to OOM during XML Site Backup","""We use a <composite-id> type in hibernate for the EVENTS table (because synchrony has two columns as a composite id). However, hibernate treats entities with composite ids differently to entities with an id field. Specifically, hibernate when being asked what the id of an entity is (which is what we do to get a handle during export), it returns the entire entity object as the id.    We keep around these """"transient"""" ids in our xml export to make sure we don't duplicate etc. The code that uses these ids assume that they are small.    We will have to re-implement it with a composite id class, and hopefully, that will fix the issue.      """
"CONFSERVER-52405","Bug","Editor - Synchrony",1,"Add timestamp to synchrony log messages","""Raised here: https://jira.atlassian.com/browse/CONF-51824"""
"CONFSERVER-51824","Suggestion","Editor - Synchrony",2,"Add timestamp to synchrony log messages","""{panel:bgColor=#e7f4fa}    *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51824].    {panel}    h3. Problem Definition  Timestamp is not a part of the standard synchrony logging yet.  Please update message format in log4j properties file so we log the timestamp for messages.    h3. Suggested Solution  Add timestamp to Synchrony log file     h3. Workaround  You can add the timestamp by following the below steps:    # Stop Confluence  # Go to {{<confluence-install>/confluence/WEB-INF/classes/log4j.properties}}  # Look for the section that starts with the below line:    # In that section, you should have the following line    # Modify this to become:    # Start Confluence    For more info on PatternLayout, please check [Log4j Pattern Layout Documentation|https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html].        Log snippet example:    {code:borderStyle=solid}  2017-03-29 11:17:41,479 DEBUG processLine Running QueryDSL sytem...  2017-03-29 11:17:41,588 DEBUG processLine {""""synchrony"""":{""""message"""":""""synchrony.querydsl.jdbc [info] connection pool test-connection-on-checkin: true idle-connection-test-period: 100 max-idle-time-excess-connections: 100 max-idle-time: 3600"""",""""ns"""":""""synchrony.querydsl.jdbc"""",""""level"""":""""info""""},""""message"""":""""synchrony.querydsl.jdbc [info] connection pool test-connection-on-checkin: true idle-connection-test-period: 100 max-idle-time-excess-connections: 100 max-idle-time: 3600""""}  2017-03-29 11:17:41,605 DEBUG processLine MLog initialization issue: slf4j found no binding or threatened to use its (dangerously silent) NOPLogger. We consider the slf4j library not found.  2017-03-29 11:17:41,606 DEBUG processLine MLog clients using log4j logging.  2017-03-29 11:17:41,631 DEBUG processLine Initializing c3p0-0.9.5.1 [built 16-June-2015 00:06:36 -0700; debug? true; trace: 10]  2017-03-29 11:18:18,384 DEBUG processLine {""""synchrony"""":{""""message"""":""""synchrony.middleware.memoize-response [info] request for static resource"""",""""cache-key"""":[""""0.0.0.0"""",""""/synchrony/resources/js/vendor/sockjs.min.js"""",null],""""ns"""":""""synchrony.middleware.memoize-response"""",""""level"""":""""info""""},""""message"""":""""synchrony.middleware.memoize-response [info] request for static resource""""}  2017-03-29 11:18:18,502 DEBUG processLine {""""synchrony"""":{""""message"""":""""synchrony.middleware.memoize-response [info] request for static resource"""",""""cache-key"""":[""""0.0.0.0"""",""""/synchrony/resources/js/synchrony.min.js"""",null],""""ns"""":""""synchrony.middleware.memoize-response"""",""""level"""":""""info""""},""""message"""":""""synchrony.middleware.memoize-response [info] request for static resource""""}  2017-03-29 11:18:18,958 DEBUG processLine Initializing c3p0 pool... com.mchange.v2.c3p0.ComboPooledDataSource [ acquireIncrement -> 3, acquireRetryAttempts -> 30, acquireRetryDelay -> 1000, autoCommitOnClose -> false, automaticTestTable -> null, breakAfterAcquireFailure -> false, checkoutTimeout -> 0, connectionCustomizerClassName -> null, connectionTesterClassName -> com.mchange.v2.c3p0.impl.DefaultConnectionTester, contextClassLoaderSource -> caller, dataSourceName -> 1bqvx939n71a0e010n5igr|47864b2e, debugUnreturnedConnectionStackTraces -> false, description -> null, driverClass -> org.postgresql.Driver, extensions -> {}, factoryClassLocation -> null, forceIgnoreUnresolvedTransactions -> false, forceSynchronousCheckins -> false, forceUseNamedDriverClass -> false, identityToken -> 1bqvx939n71a0e010n5igr|47864b2e, idleConnectionTestPeriod -> 100, initialPoolSize -> 3, jdbcUrl -> jdbc:postgresql://localhost:5432/confluence610, maxAdministrativeTaskTime -> 0, maxConnectionAge -> 0, maxIdleTime -> 3600, maxIdleTimeExcessConnections -> 100, maxPoolSize -> 15, maxStatements -> 0, maxStatementsPerConnection -> 0, minPoolSize -> 3, numHelperThreads -> 3, preferredTestQuery -> null, privilegeSpawnedThreads -> false, properties -> {user=******, password=******}, propertyCycle -> 0, statementCacheNumDeferredCloseThreads -> 0, testConnectionOnCheckin -> true, testConnectionOnCheckout -> false, unreturnedConnectionTimeout -> 0, userOverrides -> {}, usesTraditionalReflectiveProxies -> false ]  2017-03-29 11:18:19,339 DEBUG processLine {""""synchrony"""":{""""message"""":""""synchrony.sync.hub [info] create-entity"""",""""event"""":""""entity.created"""",""""entity"""":""""/Synchrony-901a371c-caf0-3343-b0be-836ec2606cff/confluence-327699"""",""""ns"""":""""synchrony.sync.hub"""",""""level"""":""""info""""},""""message"""":""""synchrony.sync.hub [info] create-entity""""}  2017-03-29 11:18:20,911 DEBUG processLine {""""synchrony"""":{""""message"""":""""synchrony.metrics.hub-metrics [info] init-session"""",""""source"""":""""O32qVJ5HfgeDrEblwh9zQz4"""",""""event"""":""""session.created"""",""""modified-content"""":false,""""entity"""":""""/Synchrony-901a371c-caf0-3343-b0be-836ec2606cff/confluence-327699"""",""""ns"""":""""synchrony.metrics.hub-metrics"""",""""level"""":""""info""""},""""message"""":""""synchrony.metrics.hub-metrics [info] init-session""""}  2017-03-29 11:18:32,280 DEBUG processLine {""""synchrony"""":{""""message"""":""""synchrony.metrics.hub-metrics [info] close-session"""",""""source"""":""""O32qVJ5HfgeDrEblwh9zQz4"""",""""event"""":""""session.destroyed"""",""""modified-content"""":true,""""entity"""":""""/Synchrony-901a371c-caf0-3343-b0be-836ec2606cff/confluence-327699"""",""""ns"""":""""synchrony.metrics.hub-metrics"""",""""level"""":""""info""""},""""message"""":""""synchrony.metrics.hub-metrics [info] close-session""""}  {code}"""
"CONFSERVER-51873","Bug","Editor - Collaborative editing",3,"Creating EVENTS table fails with ERROR The size (16777215) given to the column 'event' exceeds the maximum allowed for any data type (8000)","""h3. Summary  Customers on MSSQL run into the following error indicating that the EVENTS table failed to be created due to the size given to the EVENT column.    h3. Environment  * MSSQL    h3. Expected Results  The EVENT table gets created    h3. Actual Results  The below exception is thrown in the logs, and the EVENT table subsequently doesn't get created.       h3. Notes  The create table command seems to be requesting the EVENT column to be created with {{VARBINARY(16777215)}} as opposed to more correct {{VARBINARY(MAX)}}    h3.Workaround    [Upgrading fails with ERROR The size (16777215) given to the column 'event' exceeds the maximum allowed for any data type (8000) in Confluence|https://confluence.atlassian.com/display/CONFKB/Upgrading+fails+with+ERROR+The+size+%2816777215%29+given+to+the+column+%27event%27+exceeds+the+maximum+allowed+for+any+data+type+%288000%29+in+Confluence]  """
"CONFSERVER-51872","Bug","Editor - Synchrony",2,"'slf4j library not found' error message in Confluence 6","""h3. Summary  'slf4j library not found' error message in the Confluence 6 {{atlassian-synchrony.log}}    h3. Environment  * Confluence 6  * Synchrony enabled    h3. Steps to reproduce  Anytime Confluence is started using Collaborative editing, the following message is printed to the logs:      This is printed whether Collaborative editing is working, or if its configured correctly or incorrectly.      h3. Notes  Error seems to be benign as Synchrony still works, but there could be a logging issue.    h3.Workaround  No workaround found so far.  """
"CONFSERVER-51900","Bug","Editor - Synchrony",3,"Synchrony is Ignoring java.io.tmpdir Property","""h3. Summary    Synchrony is ignoring the system property *java.io.tmpdir* when added to file *synchrony-args.properties*.    h3. Steps to Reproduce    # Add *java.io.tmpdir=/path/to/your/own/temp/directory* to *<confluence-home>/synchrony-args.properties*  # Restart Confluence  # Create or Edit a page    h3. Expected Results    The file *snappy-1.1.0.1-3787f697-2b19-4e27-9c89-be03fcde98a4-libsnappyjava.so* is located under /path/to/your/own/temp/directory.    h3. Actual Results    The mentioned file is located at the default system */tmp* folder.     h3. Notes    This is a regression on version 6.0.6, from versions 6.0.2 to 6.0.5 the property was successfully read by Synchrony. This is a big problem while working around the limitation of not being able to mount /tmp with *exec* permissions as in the following KB:    * [Editor fails to load in Confluence 6.x due to 'Could not initialize class org.xerial.snappy.Snappy' error|https://confluence.atlassian.com/confkb/editor-fails-to-load-in-confluence-6-x-due-to-could-not-initialize-class-org-xerial-snappy-snappy-error-859462192.html]    Adding the property *-Djava.io.tmpdir* to setenv file *does not work around this issue*. Confluence reads the system property successfully but Synchrony does not.    h3.Workaround    No known workaround at the moment."""
"CONFSERVER-51937","Bug","Server - Installer / Setup",3,"JRE_HOME is not set when using Linux(x64) installer","""h3. Summary    Confluence 6.1 installed with the installer on Linux cannot start with embedded JRE because neither JAVA_HOME nor JRE_HOME are set by setenv script  h3. Environment    Confluence 6.1.0   Ubuntu 14.04  h3. Steps to Reproduce   # Install Confluence with the installer (x64) on Linux   # Choose Not start   # Go to $CONFLUENCE_INSTALL/bin   # {{./start_confluence.sh}}  h3. Expected Results    Confluence started    h3. Actual Results    Confluence cannot start, no logs are created in catalina.out or Confluence home.   The console showing the issue      h3. Root Cause    The issue is happening because of incorrect logic in the script {{setjre.sh}} :    When the execution will got into the condition \{\{ if [ -z """"$JAVA_HOME"""" -a -z """"$JRE_HOME"""" ]}} it terminates with {{exit 1;}} so {{JRE_HOME=""""/opt/atlassian/confluence/jre/""""; export JRE_HOME}} will never be executed.    There's a bug in the shell script. If there's a /usr/bin/java file, then JRE_HOME will be temporarily set to /usr and then it will be corrected at the end of the script. So this issue happens on a Linux machine that doesn't have the default JVM installed.  h3. Workaround(s)  * Set {{JAVA_HOME=""""/opt/atlassian/confluence/jre/""""}} explicitly before starting Confluence (keep in mind that /opt/atlassian/confluence/jre is the path to Confluence installation direcotry and should be adapted if you are using your own path)  * [Use Confluence with external Oracle JDK (recommended)|https://confluence.atlassian.com/doc/installing-java-for-confluence-144212101.html]  * Remove the {{exit 1}} lines  * Move {{JRE_HOME=""""/opt/atlassian/confluence/jre/""""; export JRE_HOME}} to the top of {{setjre.sh}}  * """
"CONFSERVER-52100","Bug","Server - Platform",2,"The log level for the root appender in synchrony-proxy is empty","""{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-52100].   {panel}  The log level should be set to WARN, otherwise a lot of DEBUG logs will be written to the catalina.out file."""
"CONFSERVER-51958","Bug","Core - OSGi Plugins Platform",3,"Unable to start the plugin container for plugin 'com.atlassian.upm.plugin-license-storage-plugin' after upgrade to Confluence 6.x","""h3. Steps to reproduce   # Install Confluence 5.x;   # Upgrade """"Atlassian Universal Plugin Manager - Plugin License Storage plugin"""";   # Upgrade Confluence to 6.x;    *Expected results*    No errors are thrown.    *Actual results*  {noformat:title=atlassian-confluence.log}  2017-03-16 17:07:07,764 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [plugin.osgi.factory.OsgiPlugin] onPluginContainerFailed Unable to start the plugin container for plugin 'com.atlassian.upm.plugin-license-storage-plugin'   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'licenseReceiptValidator' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.PluginLicenseRepository]: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)   at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)   at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)   at org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext.access$1600(AbstractDelegatedExecutionApplicationContext.java:60)   at org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext$4.run(AbstractDelegatedExecutionApplicationContext.java:325)   at org.eclipse.gemini.blueprint.util.internal.PrivilegedUtils.executeWithCustomTCCL(PrivilegedUtils.java:85)   at org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext.completeRefresh(AbstractDelegatedExecutionApplicationContext.java:290)   at org.eclipse.gemini.blueprint.extender.internal.dependencies.startup.DependencyWaiterApplicationContextExecutor$CompleteRefreshTask.run(DependencyWaiterApplicationContextExecutor.java:137)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)   at java.lang.Thread.run(Thread.java:745)  Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)   at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)   at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)   ... 19 more  Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)   at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)   at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)   ... 33 more  Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1105)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1050)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)   at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)   ... 47 more  Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:163)   at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:89)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1098)   ... 59 more  Caused by: java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl.<init>(LicenseManagerProviderImpl.java:40)   at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)   at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)   at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)   at java.lang.reflect.Constructor.newInstance(Constructor.java:423)   at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)   ... 61 more  2017-03-16 17:07:17,795 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [internal.util.concurrent.RunnableTimedExecution] execute Closing runnable for context NonValidatingOsgiBundleXmlApplicationContext(bundle=com.atlassian.upm.plugin-license-storage-plugin, config=osgibundle:/META-INF/spring/*.xml) did not finish in 10000ms; consider taking a snapshot and then shutdown the VM in case the thread still hangs   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  2017-03-16 17:07:17,842 WARN [ThreadPoolAsyncTaskExecutor::Thread 24] [confluence.util.profiling.DurationThresholdWarningTimingHelperFactory] logMessage Execution time for publishing event com.atlassian.plugin.event.events.PluginContainerFailedEvent@2ea04998 took 10077 ms (warning threshold is 5000 ms)   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  2017-03-16 17:07:17,842 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [extender.internal.support.ExtenderConfiguration] onOsgiApplicationEvent Application context refresh failed (NonValidatingOsgiBundleXmlApplicationContext(bundle=com.atlassian.upm.plugin-license-storage-plugin, config=osgibundle:/META-INF/spring/*.xml))   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'licenseReceiptValidator' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.PluginLicenseRepository]: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder  {noformat}  !ss.png|thumbnail!    When we upgrade a system plugin, Confluence handles it as """"User Installed"""" and stores the data in the *PLUGINDATA* table. Since 'com.atlassian.upm.plugin-license-storage-plugin' has been unbundled from Confluence 6.x, it fails to load the *PLUGINDATA* entry.    *Workaround*    (!) Always backup the database before any changes.   # Shutdown Confluence;   # Ensure that there's an entry of this plugin in the PLUGINDATA table  {code:sql}  SELECT plugindataid, pluginkey, filename, lastmoddate FROM PLUGINDATA where PLUGINKEY='com.atlassian.upm.plugin-license-storage-plugin';  {code}   # Delete the bad entry in PLUGINDATA  by executing the following DELETE statement:  {code:sql}  delete from PLUGINDATA where PLUGINKEY='com.atlassian.upm.plugin-license-storage-plugin';  {code}   # *[Clear Confluence plugin cache|https://confluence.atlassian.com/display/CONFKB/How+to+clear+Confluence+plugins+cache]*;   # Start Confluence;    See  * [Unable to start the plugin container for plugin 'com.atlassian.upm.plugin\-license\-storage\-plugin' after upgrade to Confluence 6.x|https://confluence.atlassian.com/confkb/unable-to-start-the-plugin-container-for-plugin-com-atlassian-upm-plugin-license-storage-plugin-after-upgrade-to-confluence-6-x-922911414.html]"""
"CONFSERVER-51951","Bug","Search - Indexing",8,"Indexer does not handle attachments efficiently for a page update","""h3. Summary  There are two *different* symptoms for this problem, but both go back to the same root cause.    h5. Scenario 1  When a page is updated and needs to be indexed, the indexer does not add the attachments, comments and permissions into the journal table. This will overload the hibernate session, where it will pick up items from the journal table. These items will introduce more work on the indexer than expected, where it will need to process all the attachments, comments and permissions of the current page. From the user perspective, it will look like the indexer stalls and slow at processing a small number of tasks     h5. Scenario 2  When a page is updated multiple times and those changes are included in a single indexer batch, the indexer does not handle this efficiently. It will index those changes with every change.      h3. Steps to Reproduce  Reproducing this behavior for Scenario 2 will require multiple quick updates to a certain page (within 5 seconds.)    *Hint:* This can be done through rest api   # Create a new page   # Add multiple attachments to the page (preferably large attachments)   # Edit the page and save   # Edit the page again and save   # Edit the page a third time and save   # Enable DEBUG logging for the package        h3. Expected Results  The indexer will show that it is processing the page along with all the attachments, comments and permission efficiently.   The page should be processed *only once* in a single batch.        h3. Actual Results  The indexer will show that it is processing a single page only while it is actually processing page, attachments, comment and permissions. Also the indexer will process each change separately, redoing all the work again.  This is very time and resource consuming and will cause the indexer to stall or lead to an outage      Large attachments can affect the processing time as well. Below is the log snippet of the behavior for *Scenario 1*  {code:borderStyle=solid}  2017-03-21 11:15:03,887 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 291 items in 43881 milliseconds  2017-03-21 11:14:20,006 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 11:14:16,240 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 2338 items in 276234 milliseconds  2017-03-21 11:09:40,005 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 11:09:36,402 DEBUG [scheduler_Worker-2] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 1527 items in 466396 milliseconds  2017-03-21 11:01:50,006 DEBUG [scheduler_Worker-2] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 11:01:47,935 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 1778 items in 667844 milliseconds  2017-03-21 10:50:40,091 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 10:50:36,342 DEBUG [scheduler_Worker-6] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 869 items in 26337 milliseconds  2017-03-21 10:50:10,004 DEBUG [scheduler_Worker-6] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  ....  2017-03-21 10:48:02,290 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 6 items in 2285 milliseconds  2017-03-21 10:48:00,005 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  ....  2017-03-21 10:36:50,333 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 4 items in 10325 milliseconds  2017-03-21 10:36:40,007 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  ....  2017-03-21 10:34:58,947 DEBUG [scheduler_Worker-9] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 157 items in 3942 milliseconds  2017-03-21 10:34:55,005 DEBUG [scheduler_Worker-9] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  {code}      h3. Workaround  The current workaround is to reduce the index batch size in order to avoid including multiple changes in a single batch.  Please add the below to your JVM argument:  {code:java}  -Dindex.queue.batch.size=100  {code}"""
"CONFSERVER-52052","Bug","Server - Administration",2,"Base URL check displays warning when URL is the same","""In some configurations, particularly when Tomcat's the proxyName or proxyPort values are not configured properly, the Base URL check is warning admins that their current URL is different to the base URL, but the URLs displayed in the warning are identical. Example screenshot:    !baseurl.png!    While this indicates an actual problem in the configuration, the warning is very confusing and should be updated to something more meaningful.    h2. Steps to reproduce     * Don't use a reverse proxy   * Configure the proxyName and proxyPort to bogus values   * You should get the error above when accessing Confluence    or     * Use a reverse proxy   * Do not configure the proxyName and proxyPort values or configure them to incorrect values   * You should get the error above    h2. Workaround    It is recommended that admins configure the proxyName and proxyPort settings correctly in Tomcat's server.xml file.    A KB article exists with instructions on how to disable the plugin so the incorrect warning is not shown.  https://confluence.atlassian.com/display/CONFKB/Your+URL+doesn%27t+match+warning+in+Confluence+6.1+or+later"""
"CONFSERVER-51985","Bug","Macros - JIRA Macros|Macros - Page Properties",5,"Embedded JIRA macro in Page Properties Grandchild Page causes Continuous Loop of Page","""h4. Summary    Per Developer Escalation creating this defect for a problem that occurs when a Page Properties report on a grandchild Page contains an embedded JIRA macro. The ultimate parent page will be thrown into a continuously refreshing loop, and we are unable to stop the loop from occurring without forcing the browser to stop.  h4. Steps to Reproduce   # Create a new Confluence 6.0.6 instance   # Add the demo site content and a local admin account   # Import the attached Space Export [^se2.zip] into the newly created Confluence 6.0.6 site   # Perform a Content Indexing administration for the site   # Navigate to <yourConfleunceURL>/display/TS2/Page+Properties+testing   # Observe the page in a *continuous loop* as the Page Properties report in a grandchild page has a JIRA issues gadget in the report   # Observe that you can not stop the page from looping by clicking links, the back button or other methods   # Quit your browser   # Reopen your browser   # Go to <yourConfluenceURL>/display/TS2/Summary+of+BLUE+Child+Pages   # Remove the JIRA Gadget in the report for *Blue page 1, with JIRA Gadget*   # Navigate back to <yourConfleunceURL>/display/TS2/Page+Properties+testing   # Observe that the page looping is no longer present    h4. Expected Results    Page Properties reports would display without issue and the page would render normally.  h4. Actual Results    Page becomes stuck in a loop, and continues to attempt to render the reports - refreshing the page continuously and appending to the page URL with each attempt. The only way to stop the rendering is to force the browser to stop the attempt by manual intervention.   h4. Workaround    The only workaround at present is to insure that JIRA macros are only embedded at the Child Page level and *no* *deeper* than the child level, or the looping will occur. """
"CONFSERVER-51998","Bug","Editor - Synchrony",3,"Attachment links are changed to a self referential link of the page once you edit the page","""h3. Summary  When you edit a page that contains attachments that are displayed as a link, those links will point to the page itself and the name of the link will also change to the name of the page.    h3. Steps to replicate  # Create a new page called 'Test'.  # Use the Confluence Source Editor add-on to insert this storage format into the page:     # Save the page.  # Confirm that the links are named as File 1 to File 5.  # Edit the page.  # Click on 'Preview' or save the page.    h3. Expected results  The link names should remain as File 1, File 2, File 3, etc.    h3. Actual results  The link names are all changed to the page title, 'Test'.    h3. Note  Looking at the storage format, the edit results in this link:    To change to this:    We've also seen it change to reference the page ID in stead of the attachment, like this:   """
"CONFSERVER-52138","Bug","Macros - Content Report Table",1,"tableSorter JS error from content report plugin","""Sometimes there is a js error due to a missing dependency on aui-table-sortable"""
"CONFSERVER-52044","Bug","Editor - Synchrony",3,"Invalid JWT error occurs after upgrading Confluence from 5.9.12 to 6.1.0","""After upgrade I am having trouble connecting to Synchrony in the editor. The problems seems to be downloading this file:      The first request fails as expected, because it does not contain the context path. However, the second one should add the context path and it does not. It is identical.    !screenshot-1.png|height=150px!    See attached HAR    *Update*: After removing the contextpath from my installation I still get the same error. If I hit the link directly, I get this:      See second HAR"""
"CONFSERVER-52066","Bug","Macros - Other Macros",8,"Contributor Macro is Extremely Slow to Render with Large Spaces and Contributors","""h3. Summary    Contributor macro in Confluence 6.0.6 takes 6 minutes to return results when loading the page it is on if the space it is searching contains many pages, ~17,000 pages for example, and is configured to scan descendants or children.  h3. Environment   * Confluence 6.0.6 Data Center    h3. Steps to Reproduce   # Have a space with ~17,000 pages and over ~1170 contributors in the space   # Configure the root page of the space with the contributor macro with the following options:   Contribution Type: Authors   Sort by: Count   Display Format: List   Maximum Number of Contributors: 50   Show Count: Checked   Show last Contribution Time: Checked   Include Page Hierarchy: Descendants    h3. Expected Results    When loading the page the contributor macro will display the contributors within a minute or two.  h3. Actual Results    The page displays, but the macro does not display the contributors until 6 minutes later. Many end users do not wait and report that the macro is not working. The logs show:    _2017-03-27 14:46:10,048 WARN [http-nio-8090-exec-4] [confluence.util.profiling.DefaultActivityMonitor] close Exceeded the threshold of 60000 ms: ActivitySnapshot\{startTime=1490650763574, threadId=238, threadName='http-nio-8090-exec-4', userId='admin', type='web-request', summary='/rest/com.atlassian.confluence.contributors/1.0/contributors?mode=list&showCount=true&scope=children&limit=100&spaces=PROD&showLastTime=true&contextEntityId=1022429&_=1490650763508'}_   _– referer: [https://INSTANCE_DOMAIN.com/display/USERS/Users+Home|https://instance_domain.com/display/USERS/Users+Home] | url: /rest/com.atlassian.confluence.contributors/1.0/contributors | traceId: caf7733225cb19da | userName: admin_   _2017-03-27 14:47:02,920 INFO [http-nio-8090-exec-7] [confluence.rpc.auth.TokenAuthenticationInvocationHandler] invokeAuthenticatedMethod Executing remote API method [ getPage ] as user [ admin ][ admin ]_  h3. Notes    This can easily be reproduced by the customer in their environment due to the size of the space and contributors.  h3. Workaround    There is not an available workaround."""
"CONFSERVER-52060","Bug","Editor - Synchrony",8,"Images, attachments, user mentions are broken after changing the BaseURL","""{panel:title=Atlassian Update - March 2018|borderStyle=solid|borderColor=#3C78B5|titleBGColor=#3C78B5|bgColor=#E7F4FA}  The fix for this issue released in 6.8.0 will prevent links to images (and view attachment macros) from being corrupted after a change in the Confluence baseURL.    However, if there are any existing link corruptions that occurred prior to upgrading to 6.8.0, those corruptions will remain, and the only way to fix is to either revert to a published version of a page without such corruptions, or discard the draft (if the corruption is only in the draft).    I have created an issue to track a fix on the already corrupted links: CONFSERVER-55249  {panel}  h3. Steps to Reproduce    # Set up an instance with no context path, eg [http://localhost:8090/]   # Create a page and add some images, attachments and user mentions to it   -- Confirm it displays ok   # Shut down Confluence and set a context path, eg [http://localhost:8090/confluence]   # Restart and update the base URL in Confluence Admin > General Configurations   # view the page   -- Observe that the images are still ok   # Edit the page   -- Observe that the images are broken in edit mode   # Type some text and save   -- Observe that the images are still broken    This is likely happening because Synchrony """"saved"""" the links with the old BaseURL, and then when the BaseURL changed, those changes aren't propagated into Synchrony (because it's saving the editor format).  h3. Workaround  h5. Turn Collaborative Editing Off and back On (recommended)    It has been confirmed that *turning Synchrony Off and On* again resolves the related issue with links in --CONFSERVER-52455--. It is unclear if this applies to the image issue as well.    !https://jira.atlassian.com/images/icons/emoticons/warning.png|width=16,height=16!   All existing shared drafts are lost when you switch collaborative editing off, so make sure your users have published any work they want to keep before you make the change.   # Go to  !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > *General Configuration* > *Collaborative editing*   # Click *Change mode*   # Select *Off*   # Click *Change*   # Then turn Synchrony back on   # Then [rebuild the index|https://confluence.atlassian.com/doc/content-index-administration-148844.html#ContentIndexAdministration-Rebuildingthesearchindex] via the UI   # The issue will stop occurring but you will need to go back and manually restore any pages that were affected  ## You can restore the page to an older version  ## Or you can manually adjust the links    h5. Note about this workaround  When Collaborative Editing is enabled, and a page is being edited, all those small changes are stored in Synchrony in-memory cache/events table on the database. That includes the base URL.   When the base URL got changed in Confluence, Synchrony won't be aware of this change. When turning off Collaborative Editing, you discard all the data that Synchrony had and when enabling again, you are forcing to fetch a new copy of the base URL from Confluence. That's how turning it off and on again helps workaround this issue    h5. Turn Collaborative Editing Off Entirely (not recommended)    !https://jira.atlassian.com/images/icons/emoticons/warning.png|width=16,height=16!   All existing shared drafts are lost when you switch collaborative editing off, so make sure your users have published any work they want to keep before you make the change.   # Go to  !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > *General Configuration* > *Collaborative editing*   # Click *Change mode*   # Select *Off*   # Click *Change*   # Then [rebuild the index|https://confluence.atlassian.com/doc/content-index-administration-148844.html#ContentIndexAdministration-Rebuildingthesearchindex] via the UI   # The issue will stop occurring but you will need to go back and manually restore any pages that were affected  ## You can restore the page to an older version  ## Or you can manually adjust the links    (i) More information can be found in [Administering Collaborative editing|https://confluence.atlassian.com/doc/administering-collaborative-editing-858772086.html].    If turning off Collaborative Editing is not an option or the affected area is not too big for the instance, there is a workaround that can be applied to a page to fix it on a page to page   basis:  # Edit the affected page that has either _User Mention_ or _Attachment Link_ in it  # Save the page without making any changes (this would break the page due to this bug)  # Revert the page back to the history of 1 version before the current broken version (the version that has all the user mentions and attachment links still intact)    Now that the page has been _affected_ once, any edits after this will not cause the user mentions or attachment links to change again.    """
"CONFSERVER-52103","Bug","Server - Platform",5,"On upgrade to Confluence 6.1, an error 'The database name component of the object qualifier must be the name of the current database' occurs","""This is the same issue as  * https://jira.atlassian.com/browse/BAM-18278  * https://confluence.atlassian.com/bamkb/the-component-of-the-database-name-of-the-object-qualifier-must-be-the-name-of-the-current-database-879008646.html    h3. Summary  Confluence throws a database error while trying to upgrade to 6.1.0 when using Microsoft SQL Server database:    {code}  2017-03-29 23:28:01,077 ERROR [localhost-startStop-1] [engine.jdbc.spi.SqlExceptionHelper] logExceptions The database name component of the object qualifier must be the name of the current database.  2017-03-29 23:28:01,105 ERROR [localhost-startStop-1] [atlassian.confluence.plugin.PluginFrameworkContextListener] launchUpgrades Upgrade failed, application will not start: com.atlassian.config.ConfigurationException: Cannot update schema  com.atlassian.confluence.upgrade.UpgradeException: com.atlassian.config.ConfigurationException: Cannot update schema   at com.atlassian.confluence.upgrade.AbstractUpgradeManager.upgrade(AbstractUpgradeManager.java:133)   at com.atlassian.confluence.plugin.PluginFrameworkContextListener.launchUpgrades(PluginFrameworkContextListener.java:118)   at com.atlassian.confluence.plugin.PluginFrameworkContextListener.contextInitialized(PluginFrameworkContextListener.java:77)   at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4853)   at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5314)   at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)   at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1408)   at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1398)   at java.util.concurrent.FutureTask.run(FutureTask.java:266)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)   at java.lang.Thread.run(Thread.java:745)  Caused by: com.atlassian.config.ConfigurationException: Cannot update schema   at bucket.core.persistence.hibernate.schema.SchemaHelper.validateSchemaUpdateIfNeeded(SchemaHelper.java:174)   at com.atlassian.confluence.upgrade.AbstractUpgradeManager.upgrade(AbstractUpgradeManager.java:119)   ... 11 more  Caused by: org.hibernate.exception.GenericJDBCException: Error accessing table metadata   at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:47)   at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:111)   at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:97)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.convertSQLException(InformationExtractorJdbcDatabaseMetaDataImpl.java:97)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.locateTableInNamespace(InformationExtractorJdbcDatabaseMetaDataImpl.java:352)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.getTable(InformationExtractorJdbcDatabaseMetaDataImpl.java:239)   at org.hibernate.tool.schema.internal.exec.ImprovedDatabaseInformationImpl.getTableInformation(ImprovedDatabaseInformationImpl.java:110)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.performMigration(SchemaMigratorImpl.java:251)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.doMigration(SchemaMigratorImpl.java:136)   at com.atlassian.confluence.impl.hibernate.ConfluenceHibernateSchemaManagementTool$3.doMigration(ConfluenceHibernateSchemaManagementTool.java:105)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.doMigration(SchemaMigratorImpl.java:109)   at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:87)   at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:58)   at bucket.core.persistence.hibernate.schema.SchemaHelper.validateSchemaUpdateIfNeeded(SchemaHelper.java:171)   ... 12 more  Caused by: java.sql.SQLException: The database name component of the object qualifier must be the name of the current database.   at net.sourceforge.jtds.jdbc.SQLDiagnostic.addDiagnostic(SQLDiagnostic.java:372)   at net.sourceforge.jtds.jdbc.TdsCore.tdsErrorToken(TdsCore.java:2988)   at net.sourceforge.jtds.jdbc.TdsCore.nextToken(TdsCore.java:2421)   at net.sourceforge.jtds.jdbc.TdsCore.getMoreResults(TdsCore.java:677)   at net.sourceforge.jtds.jdbc.JtdsStatement.executeSQLQuery(JtdsStatement.java:505)   at net.sourceforge.jtds.jdbc.JtdsPreparedStatement.executeQuery(JtdsPreparedStatement.java:1032)   at net.sourceforge.jtds.jdbc.JtdsDatabaseMetaData.getTables(JtdsDatabaseMetaData.java:1836)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.locateTableInNamespace(InformationExtractorJdbcDatabaseMetaDataImpl.java:337)   ... 21 more  {code}    h3. Steps to Reproduce  # Create a Microsoft SQL Server database named *Confluence*.  # Install Confluence lower than 6.1.0.  # Connect Confluence to the Microsoft SQL Server database using the connection string url as *confluence* (instead of Confluence with an uppercase letter C).  # Upgrade Confluence 6.1.0    h3. Expected Results  * Upgrade is successful.    h3. Actual Results  * Upgrade fails with      h3.Workaround  # Get the name of the Microsoft SQL Server database using the following SQL statement:  {code:sql}  SELECT name, database_id, create_date FROM sys.databases;  {code}  # Compare it with the database name configured inside the {{<confluence_home>/confluence.cfg.xml}} file:  #* Or in the *server.xml* file if you are using *data source* connection.    # Update the database name so it matches the exact name of the database from the SQL statement.  # Restart Confluence."""
"CONFSERVER-52102","Bug","Integrations - JIRA",3,"Broken Attachment Link in JIRA Activity Stream Gadget","""h3. Summary    Confluence attachment is rendered as a broken link when viewed in JIRA Activity Stream gadget from JIRA and Activity Stream gadget from Confluence.  h3. Environment   * Confluence 6.1.0, 6.1.2   * JIRA 7.3.3, 7.3.5    h3. Steps to Reproduce   # Set up application links between JIRA and Confluence   # Add attachment in an existing Confluence page   # See JIRA Activity Stream gadget from JIRA Dashboard    h3. Expected Results    The attachment is rendered correctly  h3. Actual Results   * The attachment is rendered as a broken link   * Opening the attachment in a new tab will result in a System Error page with below error:      h3. Notes   * JIRA Activity Stream gadget can render the attachment correctly when JIRA 7.3.3 is integrated with Confluence 5.10.5   * The same URL is used for linking the attachment when integrated with Confluence 5.10.5 and 6.1.0, for example {{[http://10.60.2.82:8090//download/attachments]}}    h3. Workaround    Open the attachment link in a new tab and remove one of the 2 forward slashes between the Base URL and _download/attachments_. E.g. from:   * {{[http://10.60.2.82:8090//download/attachments]}}    to   * {{[http://10.60.2.82:8090/download/attachments]}}"""
"CONFSERVER-52116","Bug","Space - Export / Import",5,"PDF Export of a space can cause OutOfMemory errors","""Despite all the work done in CONF-19815 and related tickets, it is still possible for a space export to cause memory pressure such that there is an OutOfMemory error, or performance issues that impact Hazelcast in Confluence Data Center. This can cause outages."""
"CONFSERVER-52266","Bug","Content - Attachments",3,"adding an image in edit mode adds ""confluence-thumbnail"" class unnecessarily causing poor image to be displayed","""h3. Steps   # Upload an image   # Save the page   # Notice that it looks like it's a really small image scaled up   # Wonder why    It's not really consistent but it seems like uploading an @2x image for the first time on a page is showing a really bad-looking version of it on the page (view, not edit). It looks fine in FileViewer and some times replacing the image (select and drop same file on to replace) fixes it.    h3. Workaround  # Edit the page  # Select the image to bring up the image toolbar  # Resize the image to another size  # Resize it back again to the desire size immediately  # Save the page   """
"CONFSERVER-52256","Bug","Editor - Collaborative editing",3,"Links added using configured shortcut links is broken after page edit","""h3. Summary    Links added using configured shortcut links on your Confluence site, is broken when you edit the page.    h3. Steps to Reproduce   # Configure Shortcut links eg.  Key: test  Expanded Value: [https://google.com|https://google.com/]  Default Alias: %s   # Create a new page and a link to """"atlassian"""" text using [atlassian@test]   # Publish the page   # Edit the page and Publish again    h3. Expected Results   * The link should still be working after editing the page    h3. Actual Results   * The link will not work after editing the page."""
"CONFSERVER-52528","Suggestion","Translations",5,"Time format is incorrect, should be ""internationalized""","""Time format should be """"internationalized"""".    *Italy*   In Italy we don't use AM and PM, we always use the 24 hour time."""
"CONFSERVER-52296","Bug","Server - Administration",1,"c3p0 Class not Found on the Classpath and its Properties are Ignored","""h3. Summary    On a fresh install of Confluence 6.1.x, we get warnings during the startup that the c3p0 properties are being ignored and the Hibernate built-in connection pool will be used instead.    h3. Environment    * Confluence 6.1.x    h3. Steps to Reproduce    # Fresh install  # Restart the application  # Tail the atlassian-confluence.log    h3. Expected Results    No warning is shown and c3p0 properties are applied.    h3. Actual Results    The following warnings are printed:        h3. Notes    After a deeper analysis, we identified that the warnings are harmless and are caused by a schema check before the complete startup of Hibernate. With that said, after the check and the complete startup of Hibernate, the c3p0 properties are successfully applied so we can safely ignore the warnings.    h3.Workaround    No known workaround at the moment."""
"CONFSERVER-52308","Bug","Macros - Other Macros",2,"Code Macro Plugin gives message about not designed for Data Centre","""  h2. Summary  In Confluence 6.1.2 Data Centre, the Code Macro Plugin displays a message  {panel}  *This add-on is not designed for Data Center versions of Confluence. Request an update from the vendor.*  {panel}  However it works correctly.     !CodeMacroPlugin.png|thumbnail!     h2. Steps to reproduce  # Install and start Confluence DataCentre 6.1.2  # Go to !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > *Add-ons*  # Search for All Add-Ons  # Enter *Code Macro Plugin* in the filter  # Open the Add-On  # See the message  {panel}  *This add-on is not designed for Data Center versions of Confluence. Request an update from the vendor.*  {panel}    h2. Expected Results  It does not display the message    h2. Actual results  The message is displayed    h2. Workaround  Testing indicates this is likely to be an error with Atlassian Marketplace as the Code Macro works as expected.    """
"CONFSERVER-54623","Suggestion","Server - Platform",5,"When the server runs out of disk space, uploading attachments fail without a proper error message","""When the server runs out of disk space, and the user attempts to upload an attachment, they get a cryptic error message that doesn't tell them the cause.         We need to add a proper error message that helps them diagnose the source of the error by displaying the message from the underlying IOException."""
"CONFSERVER-52327","Bug","Content - Inline Comments",2,"@mentions in replies to inline comments do not generate notifications nor notification emails","""h3. Summary  When replying to an inline comment and using an @mention, the mentioned user does not receive a *<username> mentioned you in <pagename>* email nor a notification in the workbox    h3. Steps to Reproduce  # Configure an [outgoing mail server in Confluence|https://confluence.atlassian.com/doc/configuring-a-server-for-outgoing-mail-151078.html], if one is not already present  # On a Confluence page add an [inline comment|https://confluence.atlassian.com/conf57/commenting-on-pages-and-blog-posts-701435207.html#Commentingonpagesandblogposts-Addaninlinecomment]  # In the reply to an inline comment, mention a user who is not  #* Not watching the page  #* But does receive e-mail notifications    h3. Expected Results  They receive:  # A notification that they were mentioned in a reply to an inline comment  # An e-mail from Confluence with the subject *<username> mentioned you in <pagename>*    h3. Actual Results  They receive no notifications nor e-mails    h3.Workaround  If the mentioned user happens to be watching the page they get e-mails regarding the changes."""
"CONFSERVER-52353","Bug","Server - Upgrade Manager",5,"Upgrade Confluence to version 6.1.x Failed with ""ORA-01000: maximum open cursors exceeded"" Error","""h5. Summary    Upgrade Confluence (connected to Oracle 12c) to version 6.1.x failed with the following error in the logs (atlassian-confluence.log) :    h5. Analysis    Running the following query in the database found out that Confluence is taking up ~600 open cursors :      h5. Cause  This is a known bug with Oracle JDBC driver version 12.1.0.2, which leaks database cursors. See this Oracle Community forum post for more information: https://community.oracle.com/thread/3682300.     h5. Workarounds    See [this KnowledgeBase article for detailed instructions|https://confluence.atlassian.com/confkb/upgrade-to-version-6-1-x-failed-with-error-ora-01000-maximum-open-cursors-exceeded-922914154.html].    There are two known workarounds for this issue:    *1. Update the Oracle JDBC Driver to the latest version (12.2.0.1)*  There is a new version of the Oracle JDBC driver which fixes the cursor leak. Updating your driver prior to upgrading Confluence to 6.1.x will prevent this issue.  To update the driver:  # Stop Confluence, and create a backup of the installation and home directory.  # Download version 12.2.0.1 (or later) of the driver from the Oracle JDBC Driver page.  # Replace the existing ojdbc7.jar in <Confluence installation>/confluence/WEB-INF/lib with the new driver. For detailed instructions, follow step 6 in the database setup for oracle page.  # Start Confluence.  # Re-attempt upgrade.    *2. Increase Maximum Open Cursors*  Increase the maximum open cursor in the database :    (i) The query above is obtained from [Side Bar Is Not Visible Due To Not Sufficient Open Cursors In Oracle|https://confluence.atlassian.com/confkb/side-bar-is-not-visible-due-to-not-suficient-open-cursors-in-oracle-780863319.html]. You may change the value of '1000' as required."""
"CONFSERVER-52367","Bug","Editor - Collaborative editing",2,"Inactive avatars immediately replaced by active avatars creates jarring transition effect","""This happens sometimes in the following situation.   # A user has made edits to a page and is currently in the editing session.   # Another user joins the editing session.    When the second user joins, he or she will sometimes see a gray version of the first user's avatar (indicating that that user has made changes which haven't yet been published) which is immediately replaced by the colored (active) version of that user's avatar (since they are currently active). Because this happens really quickly, it creates for a bit of a jarring transition as the gray avatar is immediately replaced by the colored avatar. It would be better to first display all the active avatars, then the inactive ones, instead of first displaying the inactive avatars which might be immediately replaced by the active ones if the user is currently in the session.       h2. Done when    * Change the order of operations so that the inactive users are added after the active users from synchrony"""
"CONFSERVER-52397","Bug","Apps - Team Calendar",3,"Team Calendar doesn't display Oauth prompt for JIRA Events","""Environment:   - Team Calendar 5.3.17   - Confluence 5.10.8 / 6.1.0   - Jira 7.3.0    h3. Steps to reproduce   # Install Confluence Team Calendars;   # Create an Application Link between Confluence and JIRA;   # Create a Calendar;   # Click Add Event and try to select a JIRA EVENT TYPE;    h3. Expected behavior    It shows """"Login & Approve"""" message  h3. Actual behavior    *Error(s) occurred.* with a large stack trace or it simply doesn't display the expected information.    In atlassian-confluence.log there is the below error:    *Workaround*  # Insert a *JIRA Issue macro* into a Confluence page;  # Try to query a Jira issue using JQL;  # It should display the """"Login & Approve"""" message - click there and proceed with the authentication;  # Save the page;  # Back in the calendar, the JIRA Events should work properly."""
"CONFSERVER-52390","Bug","Editor - Attachment",3,"Drag n Dropping a pdf file into the editor generates a tiny thumbnail","""h3.Steps      # Create a page    # In edit mode drag n drop a PDF file into the editor       *What happened...*     You get a tiny thumbnail for the PDF document     *What should have happened...*    You should get a regular sized thumbnail     *Workaround*     Toggle the thumbnail to a different size will correct the issue.  The issue is also correct at the point of publishing the page.  """
"CONFSERVER-52403","Bug","Editor - Page / Comment Editor",3,"Table of Contents and Table of Contents Zone macros affect in-page editing feature","""h3. Summary    When the [Table of Contents|https://confluence.atlassian.com/doc/table-of-contents-macro-182682099.html] or [Table of Contents Zone|https://confluence.atlassian.com/doc/table-of-content-zone-macro-189890742.html] macros are on a page, the [in-place editing function introduced in Confluence 5.9.x|https://confluence.atlassian.com/doc/confluence-5-9-release-notes-785333580.html#Confluence5.9ReleaseNotes-Editapage,withoutlosingyourplace] does not work as expected.  h3. Steps to Reproduce   # Create a page with several paragraphs text, enough to require scrolling through the page   # Include different headers and sections   # Add a Table of Contents macro or the Table of Contents Zone macro   # Save the page   # Scroll to the middle of the page in view mode   # Press *E* or click *Edit* on the hovering page data toolbar    h3. Expected Results    Confluence should take you to the same general area that you were when viewing the page  h3. Actual Results    You may receive a few different results:   # The editor does not move and just focuses at the top of the page   # The editor focuses on a different spot on the page, unrelated to the spot you had scrolled to in view mode    There are no errors in the log files.  h3. Workaround    The only workaround at this time is to remove the Table of Contents and Table of Contents Zone macros if they are in use"""
"CONFSERVER-52420","Bug","Content - Linking",0,"Links containing certain encoded special characters become double-encoded","""This ticket stems from -CONFSERVER-45966-. In that ticket, if you enter a link that contains url-encoded characters such as %25 or %2f, etc., those characters became double-encoded.    The resolution in CONFSERVER-45966 resolved most of these characters including all umlaut and cyrillic characters per the description of that ticket.    The problem is that there are certain characters which when encoded in the link are still being double encoded.    Those characters are: """"; , / ? : @ & = + $"""". The encoded versions of these characters are: """"%3B %2C %2F %3F %3A %40 %26 %3D %2B %24"""" and if the link contains any of the encoded version, that character will be double-encoded.       h3. Workaround    Option 1: Paste the link into the editor instead of using insert link dialog.   * In this method you cannot modify the link text, so the link text will be automatically set based on the url    Option 2: Use square brackets to insert the link. [ ]   # Type """"[""""   # Type the text you want for your link in the editor, for example """"My Link""""   # Type a """"|""""   # *Type* the url   # Type """"]"""" to complete the link.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.    For step 4, you could also try pasting the url but this might have less success since the url will be converted to a link automatically and you might have to first undo that automatic conversion, which in turn may cause the closing """"]"""" to have no effect. See option 3 instead.    Option 3   # Paste the URL into the editor.   # Press undo to undo any automatic link creation/extraction so you see the original URL.   # If the URL is still a link, click it, and click """"Unlink"""" to return it back to regular text.   # At the beginning of the link, type [ followed by `Escape` to exit the Link Autocomplete   # Type the text to display for the link followed by """"|""""   # Now your link should look like this   ## !Screen Shot 2017-05-11 at 7.37.39 AM.png|width=379,height=48!   # Click at the end of the link and type """"]"""" to complete the link. This should auto-convert it to a link with the desired text.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.         Option 4: Using the Source Editor to change links after adding them   # Install the [Confluence Source Editor|https://marketplace.atlassian.com/plugins/com.atlassian.confluence.plugins.editor.confluence-source-editor/server/overview] (free add-on)   # Edit the page   # Click on the {{<>}} icon in the top right   # Find the *href=* attribute that contains the '%25' in the URL   # Replace it with just '%'   # Apply the changes and save the page"""
"CONFSERVER-52417","Bug","Macros - JIRA Macros",3,"""Chart by"" filter not picking Number Fields from Custom Fields list","""h3. Summary    """"Chart by"""" filter not picking Number Fields from Custom Fields list    h3. Environment  (Optional - If Applicable)  * Confluence 6.1.0  * JIRA 7.3.0    h3. Steps to Reproduce  # *In JIRA*, go to the """"Custom Fields"""" page.  # Create two custom fields.  # Create one as *Number Field* and the other as *Labels*.  # Reindex JIRA and Confluence.  # *In Confluence*, go to any page and insert a *JIRA Chart* macro.  # On the """"Display options"""", open the """"Chart By"""" selector.      h3. Expected Results    Both custom fields will be returned    h3. Actual Results  Only the """"Label"""" field will be returned.     h3. Notes  The same thing doesn't happen on a regular JIRA macro. In other words, only the Pie Chart is affected.    h3.Workaround  No workarounds   """
"CONFSERVER-52411","Bug","Content - Sharing|Web Interface - Keyboard Navigation",1,"Keyboard shortcut for Share is missing a space in the title","""Hovering over the Share button on a Page gives the title """"Share this page with others (sor k)"""". There should be a space between the """"s"""" and the """"or"""""""
"CONFSERVER-52445","Bug","Content - Blueprints - Playbook",2,"DACI template displays broken images","""h3. Summary  When adding a DACI template to a Confluence page, the images under *Pros and Cons* on the table are broken    h3. Environment  Confluence 6.1+    h3. Steps to Reproduce  # Create a page using the DACI template  # Select *in progress* from the template wizard  # Check the table under *Options Considered*    h3. Expected Results  (+) & (-) icons are displayed    h3. Actual Results  Images are broken     h3. Notes  The plugin seems to be pointing to a hardcoded, internal URL to pull those images.    h3. Possible solution  # Follow this guide: [How to edit bundled or system plugins|https://confluence.atlassian.com/confkb/how-to-edit-bundled-or-system-plugins-302811979.html]  # Edit the {{com/atlassian/confluence/plugins/dacidecision/soy/daci-decision-blueprint-template.soy}} file to remove lines pointing to https://extranet.atlassian.com and repoint to an emoticon  # Follow this guide to place the file in the appropriate directory in Confluence: [How to edit files in Confluence JAR files|https://confluence.atlassian.com/confkb/how-to-edit-files-in-confluence-jar-files-103711179.html]  # [Clear the plugin cache|https://confluence.atlassian.com/display/CONFKB/How+to+clear+Confluence+plugins+cache] and restart Confluence    h3. Workaround  Remove those images, and replace with (+) & (-) icons"""
"CONFSERVER-52441","Bug","Editor - Collaborative editing",5,"Emoticon is changing to image after the first save and edit of the page","""h3.  Summary    Emoticons macro is changing to image after the first save and edit of the page.  h3. Steps to Reproduce   # Create a page and add an emoticon by typing in the keyboard or using the macro menu   # Save the page and check the storage format of the page it should look like this       # Click on edit the page, don't add any thing and just save again   # Check the storage format one more ttime    h3. Expected Results    Should be the same    h3. Actual Results    It changes into an image    In Confluence version *6.14.x*, this bug changes the source URL from HTTPS to HTTP if Confluence is running behind proxy and SSL.  h3. Workaround   # Disable Collaborative Editing - To avoid the issue from occurring   # For Confluence 6.14.x, editing the storage format to point the broken URL from HTTP to HTTPS able to temporarily fix the issue.       h3. *Notes*   # This issue leads into a confusion when doing version comparison or when receiving email update about the change because Confluence is detecting an change about the content from macro to an image to it includes into the changes.   In the screenshot attached you can see that Confluence is considering all emotions being part of the change, but actually only *Start* was changed to *cool* and *normal* to *change*.   !Screen Shot 2017-05-18 at 11.19.01.png|thumbnail!   # This is not reproducible with Confluence 5.10.x   # This could be an issue as emoticons are converted to hard links, and would present an issue when a type of base-URL related migration occurs in the future       {panel:title=Atlassian update - 7 June 2019|borderStyle=none|borderColor=#6554c0|titleBGColor=#eae6ff|bgColor=#eae6ff}  Hi everyone    Thank you for your patience as we have been working on the solution for this issue. It has been a complicated one to solve and we wanted to include a few notes on this fix we have shipped in the 6.15.5 release.    *Adding new emoticons (including Hipchat emoticons) to a page:* This is now fixed. They will be saved in valid storage format (e.g {{<ac:emoticon ac:name=""""smile""""/>}} for standard Confluence emoticons or {{<ac:hipchat-emoticon ac:shortcut=""""name""""/>}} for Hipchat emoticons).  *Existing pages with invalid emoticons and collaborative editing turned OFF:* Viewing or editing the page will display fixed emoticons. Saving the page will correct the storage format of the broken emoticons.  *Existing pages with invalid emoticons and collaborative editing turned ON:* Viewing the page will display fixed emoticons. If there is a current draft with broken emoticons, then the broken emoticons will be displayed once in the editor. On the next save of the page, any invalid emoticons will be fixed.      *For those using Hipchat emoticons*, please note:    If an invalid Hipchat emoticon has the same name as one of the standard Confluence emoticons (such as """"smile"""", """"thumbs-up"""" or """"tick""""), it will be converted into the corresponding Confluence emoticon once the page is saved.      For all cases, saving the page will fix the broken emoticons. We explored the possibility of including a front-end editor fix to automatically resolve all of these broken emoticon instances. As it would involve checking every page and have an ongoing performance impact, we decided against doing this. So, if you come across any broken emoticons, please edit and update/publish your page to resolve the problem.        Thanks again for your understanding.    Niraj | Senior Development Team Lead, Confluence Server  {panel}"""
"CONFSERVER-52450","Bug","Web Interface - AUI",2,"Long space names overflow the Spaces drop-down","""If a Space is created with a long name (and no spaces), when it appears in the 'Spaces' drop-down at the top of the screen, it will not wrap, and will overflow the drop-down box.    Steps to Recreate:  1. Create a new space with a name such as ConfluenceTestSpace_6.1.3_Long_Name_To_Test_Overflow  2. After creating the space, click the 'Spaces' drop-down at the top of the screen, and you will see the new space overflowing the box.    Tested on Chrome, Safari, and Firefox.  All show the issue.  Screenshot from Chrome is attached."""
"CONFSERVER-52449","Bug","Editor - Page / Comment Editor",3,"mailto links doesn't work correctly when the email starts with a special character.","""h3. Summary    mailto links doesn't work correctly when the email starts with a special character.  h3.    h3. Steps to Reproduce   # Create an email link to 2 different emails test@test.com and _test@test.com on a page   # Save the page and try clicking on both links    h3. Expected Results    Both links to emails should be working  h3. Actual Results    Only the 1st link to the email is working. The second one doesn't.   Storage format loonks like the following:    \{code:borderStyle=solid}   <p>   <br/>   </p>   <p>   <a href=""""mailto:test@test.com"""">test@test.com</a>   </p>   <p>   <br/>   </p>   <p>   <a>_test@test.com</a>   </p>   \{code}"""
"CONFSERVER-52504","Bug","Macros - Other Macros",3,"Unable to save Confluence page with certain set of macros.","""*STEPS TO REPLICATE*  # Create a page in Confluence.  # Insert the following macro:  #* attachments macro  #* blog-posts macro  #* change-history macro  #* children macro  #* contentbylabel macro  #* content-by-user macro  #* content-report-table macro  #* contributors-summary macro  #* create-from-template macro  #* create-space-button macro  #* favourite pages macro  #* labels list macro  #* network macro  #* popular label macro  #* recently updated macro  #* recently updated dashboard macro  #* recently used labels macro  #* related labels macro  #* space attachments macro  #* space details macro  #* spaces list macro  # *Save* the page.  # Edit the page again and insert *cheese macro* on top op the page.  # *Save* the page.    *EXPECTED BEHAVIOUR*  The page will be save.    *ACTUAL BEHAVIOUR*  An ERROR appear while saving the page *Unable to communicate with server. Saving is not possible at the moment.*    ERROR below appear in the *atlassian-confluence.log* file:  *MySQL:*      *H2 database:*      *WORKAROUND*  # Edit the page and insert additional macro with longer name (*Tasks Report* macro or *Table of Content Zone* macro, for example)   # *Save* the page."""
"CONFSERVER-52540","Suggestion","Data Center - Deployments",3,"Custom DNS name for Load Balancer when using AWS CloudFormation","""h3. Summary  When setting up Confluence Data Center with AWS Cloudformation template, the Synchrony node always takes the ELB hostname even though the base url was changed on Confluence (including Synchrony service URL)    h3. Environment  AWS    h3. Steps to Reproduce  # Setup Confluence Data Center from AWS Cloudformation template  # Get both Confluence and Synchrony nodes up and running  # Change Confluence base URL to a custom domain specific URL  # Update Synchrony service URL from {{<confluence-install>/bin/setenv.sh}}  {code:borderStyle=solid}  -Dsynchrony.service.url=https://your-custom-domain  """
"CONFSERVER-52537","Bug","Content - File Previews",3,"PDF preview does not render characters both multibyte characters and single-byte characters","""h3. Summary    PDF preview does not render characters both multibyte characters and single-byte characters.   Some pdf files are not rendered on PDF Preview in Confluence 6.1 and 6.2.  h3. Environment   * Confluence 6.1.4   * Confluence 6.2.0   * Confluence 5.10.8 can render the characters    h3. Steps to Reproduce   # Attach the sample pdf file to a page. ( [^testpdf.pdf] )   !origin.jpg|thumbnail!   # Save the page.   # thumbnail looks good.   !thumbnail.jpg|thumbnail!    # Preview the pdf file. no characters.   !preview.jpg|thumbnail!    h3. Expected Results    Characters are rendered normally.  h3. Actual Results    All characters are not rendered in PDF preview.  h3. Workaround    no workaround"""
"CONFSERVER-52551","Bug","Macros - Gadgets",5,"External Gadgets not working due to error with MacroMetadataProvider","""h3. Summary    External gadgets won't be found in the Macro Browser due to errors from the *MacroMetadataProvider*. You also won't be able to insert them manually, as the summary of the macro won't appear as the following screenshots:         *Working gadget:*    !working.png|thumbnail!    *Not working:*    !not_working.png|thumbnail!  h3. Environment   * Confluence 6.2.0(with and without proxy)    h3. Steps to Reproduce   # Setup Confluence and JIRA with SSL(selfsigned certificate).   # Add a gadget feed in Confluence.   # Stop both services and revert the changes(remove the SSL).   # Remove the existing gadget feed(with HTTTPS url).   # Add a new gadget feed(with HTTP url)  or     # Install Copy Page Tree add-on( v2.5.0, v2.5.2 or v2.5.3)    h3. Expected Results    External Gadgets will be found in the macro browser and you will be able to insert them.  h3. Actual Results    Macros are not found and manually inserting the gadget doesn't work. Logs will show:    h3. Notes   - Flushing the cache won't fix.   - Clear the plugins cache won't fix.   - Restart both instances won't fix.   - No errors besides the above one in the logs.    h3. Workaround    In case you have the Copy Page Tree add-on installed( v2.5.0, v2.5.2 or v2.5.3), *uninstall* it or downgrade it."""
"CONFSERVER-52595","Bug","Integrations - Office Connector",3,"When importing a word document, header order is not respected","""h3. Summary  When importing a word document and splitting by headers, the page tree that gets created is alphabetized. What we are expecting to happen is that the page tree would be in the same order in which the headers appear in the document.    To reproduce, simply import a word document which can be split by multiple headers that do not appear in alphabetical order within the document. Once the document is imported, notice that the page tree is alphabetical in order as opposed to their order within the document.    I have attached an example Word document to test with.    h3. Steps to Reproduce  # Import  [^Brian.docx] to Confluence and use Split by heading functionality.  # Observe pages tree generated in sidebar.    h3. Expected Results  # Page tree will be ordered properly (as in document).    h3. Actual Results  # Pages are sorted alphabetically.  #  !tree.png|thumbnail!        h3. Notes  The issue is not reproducible with 5.10.8.   It looks like problem is introduced in Confluence version 6.0.6 and plugin OfficeConnector-5.0.3.jar. The issue is not present in plugin 5.0.2 and Confluence 6.0.5.    h3.Workaround  There are 2 workaround at this point:  # Manually sort and [reorder pages|https://confluence.atlassian.com/doc/move-and-reorder-pages-146407727.html].  # Downgrade the plugin:  #- Stop confluence  #- Find the folder <confluence-install>/confluence/WEB-INF/atlassian-bundled-plugins/ on production  #- Backup and move {{OfficeConnector-5.x.x.jar}} from this folder  #- Download [Confluence 5.10.8 zip|https://www.atlassian.com/software/confluence/downloads/binary/atlassian-confluence-5.10.8.zip].  #- Extract from the same folder OfficeConnector-5.0.2.jar. and copy it to the same folder on production.  #- Remove the following folders:  #-- <confluence-home>/bundled-plugins  #-- <confluence-home>/plugins-cache  #-- <confluence-home>/plugins-osgi-cache  #-- <confluence-home>/plugins-temp  #-- <confluence-home>/bundled-plugins_language  #- Start Confluence    *Note:* The work around (2) has been confirmed to work up up to Confluence 6.5.2 but does not work for Confluence 6.7.1 (Confluence 6.7.1 will crash when importing Word Documents when using the older {{OfficeConnector-5.0.2.jar}})"""
"CONFSERVER-52597","Bug","Content - Restrictions",2,"Page Restrictions Dialogue is Incorrect","""h3. Steps to Reproduce    # Create a Page Tree:    # Make sure all pages are individually restricted to User Y and User Z only  # Revoke all permissions for User Y on Page B  # Go to Page B, and click on *... -> Restrictions*, it will still list User Y.    h3. Workarounds:    # Go to *Space Tools -> Permissions -> Restricted Pages*.  It will show correct permissions.  # Go to Page C, and click on *... -> Restrictions -> Inherited view restrictions*.  It will show correct permissions         """
"CONFSERVER-52633","Bug","Translations",5,"The language pack provided in the TAC is not complete and it mixes Danish with Finnish.","""h3. Description  The customer would like to have Danish as one of the supported languages in confluence. The language pack provided in the translations.atlassian.com is not complete and it mixed Danish with Finnish.   !image-2017-06-19-22-59-11-427.png|thumbnail!   *Green - Danish*  *Red - Finnish*       Suggestion  Have a proper translation for Danish and make is a one of the supported languages in confluence."""
"CONFSERVER-52632","Suggestion","Data Center - Deployments",3,"AWS Confluence DC CloudFormation Template: could be able to resolve EFS not only via DNS but also IP","""h3. Problem Definition  It's not possible to deploy an Internal Facing Confluence DC on AWS using the quick start CloudFormation template when using own DNS Server.    This happens because the template uses the DNS to mount the EFS into the new Confluence Node, so the two conditions on EC2 to use the EFS via DNS are:  # The connecting EC2 instance must be inside a VPC and must be configured to use the DNS server provided by Amazon. For information about Amazon DNS server, see DHCP Options Sets in the Amazon VPC User Guide.  # The VPC of the connecting EC2 instance must have DNS host names enabled. For more information, see Viewing DNS Hostnames for Your EC2 Instance in the Amazon VPC User Guide.    h3. Suggested Solution  Make it possible to deploy Confluence DC using our own DNS Server.    h3. Why this is important  Currently we can only deploy internet-facing datacenters, but most of the companies need to deploy dev/staging instances too, that should be accessed internally only due to security policies.     h3. Workaround   Currently the only workaround is to use the AWS DNS server instead."""
"CONFSERVER-52811","Bug","Space - Blueprints",2,"Space homepage tasks not rendering correctly when you create a new space","""*Steps to reproduce:*    1. In 6.3.0-beta2 create a new Blank space  2. Go to space homepage    *Expected result:*    Nicely formatted tasks    *Actual result:*     !image-2017-06-20-15-02-24-184.png|thumbnail!      Problem only occurs on blank space.  Space blueprints (team space, doc space, kb space etc appear to be fine)"""
"CONFSERVER-52668","Bug","Apps - Team Calendar|Translations",3,"Some text do not translate to German when user use German language","""h3. Description  Some text of the team calendar is not translated to German when the user selects German as the profile language.    *Steps to reproduce*  # Login confluence  # Install Team Calendar  # Go to profile  # Change the language to Deutsch  # Go to one of the space  # You will notice the word *Calendar* do not translate to German *Kalender*    Expected Result  All the text is translated correctly.    Actual Result   !screenshot-1.png|thumbnail! """
"CONFSERVER-52681","Bug","Editor - Collaborative editing|Editor - Page / Comment Editor",5,"Multiple macros inside a header break the entire table when Collaborative Editing is enabled","""h3. Steps to reproduce    # Create a blank page;  # Insert a table;  # Add two or more macros to a Header cell;  # Save the page - It displays the table correctly;  # Edit the page again;      *Expected behavior*  The same table is there, ready to be edited.    *Actual Behavior*  The header pops out everything below the first macro and removes all subsequent cells.     !First View mode.png|thumbnail!  !Editing.png|thumbnail!     h3. Workaround    Remove the headers before saving to avoid loosing the table formatting.    - If the page is already affected, copy the page storage format in view mode, then use Source Editor to paste it in edit mode; or  - Disable Collaborative Editing:  *General Configuration > Collaborative Editing > Change Mode > OFF > Change*    Notes:  - This does not seem to affect drafts."""
"CONFSERVER-52703","Bug","Editor - Page / Comment Editor",3,"cant search in Editor when a character occurred twice or more in MS edge","""*Steps to replicate*  # create a page with Microsoft Edge 40.15063.0.  #  Put in content with  """"A A A A"""".  # press the magnifying glass in the editor.  # search  """"A"""" and press [Next] three times    Expected behavior:    All 4 """"A"""" should be able to search one after another    Actual behavior:     [^CSP–206450.mp4]        [^storate.txt] """
"CONFSERVER-52714","Bug","Editor - Page / Comment Editor",3,"@ mention and // don't work with macOS Japanese Input Method on Safari","""h3. Summary  @ mention and // don't work with macOS Japanese Input Method on Safari.    ||browser|| Japanese Input Method||@||//||  |Safari | macOS Japanese Input method|(x)|(x)|  |Safari | google Japanese Input method|(/)|(/)|    h3. Environment  * macOS + Safari + macOS Japanese Input method  *     h3. Steps to Reproduce  # Enable macOS default Japanese Input method in macOS System Preference  https://support.apple.com/kb/PH22653?locale=en_US  # Edit a page in Confluence  # Input @ or //, it does not work.    h3. Expected Results  Performing @ works as a mention.  Performing // works as a date.    h3. Actual Results  @ and // do NOT work as a mention or date.    h3.Workaround  Use Google Japanese Input method on Safari.  or   Use Chrome browser"""
"CONFSERVER-52736","Bug","Content - Restrictions",5,"Ancestor table is broken after reordering pages and applying restrictions","""h3. Summary  If the pages have been reordered prior to applying restriction to one of them and then top page has been moved to another space then the ancestors for that page will be calculated incorrectly.  h3. Environment  * Confluence Server 6.2.3  * Two users: usera and userb  * Two Spaces: PLAY and LAL (created by admin)  * All users may add page restrictions in both spaces'  * PLAY contains these three pages: """"page1"""", """"page2"""", """"page3"""", """"page4""""  * Page tree is the following: {{PLAY Home ->  """"page1"""" -> """"page2"""" -> """"page3"""" -> """"page4""""}}  h3. Steps to Reproduce  # Log in as {{usera}}  # Go to {{PLAY -> Reorder pages}}  # Reorder pages to some random order by changing the parent-child relationship   !Screen Shot 2017-06-30 at 13.08.28.png|thumbnail!   # Reorder pages back to initial hierarchy: {{PLAY Home ->  """"page1"""" -> """"page2"""" -> """"page3"""" -> """"page4""""}}  # userb adds an edit restriction to """"test2""""  # usera adds a view and edit restriction to """"test1""""  # usera moves """"test1"""" to the space LAL  # check LAL: it does only contain """"test1"""" as usera wasn't allowed to edit the page """"test2"""" and couldn't move it  # get back to PLAY and check for orphaned pages (it should contain """"test2"""")  # Check the restrictions for """"test2"""" (it still has inherited restrictions from """"test1""""(!))  # Try to move """"test1"""" back to PLAY    h3. Expected Results  # """"test2"""" as orphaned page has only its own restrictions  # """"test1"""" can be moved to PLAY without any error    h3. Actual Results  # """"test2"""" has inherited restrictions from """"test1"""" while being orphaned page:   !Screen Shot 2017-06-30 at 18.02.01.png|thumbnail!  !Screen Shot 2017-06-30 at 18.02.19.png|thumbnail!   # It's impossible to move """"test1"""" to PLAY because Confluence think it still has """"test3"""" and """"test4"""" as ancestors   !Screen Shot 2017-06-30 at 13.19.35.png|thumbnail!      h3.Workaround  # [Rebuild Ancestor table|https://confluence.atlassian.com/doc/rebuilding-the-ancestor-table-153948.html]  # [Reuild content index|https://confluence.atlassian.com/doc/content-index-administration-148844.html]"""
"CONFSERVER-52747","Bug","Editor - Collaborative editing",2,"Unable to Save Page if the Draft contains a Link to a Deleted Space","""Same as in CONFCLOUD-54860:  h3. Summary    If a draft contains a link to a removed space, (space exists when creating the draft, but the space was removed while the draft is still yet to be published), then attempts to save the page will fail with this error:    The issue also occurs when you delete a Space and then try to Edit an existing page that has a link to a page from that Space.  h3. Steps to Reproduce   # Create a test page   # Edit the page (after it has been created in step 1), and add a link to a space. *Do not publish the draft at this point*   # In a separate browser tab, *remove the space* that was linked earlier   # Attempt to publish the draft containing that space link now    h3. Expected Results    The page should be published, with a broken space link  h3. Actual Results    Page publishing fails, with the error in the logs above, and this error in the UI:   !Error.png|thumbnail!  h3. Workaround 1    Turn off Collaborative Editing.  h3. Workaround 2    1. Copy current page.  2. Delete current page.  3. Rename the copy such the original one.  h3. Workaround 3    Remove the broken link and try to save the page.    h3. 7/21/2020 Update:  Please note that we've verified that this bug is still open as commented by Christoffer below.  We're awaiting for further review by our developers."""
"CONFSERVER-52755","Bug","Space - Export / Import",3,"Unable to delete space after import from Atlassian Cloud hosted export/import","""h3. Summary    When trying to delete a space which was imported from a Cloud version then the import completes and we see a foreign key violation on the table {{fk_notifications_content}} in the logs  h3. Environment    Cloud version  Confluence 6.2.0  h3. Steps to Reproduce   # Export a space from cloud version   # Import it to Confluence 6.2.0   # Delete the imported space    h3. Expected Results    The space should be deleted  h3. Actual Results    The below exception is thrown in the atlassian-confluence.log file and space does not get deleted the progress is stuck at some point:    h3. Workaround  Some users have resolved this issue by running the command below to delete invalid notifications tied to deleted pages in the space (Similar to solution from CONFSERVER-15964):        {panel:borderStyle=dashed| borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}  (!) With direct database manipulation, be sure to *test and validate* these changes in a test environment and create all necessary backups *prior to* rolling any changes into a Production environment.  {panel}"""
"CONFSERVER-52753","Bug","Macros - Page Properties",3,"Page Properties Report Macro Doesn't Render If ""With Parent"" Filter is Applied.","""h5. Summary  Page Properties Report Macro with """"With Parent = Current Page"""" will stuck while rendering. The macro keep saying: *Generating page properties report*   !Screen Shot 2017-07-04 at 10.35.49 PM.png|thumbnail!     h5. Additional Details  * The macro start to notice slowness in rendering while the page (with page properties report macro) has more than 1000 child pages.  * The macro will load significantly faster if the filter """"With Parent = Current Page"""" was removed.    h5. Expected Results  The macro will load in seconds    h5. Actual Results  The macro keep saying: *Generating page properties report* and it's consuming resources and spiking CPU usage.    h5. Steps to Replicate  # Setup a new Confluence instance  # Import either one of the spaces below, both of them contains ~1000 child pages  #*  [^Confluence-space-export-215124-2.xml.zip]   #*  [^Confluence-space-export-221409-4.xml.zip]   # Open up the main page with page properties macro report  # Compare the rendering speed between page properties report macro (with or without """"with parent"""" filter)    h5. Workaround  Remove """"With Parent"""" Filter"""
"CONFSERVER-52749","Bug","Core - OSGi Plugins Platform",5,"Cannot start Confluence due to corrupt plugin cache","""h2. Problem Definition  Often, on startup, especially on an upgrade, the plugin cache can become corrupted with invalid Add-Ons. This often causes issues for customers and support tickets.    Please note the similar bug  * [CONFSERVER\-54123: Confluence plugins have version errors on start up causing incompatability|https://jira.atlassian.com/browse/CONFSERVER-54123]    In {{atlassian-confluence.log}} we can see errors like      Error like these may also appear      h2. Suggested Solution  The directories  * <confluence.home>/bundled-plugins/  * <confluence.home>/plugins-cache/  * <confluence.home>/plugins-osgi-cache/  * <confluence.home>/plugins-temp/  * <confluence.home>/bundled-plugins_language/    should be completely deleted on restart.    h2. Why this is important  For support we often have to ask customers to do this when we see OSGI version errors, or other side effects after start up causing instability.    For example  * there may be a left over jar file from a removed Add-On still in the plugin directory that Confluence tries to load  * On upgrade from Java 7 to Java 8 the jar files need to be completely rebuilt    Support will usually point customers to one of these documents  * https://confluence.atlassian.com/confkb/how-to-manually-remove-malfunctioning-add-ons-113705118.html  * https://confluence.atlassian.com/confkb/how-to-clear-confluence-plugins-cache-297664846.html    This is a related bug, where an Add-On is invalid on upgrade and needs to be removed from the database and disk  * https://jira.atlassian.com/browse/CONFSERVER-51958    h2. Workaround (the traditional approach)  # Shut down Confluence  # Delete the all the files and folders in (may need adjusting for your environment)  #* <confluence.home>/bundled-plugins  #* <confluence.home>/plugins-cache  #* <confluence.home>/plugins-osgi-cache  #* <confluence.home>/plugins-temp  #* <confluence.home>/bundled-plugins_language (might not exist)  # Restart Confluence  """
"CONFSERVER-52763","Bug","Apps - Confluence Questions",3,"Users if mentioned receive emails with answers/comments on questions in a restricted space they don't have permissions to view","""h3. Summary    Users if mentioned receive emails with answers/comments on questions in a restricted space they don't have permissions to view  h3. Steps to reproduce   # Ask a question in a restricted space and mention a user that doesn't have permissions to access this space   # Add a comment to the question and mention the user   # Answer the question and mention the user    h3. Expected result    The user should not receive emails with contents that he/she doesn't have permissions to view.  h3. Actual result    The user receives emails of those answers/comments. If he/she clicks on the links sent in the emails, the links are blocked. However, the contents are still available in the emails."""
"CONFSERVER-52757","Bug","Editor - Page / Comment Editor",3,"Find/Replace function change heading format to paragraph format if any word found in the both heading and paragraph","""While editing a page and use the """"Find/Replace"""" function the heading format will be changed to paragraph format if the search term matches for one word of the heading and paragraph.    Steps to reproduce:  # Access Confluence using Internet Explorer 11 [^Find and Replace Bug.mp4]   # Create a new Page  # Give the Page a title (does not matter which title name)  # Paste two word in heading format: """"Example Test""""  # Paste some words in next line in paragraph format which includes also a word of the heading: """"Text Example to show the Bug"""". The page will be similar to below screenshot(:   !screenshot-1.png|thumbnail!   # Use the Find/Replace function and search for """"Example"""" and click next to find the match.  # Click next to find the matching word in the text after the heading    h5. Expected Behavior  Heading format will remain the same    h5. Actual behavior  Internet Explorer 11: Heading format change to paragraph format after search term matches word in heading and paragraph  Chrome: Heading format will remain the same  Edge: Heading format will remain the same  """
"CONFSERVER-52821","Bug","Server - Upgrade Manager",2,"Upgrade to Confluence 6.0.6+ is taking a long time for large instances","""h3. Summary    Upgrading to Confluence 6.2.3 is taking a long time for large instances  h3. Steps to Reproduce   # Existing Confluence 6.0.5 and below   # You should have a large set of data (specifically in {{CONTENT}} and {{CONTENTPROPERTIES}} tables)   # Upgrade Confluence to 6.0.6 or above    h3. Expected Results    The upgrade should be done within reasonable time  h3. Actual Results    The upgrade takes a long time to finish because of the following upgrade task {{correctCsvAttachmentMimeTypeUpgradeTask}} which fixes the following bug --CONFSERVER-26926--.   This upgrade task is executing the following query  {code:sql}  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID in (SELECT CONTENTID FROM CONTENT WHERE CONTENTTYPE = 'ATTACHMENT' AND LOWERTITLE LIKE '%.csv');  {code}  (!) *Note: We have customers who took 15 hours for the upgrade to finish successfully. Others took more than 50 hours and did not finish.*  h3. Workaround  h4. Disabling correctCsvAttachmentMimeTypeUpgradeTask   # Stop Confluence   # Go to this directory {{<confluence-install>/confluence/lib}} and locate the file {{confluence-6.x.x.jar}}   # Take a backup of {{confluence-6.x.x.jar}}   # Open this jar file and locate the file {{upgradeSubsystemContext.xml}}   # Remove any occurrence of the following task {{correctCsvAttachmentMimeTypeUpgradeTask}}   # Save and make sure the jar file is updated   # Reattempt the upgrade    The upgrade now should skip that upgrade task.  h4. Manually apply the upgrade task    After the upgrade is completed successfully, we have to apply this task. What we are going to do is to split the query into 2 separate parts.  h5. Part 1 - Fetch Content ID    We first need to run the following query to get the list of all content ids that need to be updated  {code:java}  SELECT CONTENTID FROM CONTENT WHERE CONTENTTYPE = 'ATTACHMENT' AND LOWERTITLE LIKE '%.csv';  {code}  Save this into a text file and separate the content ids with a comma like this  {code:java}  id1, id2, id3...  {code}  h5. Part 2 - Update Content Properties  {code:java}  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID in (<list-of-ids-fetched-before>);  {code}  This should split the heavy work of LIKE and IN and make this update query faster since we have the list of IDs pre-fetched.    *Split the updates*    In case Part 2 is still taking a long time, some customers have also benefitted from splitting the UPDATE statement into individual updates instead of using the IN clause:  {code:java}  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID = <first-id-from-part-one>;  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID = <second-id-from-part-one>;  ...  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID = <last-id-from-part-one>;{code}   """
"CONFSERVER-52985","Bug","Data Center - Deployments",5,"For some instance type (ex I2.xlarge), Confluence could not download and install properly because the failure when mounting to ephemeral0","""When manual mount to ephemeral0 for [some instance type|http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html] does not require, a common script (this script is using by all products) fails. For Confluence, we do not use that temporary storage so we could skip that mounting but for other products it will be a problem. """
"CONFSERVER-53002","Bug","Navigation - Dashboard",3,"Using ""space"" as a context path will break some UI images in Confluence.","""h3. Summary    When configuring context for Confluence application if word """"space"""" is used, some images in UI will be missing.  h3. Steps to Reproduce   # Edit server.xml and add context path to be """"/space"""", """"/space"""", """"/spac"""", """"/sp""""   # Start Confluence    h3. Expected Results    No changes in UI, all icons should be visible.  h3. Actual Results    Icons are missing as per image.    !missing images.png!  h3. Notes    Issue was not present in Confluence 5.7. As it looks like some other contexts that start with /sp will also have the same issue.  h3. Workaround    Change context path to something different (eg. /confluence)."""
